<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Microsoft Clarity Tracking -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "susyj92edf");
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" id="viewport-meta">
    <title>LEADERS Alumni Association - Where LEADERS alumni connect, grow, and give back</title>
    <meta name="description" content="Join the LEADERS Alumni Association to connect with peers, discover events, find mentorship opportunities, and unlock your potential in a lifelong network.">
    <meta name="keywords" content="LEADERS alumni, networking, mentorship, career opportunities, professional development">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://leadersalumni.org/">
    <meta property="og:title" content="LEADERS Alumni Association - Your lifelong LEADERS network">
    <meta property="og:description" content="Find peers by expertise, discover events, and unlock opportunities in the LEADERS alumni network.">
    <meta property="og:image" content="https://leadersalumni.org/og-image.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://leadersalumni.org/">
    <meta property="twitter:title" content="LEADERS Alumni Association - Your lifelong LEADERS network">
    <meta property="twitter:description" content="Find peers by expertise, discover events, and unlock opportunities in the LEADERS alumni network.">
    <meta property="twitter:image" content="https://leadersalumni.org/og-image.jpg">
    
    <!-- Cache Busting Headers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎓</text></svg>">
    
    <!-- D3.js for Network Visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overflow-x: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0B6BFF 0%, #00C2A8 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            width: 100%;
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0B6BFF 0%, #00C2A8 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .loading-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 2rem;
            animation: spin 2s linear infinite;
        }

        .loading-circle {
            stroke-dashoffset: 0;
            animation: loading-progress 2s ease-in-out infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes loading-progress {
            0% { stroke-dashoffset: 180; }
            50% { stroke-dashoffset: 45; }
            100% { stroke-dashoffset: 180; }
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            margin: 1rem auto;
            overflow: hidden;
        }

        .loading-bar {
            height: 100%;
            background: #F39C12;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .logo h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: #1B365D;
            margin-bottom: 0.25rem;
        }

        .logo-image {
            height: 80px;
            width: auto;
            max-width: 450px;
            margin-bottom: 0.5rem;
            transition: transform 0.3s ease;
        }

        .logo-image:hover {
            transform: scale(1.05);
        }

        .logo-subtitle {
            color: #00C2A8;
            font-weight: 600;
            font-size: 0.8em;
        }

        .tagline {
            color: #666;
            font-size: 0.9rem;
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 3rem 0.75rem 1rem;
            border: 2px solid #e1e8ed;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #F39C12;
            box-shadow: 0 0 0 3px rgba(243,156,18,0.1);
        }

        .voice-search-btn {
            position: absolute;
            right: 10px;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .voice-search-btn:hover {
            background: #f0f0f0;
            color: #F39C12;
        }

        .voice-search-btn.recording {
            color: #e74c3c;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .header-stats {
            display: flex;
            gap: 2rem;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: #1B365D;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }

        .filter-controls {
            background: white;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e1e8ed;
        }

        .filter-section {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 2rem;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #e1e8ed;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: #F39C12;
            border-color: #F39C12;
            color: white;
            transform: translateY(-2px);
        }

        .clustering-section {
            margin-top: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .clustering-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .clustering-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .cluster-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #3498DB;
            background: white;
            color: #3498DB;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .cluster-btn:hover {
            background: #3498DB;
            color: white;
            transform: translateY(-1px);
        }

        .cluster-btn.active {
            background: #3498DB;
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }

        /* Random Alumni button styling */
        #meet-random-alumni:hover {
            background: #27AE60 !important;
            color: white !important;
            transform: translateY(-1px);
        }

        #meet-random-alumni:active {
            background: #229954 !important;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }

        /* Ensure button returns to normal state after click */
        #meet-random-alumni:focus {
            outline: none;
            background: white !important;
            color: #27AE60 !important;
            border-color: #27AE60 !important;
        }

        #meet-random-alumni:not(:hover):not(:active) {
            background: white !important;
            color: #27AE60 !important;
        }

        /* Degree Cluster Hamburger Menu */
        .degree-cluster-nav {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            z-index: 100;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .degree-hamburger {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            background: white;
            border: 2px solid #9b59b6;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #9b59b6;
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }

        .degree-hamburger:hover {
            background: #9b59b6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
        }

        .degree-hamburger.active {
            background: #9b59b6;
            color: white;
            border-radius: 10px 10px 0 0;
        }

        .degree-hamburger-icon {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .degree-hamburger-line {
            width: 18px;
            height: 2.5px;
            background: currentColor;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .degree-hamburger.active .degree-hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .degree-hamburger.active .degree-hamburger-line:nth-child(2) {
            opacity: 0;
        }

        .degree-hamburger.active .degree-hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        .degree-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 2px solid #9b59b6;
            border-top: none;
            border-radius: 0 10px 10px 10px;
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.2);
            min-width: 280px;
            opacity: 0;
            transform: translateY(-15px);
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 9;
        }

        .degree-dropdown.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .degree-category-btn {
            padding: 0.875rem 1.25rem;
            border: none;
            border-bottom: 1px solid rgba(155, 89, 182, 0.15);
            background: white;
            color: #9b59b6;
            border-radius: 0;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
        }

        .degree-category-btn:last-child {
            border-bottom: none;
            border-radius: 0 0 8px 8px;
        }

        .degree-category-btn:hover {
            background: #f8f4ff;
            color: #8e44ad;
            padding-left: 1.5rem;
        }

        .degree-category-btn.active {
            background: #9b59b6;
            color: white;
            font-weight: 600;
        }

        .degree-category-btn.active::before {
            content: '✓';
            margin-right: 0.25rem;
            font-weight: bold;
        }

        .degree-category-icon {
            font-size: 1.1em;
        }

        /* Second Level Hamburger Menu (Specific Degrees) */
        .degree-hamburger-secondary {
            display: none; /* Hidden by default */
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            background: white;
            border: 2px solid #e67e22;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #e67e22;
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }

        .degree-hamburger-secondary:hover {
            background: #e67e22;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(230, 126, 34, 0.3);
        }

        .degree-hamburger-secondary.active {
            background: #e67e22;
            color: white;
            border-radius: 10px 10px 0 0;
        }

        .degree-hamburger-secondary.show {
            display: inline-flex;
        }

        .degree-dropdown-secondary {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 2px solid #e67e22;
            border-top: none;
            border-radius: 0 10px 10px 10px;
            box-shadow: 0 6px 20px rgba(230, 126, 34, 0.2);
            min-width: 280px;
            opacity: 0;
            transform: translateY(-15px);
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 9;
            max-height: 300px;
            overflow-y: auto;
        }

        .degree-dropdown-secondary.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .degree-specific-btn {
            padding: 0.875rem 1.25rem;
            border: none;
            border-bottom: 1px solid rgba(230, 126, 34, 0.15);
            background: white;
            color: #e67e22;
            border-radius: 0;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
        }

        .degree-specific-btn:last-child {
            border-bottom: none;
            border-radius: 0 0 8px 8px;
        }

        .degree-specific-btn:hover {
            background: #fdf6f0;
            color: #d35400;
            padding-left: 1.5rem;
        }

        .degree-specific-btn.active {
            background: #e67e22;
            color: white;
            font-weight: 600;
        }

        .degree-specific-btn.active::before {
            content: '✓';
            margin-right: 0.25rem;
            font-weight: bold;
        }



        .main-content {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Upcoming Events Section */
        .upcoming-events {
            margin-bottom: 3rem;
            padding: 2rem 0;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 0 2rem;
        }

        .section-header h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #1B365D;
            margin: 0;
        }

        .view-all-link {
            color: #0B6BFF;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .view-all-link:hover {
            color: #00C2A8;
        }

        .events-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 1.5rem;
            padding: 0 2rem;
        }

        .event-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            border: 1px solid rgba(11, 107, 255, 0.1);
        }

        .event-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .event-card.featured {
            background: linear-gradient(135deg, #0B6BFF 0%, #00C2A8 100%);
            color: white;
            border: none;
        }

        .event-badge {
            position: absolute;
            top: -8px;
            right: 16px;
            background: #00C2A8;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .event-content h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0 0 1rem 0;
            color: inherit;
        }

        .event-date, .event-location {
            font-size: 0.9rem;
            margin: 0.5rem 0;
            opacity: 0.9;
        }

        .event-description {
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 1rem 0;
            opacity: 0.8;
        }

        .event-tags {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .tag {
            background: rgba(255, 255, 255, 0.2);
            color: inherit;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .event-card:not(.featured) .tag {
            background: rgba(11, 107, 255, 0.1);
            color: #0B6BFF;
        }

        .event-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: white;
            color: #0B6BFF;
        }

        .event-card.featured .btn-primary {
            background: rgba(255, 255, 255, 0.9);
            color: #0B6BFF;
        }

        .event-card:not(.featured) .btn-primary {
            background: #0B6BFF;
            color: white;
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .btn-primary:hover, .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Coming Soon Event Styles */
        .event-card.coming-soon {
            position: relative;
            opacity: 0.7;
        }

        .event-card.coming-soon .event-content {
            filter: blur(3px);
        }

        .event-card.coming-soon:hover {
            transform: none;
            opacity: 0.7;
        }

        .event-card.coming-soon:hover .event-content {
            filter: blur(3px);
        }

        .coming-soon-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(11, 107, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            z-index: 2;
            filter: none !important;
        }

        .coming-soon-text {
            background: rgba(11, 107, 255, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            filter: none !important;
        }

        /* Home Page Styles */
        .home-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .hero-section {
            text-align: center;
            padding: 4rem 0;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            margin-bottom: 3rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            color: #1B365D;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: #666;
            margin-bottom: 2.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hero-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-primary.hero-btn {
            background: #0B6BFF;
            color: white;
        }

        .btn-primary.hero-btn:hover {
            background: #0056CC;
            transform: translateY(-2px);
        }

        .btn-secondary.hero-btn {
            background: white;
            color: #0B6BFF;
            border: 2px solid #0B6BFF;
        }

        .btn-secondary.hero-btn:hover {
            background: #0B6BFF;
            color: white;
            transform: translateY(-2px);
        }

        .btn-link.hero-btn {
            background: transparent;
            color: #00C2A8;
            border: 1px solid #00C2A8;
        }

        .btn-link.hero-btn:hover {
            background: #00C2A8;
            color: white;
            transform: translateY(-2px);
        }



        /* Alumni Page Styles */
        .alumni-page {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .alumni-page-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .alumni-page-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1B365D;
            margin: 0;
        }

        .alumni-page-header .btn-secondary {
            background: white;
            color: #0B6BFF;
            border: 2px solid #0B6BFF;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .alumni-page-header .btn-secondary:hover {
            background: #0B6BFF;
            color: white;
            transform: translateY(-2px);
        }

        /* Enhanced Filter Controls */
        #alumni-filter-controls {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        #alumni-filter-controls .clustering-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1B365D;
            margin-bottom: 1rem;
        }

        #alumni-filter-controls .clustering-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        #alumni-filter-controls .cluster-btn {
            background: white;
            color: #0B6BFF;
            border: 2px solid #0B6BFF;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        #alumni-filter-controls .cluster-btn:hover,
        #alumni-filter-controls .cluster-btn.active {
            background: #0B6BFF;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(11, 107, 255, 0.3);
        }

        #alumni-filter-controls .cluster-btn.meet-random-alumni {
            background: white;
            color: #00C2A8;
            border-color: #00C2A8;
        }

        #alumni-filter-controls .cluster-btn.meet-random-alumni:hover {
            background: #00C2A8;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 194, 168, 0.3);
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
            min-height: 600px;
            width: 100%;
            transition: all 0.6s ease;
        }

        .cards-container.clustering {
            display: block;
            position: relative;
        }

        .cluster-group {
            margin-bottom: 5rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease forwards;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Old wide-bar header removed in favor of card-style header below */

        .cluster-cards {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            min-height: 360px;
            padding: 0;
        }

        /* Fanned Deck of Cards Layout - Centered with space for lifted cards */
        .cluster-cards.deck-mode {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            width: 100%;
            min-height: 750px;
            padding: 6rem 2rem 4rem 2rem;
            overflow-x: visible;
            overflow-y: visible;
            scroll-behavior: smooth;
            margin: 0 auto;
        }

        /* Multi-row cluster tuning: reduce per-row height and add vertical spacing to avoid hover collisions */
        .cluster-group.multi-row .cluster-cards.deck-mode { min-height: 420px; padding: 3rem 1rem 2.5rem; }
        .cluster-group.multi-row .cluster-cards.deck-mode + .cluster-cards.deck-mode { margin-top: 120px; }

        .cluster-cards.deck-mode .alumni-card {
            position: absolute;
            width: 320px;
            height: 520px;
            border-radius: 16px;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid rgba(0,0,0,0.06);
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            overflow: hidden;
            backdrop-filter: blur(10px);
            /* Dynamic positioning set by JavaScript - no rotation */
            transform: translateX(var(--card-x, 0px)) translateY(0px);
            z-index: var(--card-z, 1);
        }

        /* PURE Y-AXIS FLOATING ANIMATION - Card lifts UP from deck */
        .cluster-cards.deck-mode .alumni-card:hover {
            transform: translateX(var(--card-x, 0px)) translateY(calc(var(--card-y, 0px) - 120px)) !important;
            z-index: 100 !important;
            /* Smooth floating UP - natural ease-out like lifting a card */
            transition: transform 0.9s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        /* SMOOTH SETTLING DOWN - Card gently returns to deck */
        .cluster-cards.deck-mode .alumni-card:not(:hover) {
            /* Slower, gentle descent back into deck */
            transition: transform 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* CLICK FEEDBACK - Extra lift when pressed */
        .cluster-cards.deck-mode .alumni-card:active {
            transform: translateX(var(--card-x, 0px)) translateY(calc(var(--card-y, 0px) - 140px));
            /* Quick responsive lift */
            transition: transform 0.25s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Fanned deck entrance animation */
        .cluster-cards.deck-mode .alumni-card.clustering {
            opacity: 0;
            transform: translateX(var(--card-x, 0px)) translateY(100px) scale(0.8);
            animation: fannedCardSlideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes fannedCardSlideIn {
            to {
                opacity: 1;
                transform: translateX(var(--card-x, 0px)) translateY(var(--card-y, 0px)) scale(1);
            }
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes fadeInGroup {
            from {
                opacity: 0;
                transform: translate3d(0, 15px, 0);
            }
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        .cluster-group {
            opacity: 0;
            animation: fadeInGroup 0.4s ease-out forwards;
        }

        .alumni-card {
            width: 100%;
            height: auto;
            min-height: 320px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08), 0 8px 32px rgba(0,0,0,0.12);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.06);
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            will-change: transform, opacity;
        }

        .alumni-card:hover:not(.cluster-cards.deck-mode .alumni-card) {
            transform: translate3d(0, -4px, 0);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 16px 48px rgba(0,0,0,0.15);
            border-color: rgba(0,0,0,0.1);
        }

        /* Override for normal view only */
        .cards-container:not(.clustering) .alumni-card:hover {
            transform: translate3d(0, -4px, 0);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 16px 48px rgba(0,0,0,0.15);
            border-color: rgba(0,0,0,0.1);
        }

        /* Sticky cluster jump navigation */
        .cluster-jump-nav {
            position: sticky;
            top: 64px;
            z-index: 850;
            display: flex;
            gap: 0.6rem;
            padding: 0.6rem 0.75rem;
            margin: 0 0 0.75rem 0;
            background: #ffffff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.06);
            border-radius: 12px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .cluster-jump-chip {
            flex: 0 0 auto;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.92rem;
            line-height: 1;
            padding: 0.55rem 0.8rem;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.08);
            background: #fff;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
        }

        .cluster-jump-chip:hover {
            background: #f9fafb;
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.06);
        }

        .cluster-jump-chip .chip-title { color: #1B365D; font-weight: 600; }
        .cluster-jump-chip .chip-count {
            font-size: 0.82rem;
            color: #1B365D;
            background: #F3F4F6;
            padding: 0.2rem 0.5rem;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.06);
        }

        /* Cluster group header - inline (non-sticky) + collapse affordance */
        .cluster-group { scroll-margin-top: 0; position: relative; margin: 0 0 8px 0; }
        /* remove leftover header bar style */
        .cluster-header { display: none; }

        .cluster-group:nth-child(even) .cluster-card { background: #F8FAFC; }
        .cluster-card .header-left, .cluster-card .header-right { display: inline-flex; align-items: center; gap: 8px; }
        .cluster-card .preview-avatars { display: inline-flex; align-items: center; gap: 4px; margin-right: 4px; }
        .cluster-card .preview-avatars .avatar {
            width: 20px; height: 20px; border-radius: 50%;
            background: #E5E7EB; border: 1px solid rgba(0,0,0,0.08);
            display: inline-block;
        }
        .cluster-card .stat.pill { font-size: 0.8rem; line-height: 1; padding: 0.28rem 0.5rem; border-radius: 999px; border: 1px solid rgba(0,0,0,0.06); background: #F3F4F6; color: #1B365D; }
        .cluster-card .stat.pill.green { background: #ECFDF5; border-color: #A7F3D0; }
        .cluster-card .stat.pill.gray { background: #F3F4F6; }
        .cluster-card .stat.pill.blue { background: #EEF2FF; border-color: #C7D2FE; }

        .cluster-card .cluster-badge { width: 18px; height: 18px; border-radius: 50%; border: 3px solid #ccc; }
        .cluster-card .cluster-title { font-weight: 600; font-size: 1rem; color: #1B365D; }
        .cluster-card .cluster-count { font-size: 0.85rem; background: #F3F4F6; color: #1B365D; padding: 0.25rem 0.6rem; border-radius: 999px; border: 1px solid rgba(0,0,0,0.06); }
        .cluster-card .toggle-icon { margin-left: 0.5rem; transition: transform 0.25s ease; }
        .cluster-group.collapsed .toggle-icon { transform: rotate(-90deg); }

        /* Collapsible deck container */
        .cluster-cards.deck-mode { transition: max-height 0.4s ease, opacity 0.3s ease; overflow: visible; position: relative; z-index: 1; }
        .cluster-group.collapsed .cluster-cards.deck-mode { max-height: 0 !important; min-height: 0 !important; opacity: 0.0; pointer-events: none; margin: 0 !important; padding: 0 !important; }

        /* Tighten header-to-deck spacing */
        .cluster-card + .cluster-cards.deck-mode { margin-top: 20px; }

        /* Cluster header as a true card with progress ring */
        .cluster-card { position: relative; }
        .cluster-card .ring {
            width: 44px; height: 44px; border-radius: 50%; position: relative;
            background: conic-gradient(#27AE60 calc(var(--pct, 0) * 1%), #E5E7EB 0);
        }
        .cluster-card .ring-inner {
            position: absolute; inset: 4px; background: #fff; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.7rem; color: #1B365D; font-weight: 700;
        }

        /* Opening animation for decks */
        .cluster-group.opening .cluster-cards.deck-mode { animation: deckReveal 0.35s ease-out both; }
        @keyframes deckReveal { from { opacity: 0; transform: translateY(-6px); } to { opacity: 1; transform: translateY(0); } }

        /* Enforce card-sized headers (avoid full-width bars) */
        .cluster-group .cluster-card {
            display: grid !important;
            grid-template-columns: 52px 1fr auto !important;
            width: clamp(300px, 50vw, 460px) !important;
            align-self: center !important;
            margin-left: 0 !important;
            padding: 12px 14px !important;
            border-radius: 16px !important;
            background: linear-gradient(180deg, #ffffff, #fafbfc) !important;
        }

        /* Overview grid of cluster cards - 3+2 layout */
        .cluster-overview-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 24px;
            align-items: stretch;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .cluster-overview-grid .alumni-card {
            width: 280px;
            flex-shrink: 0;
        }
        
        /* Force 3+2 layout - center the bottom row properly */
        .cluster-overview-grid .alumni-card:nth-child(4) {
            margin-left: calc(50% - 280px - 12px);
        }
        
        .cluster-overview-grid .alumni-card:nth-child(5) {
            margin-right: calc(50% - 280px - 12px);
        }
        
        @media (max-width: 768px) { 
            .cluster-overview-grid .alumni-card { width: 240px; }
            .cluster-overview-grid { gap: 16px; } 
            
            /* Update mobile centering for 240px cards */
            .cluster-overview-grid .alumni-card:nth-child(4) {
                margin-left: calc(50% - 240px - 8px);
            }
            
            .cluster-overview-grid .alumni-card:nth-child(5) {
                margin-right: calc(50% - 240px - 8px);
            }
        }

        /* Use alumni card visual style */
        .cluster-select.alumni-card { cursor: pointer; }
        .cluster-select.alumni-card:hover { transform: translateY(-4px); }
        .cluster-select .title { font-weight: 800; font-size: 1.1rem; color: #1B365D; text-align:center; letter-spacing:-0.01em; }
        
        /* Degree results container */
        .degree-results-container {
            margin-top: 2rem;
            min-height: 200px;
        }
        .cluster-select .meta { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:8px; }
        .cluster-select .pill { font-size: 0.85rem; padding: 6px 10px; border-radius: 999px; background:#F3F4F6; border:1px solid rgba(0,0,0,0.06); color:#1B365D; }
        .cluster-select .chev { font-size: 1rem; color:#1B365D; }
        .cluster-select.expanded { transform: translateY(16px); }

        .cluster-expansion-row { 
            width: 100%; 
            margin-top: 12px; 
            display: flex;
            justify-content: center;
        }

        /* Expansion grid under selected tile: same as main page grid */
        .cluster-expansion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 1400px;
            margin: 12px auto 24px;
            padding: 1rem;
            box-sizing: border-box;
        }
        @media (max-width: 1400px) { .cluster-expansion-grid { grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 1.2rem; } }
        @media (max-width: 1024px) { .cluster-expansion-grid { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 1rem; padding: 0.5rem; } }

        /* Keep alumni cards same as main page - no overrides needed */
        .cluster-expansion-grid .alumni-card {
            /* Remove all custom sizing - let it use main page styles */
            position: relative !important;
            width: 100% !important;
            height: auto !important;
            min-height: 320px !important;
            margin: 0 !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }
        
        /* Use main page hover animation */
        .cluster-expansion-grid .alumni-card:hover {
            transform: translate3d(0, -4px, 0) !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 16px 48px rgba(0,0,0,0.15) !important;
            border-color: rgba(0,0,0,0.1) !important;
        }

        .deal-in { opacity: 0; transform: translateY(-12px); animation: dealIn 0.4s ease-out forwards; }
        @keyframes dealIn { to { opacity: 1; transform: translateY(0); } }

        /* Cluster Overview Tiles (optional summary grid) */
        .cluster-overview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
            padding: 8px 0 14px;
            margin-bottom: 10px;
        }
        .cluster-tile {
            display: grid;
            grid-template-columns: 42px 1fr auto;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border-radius: 14px;
            border: 1px solid rgba(0,0,0,0.06);
            background: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.06);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .cluster-tile:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
        .cluster-tile .ring { width: 38px; height: 38px; border-radius: 50%; background: conic-gradient(#27AE60 calc(var(--pct,0)*1%), #E5E7EB 0); position: relative; }
        .cluster-tile .ring-inner { position: absolute; inset: 3px; background: #fff; border-radius: 50%; display:flex; align-items:center; justify-content:center; font-size: 0.68rem; color:#1B365D; font-weight:700; }
        .cluster-tile .title { font-weight: 700; font-size: 0.96rem; color:#1B365D; letter-spacing:-0.01em; }
        .cluster-tile .subtitle { font-size: 0.8rem; color:#6b7280; }
        .cluster-tile .pills { display:flex; align-items:center; gap:6px; }
        .cluster-tile .pill { font-size: 0.75rem; padding: 3px 8px; border-radius: 999px; background:#F3F4F6; border:1px solid rgba(0,0,0,0.06); color:#1B365D; }
        .cluster-tile .chev { font-size: 0.9rem; color:#1B365D; }

        .card-content {
            padding: 1.5rem 1.5rem;
            display: flex;
            flex-direction: column;
            height: 100%;
            background: linear-gradient(180deg, #ffffff 0%, #fafbfc 100%);
        }

        .card-header {
            text-align: center;
            margin-bottom: 1.25rem;
            position: relative;
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            left: 50%;
            transform: translateX(-50%);
            width: 25px;
            height: 2px;
            background: linear-gradient(90deg, #1B365D, #3498DB);
            border-radius: 1px;
        }

        /* (Badges removed per request) */

        .profile-photo {
            width: 75px;
            height: 75px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            margin: 0 auto;
            border: 3px solid #e9ecef;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* Class-based border colors */
        .profile-photo.class-2021 { border-color: #FF6B6B !important; } /* Coral Red - 2021 */
        .profile-photo.class-2022 { border-color: #4ECDC4 !important; } /* Teal - 2022 */
        .profile-photo.class-2023 { border-color: #45B7D1 !important; } /* Sky Blue - 2023 */
        .profile-photo.class-2024 { border-color: #96CEB4 !important; } /* Sage Green - 2024 */
        .profile-photo.class-2025 { border-color: #FFEAA7 !important; } /* Golden Yellow - 2025 */
        .profile-photo.class-unknown { border-color: #95A5A6 !important; } /* Gray - Unknown */

        .profile-photo:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #ccc;
            font-size: 2rem;
        }

        .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .alumni-name {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
            text-align: center;
            letter-spacing: -0.02em;
            line-height: 1.3;
        }

        .graduation-class {
            color: #6c757d;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
            text-align: center;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .degree-info {
            color: #495057;
            font-size: 0.875rem;
            font-weight: 400;
            margin-bottom: 1.25rem;
            text-align: center;
            font-style: italic;
            opacity: 0.9;
        }

        .professional-info {
            flex: 1;
            margin-bottom: 1.5rem;
            background: rgba(248, 249, 250, 0.5);
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid #3498DB;
        }

        .current-position {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.05rem;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .company-name {
            color: #495057;
            font-weight: 500;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .industry-name {
            color: #6c757d;
            font-size: 0.875rem;
            text-transform: capitalize;
            font-weight: 400;
            opacity: 0.9;
        }

        .card-footer {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(0,0,0,0.06);
        }

        .linkedin-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #0A66C2, #0e76d3);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
            justify-content: center;
            border: none;
            box-shadow: 0 2px 6px rgba(10, 102, 194, 0.2);
        }

        .linkedin-button:hover {
            background: linear-gradient(135deg, #004182, #0056b3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(10, 102, 194, 0.3);
        }

        .linkedin-placeholder {
            color: #6c757d;
            font-size: 0.875rem;
            text-align: center;
            padding: 0.75rem 1.25rem;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            font-weight: 500;
        }

        .attending-badge {
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.25);
            border: none;
        }

        .not-attending {
            background: #f8f9fa;
            color: #6c757d;
            padding: 0.75rem 1.25rem;
            border-radius: 6px;
            font-size: 0.875rem;
            text-align: center;
            border: 1px solid #e9ecef;
            font-weight: 500;
        }



        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .notification.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #27AE60;
        }

        .fade-in {
            opacity: 0;
            transform: translate3d(0, 20px, 0);
            animation: fadeInSmooth 0.6s ease-out forwards;
        }

        @keyframes fadeInSmooth {
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-content.network-modal-content {
            max-width: 65vw;
            width: 65vw;
            max-height: 70vh;
            height: 70vh;
            padding: 0;
        }

        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #f0f0f0;
            color: #333;
        }

        .detail-modal {
            text-align: left;
        }

        /* Network Visualization Modal Styles */
        .network-modal {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #f8fafc;
            border-radius: 12px;
            overflow: hidden;
        }

        .network-header {
            background: linear-gradient(135deg, #0B6BFF 0%, #00C2A8 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 12px 12px 0 0;
        }

        .network-header h2 {
            margin: 0 0 0.5rem 0;
            font-size: 2rem;
            font-weight: 700;
        }

        .network-header p {
            margin: 0 0 1rem 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .network-filters {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .filter-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            background: white;
            border: 2px solid #0B6BFF;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #0B6BFF;
        }

        .filter-btn:hover {
            background: #0B6BFF;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(11, 107, 255, 0.3);
        }

        .filter-btn.active {
            background: #0B6BFF;
            border-color: #0B6BFF;
            color: white;
            box-shadow: 0 4px 12px rgba(11, 107, 255, 0.3);
        }

        .filter-btn.clear-filters {
            background: white;
            border-color: #00C2A8;
            color: #00C2A8;
        }

        .filter-btn.clear-filters:hover {
            background: #00C2A8;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 194, 168, 0.3);
        }

        .filter-icon {
            font-size: 14px;
        }

        .filter-label {
            font-size: 11px;
            font-weight: 600;
        }

        .network-content {
            position: relative;
            background: linear-gradient(135deg, rgba(11, 107, 255, 0.02) 0%, rgba(0, 194, 168, 0.02) 100%);
            display: flex;
            min-height: 500px;
            border-radius: 12px;
        }

        .network-left-panel {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            border-right: 1px solid rgba(11, 107, 255, 0.1);
            padding: 1.5rem;
            border-radius: 12px 0 0 12px;
            backdrop-filter: blur(10px);
        }

        .network-right-panel {
            flex: 1;
            position: relative;
        }

        .network-alumni-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
        }

        .network-alumni-card .profile-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .network-alumni-card .profile-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 3px solid #F39C12;
            flex-shrink: 0;
            overflow: hidden;
        }

        .network-alumni-card .profile-info h3 {
            margin: 0 0 0.25rem 0;
            color: #1B365D;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .network-alumni-card .profile-info p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .network-alumni-card .details-section {
            display: grid;
            gap: 0.75rem;
        }

        .network-alumni-card .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .network-alumni-card .detail-item .icon {
            width: 20px;
            text-align: center;
        }

        .network-alumni-card .detail-item .label {
            font-weight: 500;
            color: #1B365D;
        }

        .network-alumni-card .detail-item .value {
            color: #666;
        }

        .network-connections-details {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .network-connections-details h4 {
            margin: 0 0 1rem 0;
            color: #1B365D;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .connection-category {
            margin-bottom: 1.5rem;
        }

        .connection-category:last-child {
            margin-bottom: 0;
        }

        .connection-category h5 {
            margin: 0 0 0.75rem 0;
            color: #1B365D;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .connection-category .category-icon {
            font-size: 1.1rem;
        }

        .connection-category .category-count {
            background: #667eea;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: auto;
        }

        .connection-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            gap: 0.5rem;
        }

        .connection-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            background: #f8fafc;
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .connection-item:hover {
            background: #e2e8f0;
        }

        .connection-item .connection-photo {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            color: #1B365D;
            flex-shrink: 0;
            overflow: hidden;
        }

        .connection-item .connection-info {
            flex: 1;
            min-width: 0;
        }

        .connection-item .connection-name {
            font-weight: 500;
            color: #1a202c;
            margin-bottom: 0.1rem;
        }

        .connection-item .connection-detail {
            color: #666;
            font-size: 0.75rem;
        }

        .network-visualization {
            width: 100%;
            height: 100%;
            border-radius: 0 0 12px 12px;
        }

        .network-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .network-controls select {
            width: 200px;
            padding: 0.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.9rem;
            background: white;
            color: #1a202c;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }

        .network-controls select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .network-controls label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #1B365D;
            font-size: 0.9rem;
        }

        .network-sidebar {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 10;
        }

        .network-sidebar h3 {
            margin: 0 0 1rem 0;
            font-size: 1.1rem;
            color: #1B365D;
            font-weight: 600;
        }

        .most-connected {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .most-connected li {
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background: #f8fafc;
            border-radius: 6px;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .most-connected .name {
            font-weight: 500;
            color: #1a202c;
        }

        .most-connected .connections {
            background: #667eea;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }



        /* Network node and link styles */
        .network-visualization .link {
            stroke: #999;
            stroke-opacity: 0.6;
        }

        .network-visualization .node {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .network-visualization .node:hover {
            transform: scale(1.1);
        }

        .network-visualization .node circle {
            stroke: #fff;
            stroke-width: 2px;
        }

        .network-visualization .node text {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            font-weight: 500;
            text-anchor: middle;
            fill: #1a202c;
            pointer-events: none;
        }

        /* Connected Alumni Cards Styles */
        .connected-alumni-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 0;
            padding: 12px;
            width: 100%;
            align-content: flex-start;
            justify-content: flex-start;
            position: relative;
        }

        .connected-alumni-card {
            width: 200px;
            height: 280px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 16px;
            color: white;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            margin: 0;
        }



        .connected-alumni-card .card-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 12px;
            border: 3px solid rgba(255,255,255,0.3);
        }

        .connected-alumni-card .card-name {
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 8px;
            line-height: 1.2;
        }

        .connected-alumni-card .card-role {
            font-size: 12px;
            text-align: center;
            opacity: 0.9;
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .connected-alumni-card .card-details {
            font-size: 11px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .connected-alumni-card .card-detail-item {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
            gap: 6px;
        }

        .connected-alumni-card .card-detail-icon {
            width: 12px;
            text-align: center;
            flex-shrink: 0;
        }



        .connected-alumni-card.cohort {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .connected-alumni-card.professional {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }

        .connected-alumni-card.friendship {
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
        }

        /* Filter-based card styling */
        .connected-alumni-card.class-connection {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .connected-alumni-card.degree-connection {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .connected-alumni-card.industry-connection {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .connected-alumni-card.company-connection {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .connected-alumni-card.general-connection {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }

        /* Connection badges at bottom of card */
        .connection-badges {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .connection-badge {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 9px;
            font-weight: 600;
            backdrop-filter: blur(5px);
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            display: inline-flex;
            align-items: center;
            gap: 2px;
        }

        .connection-badge.class-badge {
            background: rgba(231, 76, 60, 0.9);
            color: white;
        }

        .connection-badge.degree-badge {
            background: rgba(52, 152, 219, 0.9);
            color: white;
        }

        .connection-badge.industry-badge {
            background: rgba(39, 174, 96, 0.9);
            color: white;
        }

        .connection-badge.company-badge {
            background: rgba(243, 156, 18, 0.9);
            color: white;
        }

        /* Animation for connected alumni cards */
        .connected-alumni-card.fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Smooth card entrance animation */
        .connected-alumni-card.fan-in {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            animation: smoothSlideIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        @keyframes smoothSlideIn {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            60% {
                opacity: 0.8;
                transform: translateY(-5px) scale(1.02);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Smooth hover animation */
        .connected-alumni-card {
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .connected-alumni-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
            border-color: rgba(255,255,255,0.4);
            z-index: 10;
        }

        /* Smooth click animation */
        .connected-alumni-card:active {
            transform: translateY(-4px) scale(1.01);
            transition: all 0.15s ease;
        }

        /* Mini Card Styles */
        .mini-card {
            transform: scale(0.5) !important;
            transform-origin: top center !important;
            width: 200px !important;
            height: 280px !important;
            margin: 0 !important;
            display: block !important;
        }

        .mini-card:hover {
            transform: scale(0.55) translateY(-15px) !important;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;
            z-index: 10 !important;
        }

        .mini-card .alumni-name {
            font-size: 14px !important;
        }

        .mini-card .graduation-class,
        .mini-card .degree-info,
        .mini-card .current-position,
        .mini-card .company-name,
        .mini-card .industry-name {
            font-size: 11px !important;
        }

        .mini-card .profile-photo {
            width: 60px !important;
            height: 60px !important;
        }

        .mini-card .linkedin-button {
            font-size: 10px !important;
            padding: 4px 8px !important;
        }

        .mini-card .attending-status {
            font-size: 9px !important;
            padding: 2px 6px !important;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .network-modal {
                height: 70vh;
            }

            .network-controls,
            .network-sidebar {
                position: relative;
                width: auto;
                margin-bottom: 1rem;
            }

            .network-content {
                padding: 1rem;
            }

            .network-controls select {
                width: 100%;
            }

            .network-sidebar {
                width: 100%;
            }
        }

        .detail-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f0f0f0;
        }

        .detail-photo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 4px solid #F39C12;
            flex-shrink: 0;
            overflow: hidden;
        }

        .detail-info h2 {
            color: #1B365D;
            margin-bottom: 0.5rem;
        }

        .detail-role {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .detail-location {
            color: #999;
            font-size: 0.9rem;
        }

        .detail-sections {
            display: grid;
            gap: 1.5rem;
        }

        .detail-section h4 {
            color: #1B365D;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .detail-section ul {
            list-style: none;
            padding: 0;
        }

        .detail-section li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid #f0f0f0;
        }

        .btn-connect,
        .btn-message,
        .btn-qr {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-connect {
            background: #F39C12;
            color: white;
        }

        .btn-connect:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }

        .btn-message {
            background: #3498db;
            color: white;
        }

        .btn-message:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-qr {
            background: #9b59b6;
            color: white;
        }

        .btn-qr:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        /* Responsive Grid Breakpoints */
        @media (max-width: 1400px) {
            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
                gap: 1.2rem;
            }
        }

        @media (max-width: 1024px) {
            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: 1rem;
                padding: 0.5rem;
            }
        }

        /* Tablet responsive settings */
        @media (max-width: 1024px) and (min-width: 769px) {
            .cluster-cards.deck-mode {
                padding: 5rem 1.5rem 3rem 1.5rem;
                min-height: 680px;
            }

            .cluster-cards.deck-mode .alumni-card {
                width: 300px;
                height: 480px;
            }

            .cluster-cards.deck-mode .alumni-card:hover {
                transform: translateX(var(--card-x, 0px)) translateY(-100px) !important;
                transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1) !important;
            }

            .cluster-cards.deck-mode .alumni-card:not(:hover) {
                transition: transform 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }
        }

        @media (max-width: 768px) {
            .header-content,
            .filter-section {
                flex-direction: column;
                gap: 1rem;
            }

            .logo-image {
                height: 65px;
                max-width: 350px;
            }

            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1rem;
                padding: 0.5rem;
            }

            .alumni-card {
                min-height: 300px;
            }

            .card-content {
                padding: 1.5rem 1.25rem;
            }

            .professional-info {
                padding: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .header-stats {
                gap: 1rem;
            }

            .filter-buttons {
                justify-content: center;
            }

            /* Events Section Mobile Styles */
            .upcoming-events {
                margin-bottom: 2rem;
                padding: 1rem 0;
            }

            .section-header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
                padding: 0 1rem;
            }

            .section-header h2 {
                font-size: 1.5rem;
            }

            .events-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 0 1rem;
            }

            .event-card {
                padding: 1rem;
            }

            .event-content h3 {
                font-size: 1.1rem;
            }

            .event-actions {
                flex-direction: column;
                gap: 0.5rem;
            }

            .btn-primary, .btn-secondary {
                width: 100%;
                text-align: center;
                padding: 12px 16px;
            }

            /* Home Page Mobile Styles */
            .home-page {
                padding: 1rem;
            }

            .hero-section {
                padding: 2rem 1rem;
                margin-bottom: 2rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .hero-actions {
                flex-direction: column;
                align-items: center;
            }

            .hero-btn {
                width: 100%;
                max-width: 300px;
                text-align: center;
            }



            .alumni-page {
                padding: 1rem;
            }

            .alumni-page-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .alumni-page-header h2 {
                font-size: 1.5rem;
            }

            .modal-content {
                padding: 1.5rem;
                width: 95%;
            }

            .detail-header {
                flex-direction: column;
                text-align: center;
            }

            .detail-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .cards-container {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 0.5rem;
            }

            .alumni-card {
                min-height: 280px;
            }

            .card-content {
                padding: 1.25rem 1rem;
            }

            .professional-info {
                padding: 0.875rem;
            }

            .profile-photo {
                width: 80px;
                height: 80px;
            }

            .clustering-section {
                margin-top: 1rem;
                flex-direction: column;
                gap: 0.75rem;
            }

            .clustering-buttons {
                justify-content: center;
            }

            .cluster-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }

            /* Mobile responsive settings */
            .cluster-cards.deck-mode {
                padding: 4rem 1rem 2rem 1rem;
                min-height: 620px;
                overflow-x: auto;
            }

            .cluster-cards.deck-mode .alumni-card {
                width: 260px;
                height: 440px;
            }

            .cluster-cards.deck-mode .alumni-card:hover {
                transform: translateX(var(--card-x, 0px)) translateY(-80px) !important;
                transition: transform 0.7s cubic-bezier(0.16, 1, 0.3, 1) !important;
            }

            .cluster-cards.deck-mode .alumni-card:not(:hover) {
                transition: transform 1.1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }

            /* Mobile Width and Centering Fixes */
            * {
                max-width: 100%;
                box-sizing: border-box;
            }

            .header-content,
            .filter-section,
            .main-content,
            .home-page,
            .alumni-page {
                width: 100%;
                padding-left: 1rem;
                padding-right: 1rem;
                margin-left: auto;
                margin-right: auto;
            }

            .cards-container {
                width: 100%;
                padding: 0.5rem;
                justify-content: center;
            }

            .alumni-card {
                max-width: calc(100vw - 2rem);
                margin: 0 auto;
            }

            /* Prevent horizontal overflow */
            .cluster-overview-grid,
            .cluster-expansion-grid {
                width: 100%;
                padding: 0.5rem;
                overflow-x: hidden;
            }

            /* Center align text and content */
            .section-header,
            .hero-section {
                text-align: center;
                width: 100%;
            }
        }

        /* Extra Small Mobile Devices (480px and below) */
        @media (max-width: 480px) {
            .header-content,
            .filter-section,
            .main-content,
            .home-page,
            .alumni-page {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }

            .cards-container {
                grid-template-columns: 1fr;
                gap: 0.75rem;
                padding: 0.25rem;
            }

            .alumni-card {
                min-width: auto;
                max-width: calc(100vw - 1rem);
            }

            .logo-image {
                height: 50px;
                max-width: 280px;
            }

            .cluster-overview-grid .alumni-card {
                width: calc(100vw - 2rem);
                max-width: 320px;
            }
        }


    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="40" cy="40" r="35" stroke="#F8F9FA" stroke-width="2" fill="none" opacity="0.3"/>
                    <circle cx="40" cy="40" r="35" stroke="#F39C12" stroke-width="3" fill="none" 
                            stroke-linecap="round" stroke-dasharray="180" class="loading-circle"/>
                </svg>
            </div>
            <h2>LEADERS Summit 2025</h2>
            <p>Loading alumni network...</p>
            <div class="loading-progress">
                <div class="loading-bar" id="loading-bar"></div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo" onclick="window.alumniApp?.showHomePage()" style="cursor: pointer; text-align: center !important;">
                <img src="https://raw.githubusercontent.com/HarelItay/leaders-alumni-association/main/images/companies/Leaders%20Alumni_full%20color.svg?cachebust=12345" alt="LEADERS Alumni Association" style="width: 350px !important; height: auto !important; display: block !important; margin: 0 auto 0.5rem auto !important; transition: transform 0.3s ease !important;" onload="console.log('Logo loaded with dimensions:', this.naturalWidth, 'x', this.naturalHeight)">
                <p class="tagline" style="text-align: center; margin: 0 auto;">Where LEADERS alumni connect, grow, and give back</p>
            </div>
            
            <div class="search-container" id="search-container" style="display: none;">
                <div class="search-input-wrapper">
                    <input type="text" id="ai-search" class="search-input" placeholder="Search alumni by name, company, role, or expertise..." autocomplete="off" aria-label="Search alumni database">
                    <button class="voice-search-btn" id="voice-search" title="Voice search">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 1a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" fill="currentColor"/>
                            <path d="M13 8c0 2.76-2.24 5-5 5s-5-2.24-5-5M8 13v3M6 16h4" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="header-stats">
                <div class="stat" data-target="0" id="stat-alumni">
                    <span class="stat-number" id="total-alumni">0</span>
                    <span class="stat-label">Alumni</span>
                </div>
                <div class="stat" data-target="0" id="stat-industries">
                    <span class="stat-number" id="industries-count">0</span>
                    <span class="stat-label">Industries</span>
                </div>
                <div class="stat" data-target="0" id="stat-companies">
                    <span class="stat-number" id="companies-count">0</span>
                    <span class="stat-label">Companies</span>
                </div>
                <div class="stat" data-target="0" id="stat-degrees">
                    <span class="stat-number" id="degrees-count">0</span>
                    <span class="stat-label">Degrees</span>
                </div>
            </div>
        </div>
    </header>



    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page Section -->
        <section class="home-page" id="home-page" style="display: block;">
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">Your lifelong LEADERS network</h1>
                    <p class="hero-subtitle">Find peers by expertise, discover events, and unlock opportunities.</p>
                    
                    <div class="hero-actions">
                        <button class="btn-primary hero-btn" onclick="window.alumniApp?.showAlumniPage()">
                            Explore Alumni
                        </button>
                        <button class="btn-secondary hero-btn" onclick="window.alumniApp?.meetRandomAlumni()">
                            Meet Random Alumni
                        </button>
                        <a href="/events/summit-2025" class="btn-link hero-btn">
                            Register for Summit 2025 →
                        </a>
                    </div>
                </div>
            </section>


        </section>

        <!-- Alumni Page Section (Hidden by default) -->
        <section class="alumni-page" id="alumni-page" style="display: none;">
            <!-- Search Section for Alumni Page -->
            <div class="alumni-page-header">
                <h2>Explore Alumni Network</h2>
                <button class="btn-secondary" onclick="window.alumniApp?.showHomePage()">
                    ← Back to Home
                </button>
            </div>
            
            <!-- Move clustering controls here -->
            <nav class="filter-controls" id="alumni-filter-controls">
                <div class="filter-section">
                    <div class="clustering-section">
                        <div class="clustering-label">📊 Smart Clustering:</div>
                        <div class="clustering-buttons">
                            <button class="cluster-btn" data-cluster="none">🌐 Normal View</button>
                            <button class="cluster-btn" data-cluster="class">📚 Group by Class</button>
                            <button class="cluster-btn" data-cluster="degree">🎓 Group by Degree</button>
                            <button class="cluster-btn" data-cluster="industry">🏢 Group by Industry</button>
                            <button class="cluster-btn meet-random-alumni" id="meet-random-alumni">🎲 Meet Random Alumni</button>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Alumni cards container -->
            <div class="cards-container" id="cards-container">
                <!-- Cards will be dynamically generated here -->
            </div>
        </section>

        <!-- Upcoming Events Section -->
        <section class="upcoming-events" id="upcoming-events" aria-labelledby="events-heading">
            <div class="section-header">
                <h2 id="events-heading">Upcoming Events</h2>
            </div>
            
            <div class="events-grid">
                <!-- Summit 2025 - Real Event -->
                <article class="event-card featured" role="article" aria-labelledby="summit-2025-title">
                    <div class="event-badge">Next Event</div>
                    <div class="event-content">
                        <h3 id="summit-2025-title">LEADERS Summit 2025</h3>
                        <p class="event-date">📅 August 21, 2025 • 7:00 PM</p>
                        <p class="event-location">📍 Lusha's Offices, Tel Aviv</p>
                        <p class="event-description">Join the LEADERS alumni community for an evening of networking, insights, and inspiration. Connect with fellow alumni, share experiences, and discover new opportunities in the heart of Tel Aviv's tech scene.</p>
                        <div class="event-tags">
                            <span class="tag">Networking</span>
                            <span class="tag">Alumni</span>
                            <span class="tag">Tel Aviv</span>
                        </div>
                        <div class="event-actions">
                            <button class="btn-primary" onclick="window.open('https://airtable.com/apphdbhRjPRvqApz0/shrTNSilpBsmGadv2', '_blank')" aria-label="RSVP for Summit 2025">
                                RSVP Now
                            </button>
                        </div>
                    </div>
                </article>

                <!-- Coming Soon Events -->
                <article class="event-card coming-soon" role="article" aria-labelledby="networking-event-title">
                    <div class="coming-soon-overlay">
                        <div class="coming-soon-text">Coming Soon</div>
                    </div>
                    <div class="event-content">
                        <h3 id="networking-event-title">Industry Networking Events</h3>
                        <p class="event-date">📅 Dates TBD</p>
                        <p class="event-location">📍 Multiple Locations</p>
                        <p class="event-description">Connect with LEADERS alumni across different industries. More details coming soon!</p>
                        <div class="event-tags">
                            <span class="tag">Networking</span>
                            <span class="tag">Industry</span>
                        </div>
                    </div>
                </article>

                <article class="event-card coming-soon" role="article" aria-labelledby="mentorship-event-title">
                    <div class="coming-soon-overlay">
                        <div class="coming-soon-text">Coming Soon</div>
                    </div>
                    <div class="event-content">
                        <h3 id="mentorship-event-title">Mentorship Programs</h3>
                        <p class="event-date">📅 Launching Soon</p>
                        <p class="event-location">📍 Virtual & In-Person</p>
                        <p class="event-description">Comprehensive mentorship programs connecting experienced alumni with emerging professionals.</p>
                        <div class="event-tags">
                            <span class="tag">Mentorship</span>
                            <span class="tag">Development</span>
                        </div>
                    </div>
                </article>
            </div>
        </section>

    </main>

    <!-- Modal for Alumni Details -->
    <div class="modal-overlay" id="modal-overlay" aria-hidden="true">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        console.log('🚀 STARTING ENHANCED ALUMNI NETWORKING APP - SINGLE FILE VERSION');
        
        // Enhanced Alumni App - Complete Single File Version with NO module dependencies
        class EnhancedAlumniApp {
            constructor() {
                this.alumniData = [];
                this.filteredData = [];
                this.currentView = 'cards';
                this.isVoiceRecording = false;
                this.recognition = null;
                this.currentFilters = { all: true };
                this.statsAnimated = false;
                
                console.log('📱 Initializing Enhanced Alumni App...');
                this.init();
            }

            // Convert Google Drive shared links to direct image URLs
            convertGoogleDriveUrl(shareUrl) {
                if (!shareUrl || typeof shareUrl !== 'string') return '';
                
                // Check if it's already a direct Google Drive URL
                if (shareUrl.includes('drive.google.com/uc?id=')) {
                    return shareUrl;
                }
                
                // Extract file ID from share URL
                const fileIdMatch = shareUrl.match(/\/d\/([a-zA-Z0-9-_]+)/);
                if (fileIdMatch) {
                    return `https://drive.google.com/uc?id=${fileIdMatch[1]}`;
                }
                
                return shareUrl; // Return original if not a Google Drive URL
            }

            // Animate stats with count-up effect
            animateStats() {
                // Reset animation flag to allow re-animation with new data
                this.statsAnimated = false;
                
                if (this.statsAnimated) return;
                
                const stats = document.querySelectorAll('.stat[data-target]');
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const stat = entry.target;
                            const target = parseInt(stat.dataset.target);
                            const numberElement = stat.querySelector('.stat-number');
                            
                            if (target > 0) { // Only animate if we have real data
                                this.countUp(numberElement, 0, target, 2000);
                            }
                            observer.unobserve(stat);
                        }
                    });
                });
                
                stats.forEach(stat => observer.observe(stat));
                this.statsAnimated = true;
            }

            // Count-up animation helper
            countUp(element, start, end, duration) {
                const startTime = performance.now();
                const range = end - start;
                
                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Easing function
                    const easeOut = 1 - Math.pow(1 - progress, 3);
                    const current = Math.floor(start + (range * easeOut));
                    
                    element.textContent = current.toLocaleString() + (end >= 1000 ? '+' : '');
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };
                
                requestAnimationFrame(animate);
            }

            async init() {
                try {
                    console.log('📊 Step 1: Loading data...');
                    await this.loadData();
                    
                    console.log('🔧 Step 2: Setting up elements...');
                    this.initializeElements();
                    
                    console.log('👂 Step 3: Setting up event listeners...');
                    this.setupEventListeners();
                    

                    
                    console.log('🎤 Step 4: Setting up voice search...');
                    this.setupVoiceSearch();
                    
                    console.log('🎯 Step 5: Updating stats...');
                    this.updateStats();
                    
                    console.log('📊 Step 6: Setting up stats animation...');
                    this.animateStats();
                    
                    console.log('🎨 Step 7: Rendering cards...');
                    this.renderCards();
                    
                    console.log('📺 Step 8: Hiding loading screen...');
                    this.hideLoadingScreen();
                    
                    console.log('🔝 Step 9: Scrolling to top...');
                    // Auto-scroll to top on page load/refresh
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    
                    console.log('🎉 Step 10: App loaded successfully...');
                    // Notifications disabled per user request
                    
                    console.log('✅ Enhanced Alumni App initialized successfully!');
                } catch (error) {
                    console.error('❌ Error loading enhanced app:', error);
                    this.hideLoadingScreen();
                    this.showError();
                }
            }

            initializeElements() {
                this.elements = {
                    loadingScreen: document.getElementById('loading-screen'),
                    loadingBar: document.getElementById('loading-bar'),
                    cardsContainer: document.getElementById('cards-container'),
                    aiSearch: document.getElementById('ai-search'),
                    voiceSearch: document.getElementById('voice-search'),
                    modalOverlay: document.getElementById('modal-overlay'),
                    modalBody: document.getElementById('modal-body'),
                    modalClose: document.getElementById('modal-close'),
                    totalAlumni: document.getElementById('total-alumni')
                };
                
                // Debug missing elements
                const missingElements = [];
                Object.entries(this.elements).forEach(([key, element]) => {
                    if (!element || (element.length !== undefined && element.length === 0)) {
                        missingElements.push(key);
                    }
                });
                
                if (missingElements.length > 0) {
                    console.warn('⚠️ Missing elements:', missingElements);
                } else {
                    console.log('✅ All elements initialized successfully');
                }
            }

            async loadData() {
                try {
                    console.log('📡 Attempting to fetch alumni data...');
                    
                    // Load directly from Google Sheets only
                    let data = await this.tryLoadGoogleSheets();
                    if (!data) {
                        throw new Error('No data source available');
                    }
                    
                    this.alumniData = data;
                    this.filteredData = [...this.alumniData];
                    this.updateLoadingProgress(70);
                    console.log(`✅ Loaded ${this.alumniData.length} alumni records`);
                } catch (error) {
                    console.error('💥 Failed to load Google Sheets data:', error);
                    console.log('📝 Using enhanced fallback data - showing sample alumni');
                    this.alumniData = await this.createEnhancedFallbackData();
                    this.filteredData = [...this.alumniData];
                    console.log(`✅ Created ${this.alumniData.length} fallback alumni records`);
                    
                    // Show user-friendly error message
                    console.log('⚠️ Unable to load live data. Showing sample alumni.');
                }
            }

            async tryLoadGoogleSheets() {
                try {
                    console.log('🌐 Trying to load Google Sheets data...');
                    // Google Sheets CSV export URL (published version)
                    const googleSheetsUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNZd56-34Smsl9_wFik9OsErpCSN6yDjRCh-3Rbt7i2o0szFf6J8JzsaUXB_Xw0onxOcpMMhxBH-_h/pub?output=csv';
                    
                    // Add CORS headers and cache busting
                    const response = await fetch(googleSheetsUrl + '&timestamp=' + Date.now(), {
                        method: 'GET',
                        mode: 'cors',
                        headers: {
                            'Accept': 'text/csv'
                        }
                    });
                    console.log('📡 Google Sheets fetch response:', response.status, response.statusText);
                    
                    if (!response.ok) {
                        console.log('❌ Google Sheets fetch failed:', response.status);
                        return null;
                    }
                    
                    const csvText = await response.text();
                    
                    // Check if we got HTML instead of CSV (means sheet isn't published or has redirect)
                    if (csvText.includes('<HTML>') || csvText.includes('<html>') || csvText.includes('Temporary Redirect')) {
                        console.log('⚠️ Google Sheets returned HTML/redirect - trying alternative approach...');
                        
                        // Try alternative URL format
                        const alternativeUrl = 'https://docs.google.com/spreadsheets/d/1zeUrlPCj7ZAmw1SHd8nvnYky5mCvpKZtNonb6oXfPA0/export?format=csv&gid=0';
                        console.log('🔄 Trying alternative Google Sheets URL...');
                        
                        const altResponse = await fetch(alternativeUrl, {
                            method: 'GET',
                            mode: 'cors'
                        });
                        
                        if (altResponse.ok) {
                            const altCsvText = await altResponse.text();
                            if (!altCsvText.includes('<HTML>') && !altCsvText.includes('<html>')) {
                                console.log('✅ Alternative URL worked!');
                                const altData = this.parseGoogleSheetsCSV(altCsvText);
                                if (altData.length > 0) {
                                    console.log(`✅ Successfully loaded ${altData.length} records from alternative Google Sheets URL`);
                                    return altData;
                                }
                            }
                        }
                        
                        return null;
                    }
                    
                    console.log('📄 Google Sheets CSV text length:', csvText.length, 'characters');
                    console.log('📄 Google Sheets first 200 chars:', csvText.substring(0, 200));
                    
                    const data = this.parseGoogleSheetsCSV(csvText);
                    console.log(`✅ Successfully loaded ${data.length} records from Google Sheets`);
                    console.log('👥 First 3 names:', data.slice(0, 3).map(a => a.personal.name));
                    
                    return data;
                } catch (error) {
                    console.error('⚠️ Google Sheets loading failed:', error);
                    return null;
                }
            }

            async tryLoadCSV() {
                try {
                    console.log('📊 Trying to load local CSV data...');
                    const response = await fetch('data/alumni.csv?t=' + Date.now()); // Add timestamp to prevent caching
                    console.log('📡 CSV fetch response:', response.status, response.statusText);
                    
                    if (!response.ok) {
                        console.log('❌ CSV fetch failed:', response.status);
                        return null;
                    }
                    
                    const csvText = await response.text();
                    console.log('📄 CSV text length:', csvText.length, 'characters');
                    console.log('📄 CSV first 200 chars:', csvText.substring(0, 200));
                    
                    const data = this.parseCSV(csvText);
                    console.log(`✅ Successfully loaded ${data.length} records from CSV`);
                    console.log('👥 First 3 names:', data.slice(0, 3).map(a => a.personal.name));
                    
                    return data;
                } catch (error) {
                    console.error('⚠️ CSV loading failed:', error);
                    return null;
                }
            }

            async tryLoadJSON() {
                try {
                    console.log('📋 Trying to load JSON data...');
                    const response = await fetch('data/alumni.json');
                    if (!response.ok) {
                        console.log('📋 JSON file not found (this is expected - using CSV instead)');
                        return null;
                    }
                    
                    const data = await response.json();
                    console.log(`✅ Loaded ${data.length} records from JSON`);
                    return data;
                } catch (error) {
                    console.log('⚠️ JSON loading failed:', error.message);
                    return null;
                }
            }

            parseGoogleSheetsCSV(csvText) {
                console.log('🔄 Parsing Google Sheets CSV data...');
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                const alumni = [];
                
                console.log('📋 Headers found:', headers);

                for (let i = 1; i < lines.length; i++) {
                    const values = this.parseCSVLine(lines[i]);
                    if (values.length < 3) continue; // Skip rows with too few columns

                    const alumniData = {};
                    headers.forEach((header, index) => {
                        alumniData[header] = values[index] ? values[index].trim() : '';
                    });

                    // Convert Google Sheets row to our JSON structure
                    const convertedAlumni = this.convertGoogleSheetsToAlumniFormat(alumniData);
                    if (convertedAlumni && convertedAlumni.personal.name) {
                        alumni.push(convertedAlumni);
                    }
                }

                console.log(`📊 Parsed ${alumni.length} valid alumni from Google Sheets`);
                return alumni;
            }

            parseCSV(csvText) {
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',');
                const alumni = [];

                for (let i = 1; i < lines.length; i++) {
                    const values = this.parseCSVLine(lines[i]);
                    if (values.length !== headers.length) continue;

                    const alumniData = {};
                    headers.forEach((header, index) => {
                        alumniData[header.trim()] = values[index].trim();
                    });

                    // Convert CSV row to our JSON structure
                    const convertedAlumni = this.convertCSVToAlumniFormat(alumniData);
                    if (convertedAlumni) {
                        alumni.push(convertedAlumni);
                    }
                }

                return alumni;
            }

            parseCSVLine(line) {
                const values = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current);
                        current = '';
                    } else {
                        current += char;
                    }
                }
                
                values.push(current);
                return values;
            }

            convertGoogleSheetsToAlumniFormat(row) {
                try {
                    // Robust name mapping from common header variants
                    const firstName = row.first_name || row.First || row['First Name'] || row.firstname || '';
                    const lastName = row.last_name || row.Last || row['Last Name'] || row.lastname || '';
                    const combined = [firstName, lastName].filter(Boolean).join(' ').trim();
                    const fullName = (row.name || row.Name || row.full_name || row['Full Name'] || row['Full name'] || row.FullName || combined || '').toString().trim();
                    return {
                        id: row.id || `alumni_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                        personal: {
                            name: fullName || 'Anonymous',
                            photo: row.photo || this.getRandomEmoji(),
                            graduation_year: parseInt(row.graduation_year) || new Date().getFullYear(),
                            degree: row.degree || row.Degree || '',
                            location: {
                                city: row.city || '',
                                country: row.country || ''
                            }
                        },
                        professional: {
                            current_role: row.current_role || '',
                            company: row.company || '',
                            industry: row.industry || row.Industry || '',
                            experience_level: this.inferExperienceLevel(row.graduation_year, row.current_role),
                            expertise_tags: this.generateExpertiseTags(row.degree, row.current_role)
                        },
                        networking: {
                            goals: row.networking_goals ? row.networking_goals.split(',').map(goal => goal.trim()) : ['networking', 'knowledge sharing'],
                            offering: row.networking_offering ? row.networking_offering.split(',').map(offer => offer.trim()) : ['professional advice'],
                            availability: 'available'
                        },
                        summit_2025: {
                            attending: this.parseAttendingStatus(row.attending_summit || row.attending || row.Attending),
                            arrival_date: row.arrival_date || ''
                        },
                        social: {
                            linkedin: row['LinkedIn URL'] || row.linkedin_url || ''
                        }
                    };
                } catch (error) {
                    console.warn('Error converting Google Sheets row:', error, row);
                    return null;
                }
            }

            convertCSVToAlumniFormat(csvRow) {
                try {
                    return {
                        id: csvRow.id || `alumni_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                        personal: {
                            name: csvRow.name || 'Anonymous',
                            photo: csvRow.photo || '👤',
                            graduation_year: parseInt(csvRow.class) || new Date().getFullYear(), // Fixed: use 'class' field
                            degree: csvRow.degree || '', // Already correct
                            location: {
                                city: csvRow.location || csvRow.city || '',
                                country: csvRow.country || ''
                            }
                        },
                        professional: {
                            current_role: csvRow.position || csvRow.current_role || '', // Fixed: use 'position' field
                            company: csvRow.company || '', // Already correct
                            industry: csvRow.industry || '', // Already correct
                            experience_level: csvRow.experience_level || 'mid',
                            expertise_tags: csvRow.expertise_tags ? csvRow.expertise_tags.split(',').map(tag => tag.trim()) : []
                        },
                        networking: {
                            goals: csvRow.networking_goals ? csvRow.networking_goals.split(',').map(goal => goal.trim()) : [],
                            offering: csvRow.networking_offering ? csvRow.networking_offering.split(',').map(offer => offer.trim()) : [],
                            availability: csvRow.availability || 'offline'
                        },
                        summit_2025: {
                            attending: csvRow.attending === 'Yes' || csvRow.attending === 'true', // Fixed: use 'attending' field
                            arrival_date: csvRow.arrival_date || ''
                        }
                    };
                } catch (error) {
                    console.warn('Error converting CSV row:', error, csvRow);
                    return null;
                }
            }

            getRandomEmoji() {
                const emojis = ['👨‍💼', '👩‍💼', '👨‍💻', '👩‍💻', '👨‍🎓', '👩‍🎓', '👨‍🔬', '👩‍🔬', '👨‍⚕️', '👩‍⚕️', '👨‍🏫', '👩‍🏫'];
                return emojis[Math.floor(Math.random() * emojis.length)];
            }

            inferIndustry(role, company, degree) {
                const roleAndCompany = (role + ' ' + company + ' ' + degree).toLowerCase();
                if (roleAndCompany.includes('software') || roleAndCompany.includes('developer') || roleAndCompany.includes('engineer') || roleAndCompany.includes('tech')) return 'technology';
                if (roleAndCompany.includes('medical') || roleAndCompany.includes('health') || roleAndCompany.includes('bio')) return 'healthcare';
                if (roleAndCompany.includes('finance') || roleAndCompany.includes('bank') || roleAndCompany.includes('invest')) return 'finance';
                if (roleAndCompany.includes('consult')) return 'consulting';
                if (roleAndCompany.includes('education') || roleAndCompany.includes('teach') || roleAndCompany.includes('student')) return 'education';
                if (roleAndCompany.includes('market')) return 'marketing';
                return 'other';
            }

            inferExperienceLevel(graduationYear, role) {
                const currentYear = new Date().getFullYear();
                const yearsExperience = currentYear - graduationYear;
                
                if (role && (role.toLowerCase().includes('student') || role.toLowerCase().includes('intern'))) return 'junior';
                if (yearsExperience <= 2) return 'junior';
                if (yearsExperience <= 5) return 'mid';
                return 'senior';
            }

            generateExpertiseTags(degree, role) {
                const tags = [];
                if (degree) {
                    if (degree.toLowerCase().includes('computer')) tags.push('Computer Science');
                    if (degree.toLowerCase().includes('engineer')) tags.push('Engineering');
                    if (degree.toLowerCase().includes('business') || degree.toLowerCase().includes('management')) tags.push('Management');
                    if (degree.toLowerCase().includes('data')) tags.push('Data Science');
                }
                if (role) {
                    if (role.toLowerCase().includes('software')) tags.push('Software Development');
                    if (role.toLowerCase().includes('manager')) tags.push('Management');
                    if (role.toLowerCase().includes('analyst')) tags.push('Analysis');
                    if (role.toLowerCase().includes('engineer')) tags.push('Engineering');
                }
                return tags.length > 0 ? tags : ['Professional Development'];
            }

            renderPhoto(photo, alumniName = '') {
                // Debug logging
                console.log(`🖼️ renderPhoto called for: "${alumniName}" with photo: "${photo}"`);
                
                // Check if photo is empty, null, undefined, or contains placeholder values
                const isEmpty = !photo || 
                               photo.trim() === '' || 
                               photo === 'null' || 
                               photo === 'undefined' || 
                               photo === '📷' ||
                               photo.includes('photo-placeholder') ||
                               photo.trim() === '👤';
                
                console.log(`🔍 Photo empty check for "${alumniName}": ${isEmpty} (photo: "${photo}")`);
                
                // If no valid photo, try to find local profile image
                if (isEmpty) {
                    const localImageUrl = this.getLocalProfileImage(alumniName);
                    console.log(`🔍 Local image URL for "${alumniName}": ${localImageUrl}`);
                    if (localImageUrl) {
                        console.log(`✅ Using local image for "${alumniName}": ${localImageUrl}`);
                        return `<img src="${localImageUrl}" alt="${alumniName} Profile" onload="this.style.opacity=1; console.log('✅ Local image loaded: ${localImageUrl}')" onerror="console.log('❌ Local image failed: ${localImageUrl}'); this.outerHTML='<div class=\\'photo-placeholder\\'>📷</div>'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease;">`;
                    }
                    console.log(`📷 No local image found for "${alumniName}", showing placeholder`);
                    return `<div class="photo-placeholder">📷</div>`;
                }
                
                // Clean up the photo value
                const cleanPhoto = photo.toString().trim();
                
                // Convert Google Drive shared links to direct URLs
                const processedPhoto = this.convertGoogleDriveUrl(cleanPhoto);
                
                // Check if it's a problematic URL (Facebook, Instagram, etc. that block CORS)
                if (processedPhoto.includes('fbcdn.net') || processedPhoto.includes('cdninstagram.com') || 
                    processedPhoto.includes('facebook.com') || processedPhoto.includes('instagram.com')) {
                    console.warn('🚫 Blocked social media image URL:', processedPhoto);
                    return `<div class="photo-placeholder">📷</div>`;
                }
                
                // Check if it's a URL (starts with http or https) 
                if (processedPhoto.startsWith('http://') || processedPhoto.startsWith('https://')) {
                    // Add cache busting properly (& if URL already has params, ? if not)
                    const separator = processedPhoto.includes('?') ? '&' : '?';
                    return `<img src="${processedPhoto}${separator}cb=${Date.now()}" alt="Profile Photo" onload="this.style.opacity=1" onerror="this.outerHTML='<div class=\\'photo-placeholder\\'>📷</div>'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease;">`;
                }
                
                // Check if it's a data URL (base64 image)
                if (processedPhoto.startsWith('data:image/')) {
                    return `<img src="${processedPhoto}" alt="Profile Photo" onload="this.style.opacity=1" onerror="this.outerHTML='<div class=\\'photo-placeholder\\'>📷</div>'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease;">`;
                }
                
                // If it contains common URL patterns but doesn't start with http
                if (processedPhoto.includes('://') || processedPhoto.includes('www.') || processedPhoto.includes('.com') || processedPhoto.includes('.jpg') || processedPhoto.includes('.png')) {
                    // Add cache busting properly (& if URL already has params, ? if not)
                    const separator = processedPhoto.includes('?') ? '&' : '?';
                    return `<img src="${processedPhoto}${separator}cb=${Date.now()}" alt="Profile Photo" onload="this.style.opacity=1" onerror="this.outerHTML='<div class=\\'photo-placeholder\\'>📷</div>'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease;">`;
                }
                
                // Default placeholder for anything else - but try local image first
                console.log(`⚠️ Photo "${photo}" for "${alumniName}" is not a valid URL, trying local image as fallback`);
                const localImageUrl = this.getLocalProfileImage(alumniName);
                if (localImageUrl) {
                    console.log(`✅ Using local image as final fallback for "${alumniName}": ${localImageUrl}`);
                    return `<img src="${localImageUrl}" alt="${alumniName} Profile" onload="this.style.opacity=1; console.log('✅ Local fallback image loaded: ${localImageUrl}')" onerror="console.log('❌ Local fallback image failed: ${localImageUrl}'); this.outerHTML='<div class=\\'photo-placeholder\\'>📷</div>'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease;">`;
                }
                console.log(`📷 Final fallback: showing placeholder for "${alumniName}"`);
                return `<div class="photo-placeholder">📷</div>`;
            }

            getCohortImageUrl(graduationYear) {
                if (!graduationYear) return null;
                
                // Map graduation year to cohort number
                // 2021 = cohort 1, 2022 = cohort 2, etc.
                const cohortNumber = graduationYear - 2020;
                
                // Handle the actual uploaded filenames
                const cohortFiles = {
                    1: './images/backgrounds/Cohort 1.jpg',
                    2: './images/backgrounds/Cohort 2.jpg',
                    3: './images/backgrounds/Cohort 3.jpg',
                    4: './images/backgrounds/Cohort 4.jpeg',
                    5: './images/backgrounds/Cohort 5.jpeg'
                };
                
                return cohortFiles[cohortNumber] || null;
            }

            getCohortBackgroundStyle(graduationYear) {
                const imageUrl = this.getCohortImageUrl(graduationYear);
                if (imageUrl) {
                    return `background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), url('${imageUrl}'); background-size: cover; background-position: center; color: white;`;
                }
                return '';
            }

            getLocalProfileImage(alumniName) {
                console.log(`🔍 getLocalProfileImage called with: "${alumniName}"`);
                if (!alumniName || alumniName.trim() === '') {
                    console.log(`❌ Empty alumni name provided`);
                    return null;
                }
                
                // Exact mapping for uploaded profile images
                const profileImageMap = {
                    'Shai Turjeman': './images/profiles/Shai Turjeman.png',
                    'Shani Dabull': './images/profiles/Shani Dabull.jpeg',
                    'Shiri Rosenman': './images/profiles/Shiri Rosenman.png',
                    'Yael Agur Orgal': './images/profiles/Yael Agur Orgal.png',
                    'Yonatan Ben Gur': './images/profiles/Yonatan Ben Gur.png',
                    'Yotam Naor': './images/profiles/Yotam Naor.png',
                    'Yuval Zohar': './images/profiles/Yuval Zohar.png',
                    'Ayal Alster Asia': './images/profiles/Ayal Alster Asia.png',
                    'Carmel Ariel': './images/profiles/Carmel Ariel.png',
                    'Elchanan Henshke': './images/profiles/Elchanan Henshke.png',
                    'Idan Mizrahi': './images/profiles/Idan Mizrahi.png',
                    'Nashwa Gnamy': './images/profiles/Nashwa Gnamy.png'
                };
                
                console.log(`🗂️ Available profiles: ${Object.keys(profileImageMap).join(', ')}`);
                
                // Try exact name match first
                const trimmedName = alumniName.trim();
                console.log(`🔍 Trying exact match for: "${trimmedName}"`);
                const exactMatch = profileImageMap[trimmedName];
                if (exactMatch) {
                    console.log(`✅ Exact match found: "${trimmedName}" → ${exactMatch}`);
                    return exactMatch;
                }
                
                // Try case-insensitive match
                const lowerName = trimmedName.toLowerCase();
                console.log(`🔍 Trying case-insensitive match for: "${lowerName}"`);
                for (const [name, path] of Object.entries(profileImageMap)) {
                    if (name.toLowerCase() === lowerName) {
                        console.log(`✅ Case-insensitive match found: "${name}" → ${path}`);
                        return path;
                    }
                }
                
                console.log(`❌ No local image found for: "${alumniName}"`);
                return null; // No local image found
            }

            async createEnhancedFallbackData() {
                // If CSV fails, try to load it directly as fallback
                console.log('⚠️ Creating fallback data - CSV loading must have failed');
                try {
                    // Try one more time to load CSV directly
                    const response = await fetch('data/alumni.csv');
                    if (response.ok) {
                        const csvText = await response.text();
                        const csvData = this.parseCSV(csvText);
                        if (csvData.length > 0) {
                            console.log('✅ Fallback: Successfully loaded CSV on second try');
                            return csvData;
                        }
                    }
                } catch (error) {
                    console.log('⚠️ Fallback CSV attempt also failed:', error);
                }
                
                // If still no luck, return your real alumni as hardcoded fallback
                console.log('📝 Using hardcoded alumni data as final fallback');
                return [
                    {
                        id: "alumni_001",
                        personal: { 
                            name: "Adi Ben Nun", 
                            photo: "👨‍💻", 
                            graduation_year: 2024,
                            degree: "Computer Science",
                            location: { city: "Tel Aviv", country: "Israel" }
                        },
                        professional: { 
                            current_role: "Software Engineer Intern", 
                            company: "Microsoft", 
                            industry: "technology",
                            experience_level: "junior",
                            expertise_tags: ["Software Development", "Programming"]
                        },
                        networking: { 
                            goals: ["mentorship", "skill development"],
                            offering: ["coding help", "technical guidance"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-15" }
                    },
                    {
                        id: "alumni_002",
                        personal: { 
                            name: "Adi Nechemia", 
                            photo: "👨‍💼", 
                            graduation_year: 2021,
                            degree: "Computer Science",
                            location: { city: "Tel Aviv", country: "Israel" }
                        },
                        professional: { 
                            current_role: "Managing Director", 
                            company: "8200 For Startups by EISP", 
                            industry: "technology",
                            experience_level: "senior",
                            expertise_tags: ["Startup Management", "Technology Leadership"]
                        },
                        networking: { 
                            goals: ["partnerships", "mentorship"],
                            offering: ["business guidance", "network access"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-14" }
                    },
                    {
                        id: "alumni_003",
                        personal: { 
                            name: "Amir Gordon", 
                            photo: "👨‍💻", 
                            graduation_year: 2024,
                            degree: "Computer Science",
                            location: { city: "Cupertino", country: "USA" }
                        },
                        professional: { 
                            current_role: "Software Developer", 
                            company: "Apple", 
                            industry: "technology",
                            experience_level: "junior",
                            expertise_tags: ["iOS Development", "Software Engineering"]
                        },
                        networking: { 
                            goals: ["skill development", "networking"],
                            offering: ["technical mentoring", "code review"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-16" }
                    }
                ];
            }

            async createEnhancedFallbackData() {
                // If CSV fails, try to load it directly as fallback
                console.log('⚠️ Creating fallback data - CSV loading must have failed');
                try {
                    // Try one more time to load CSV directly
                    const response = await fetch('data/alumni.csv');
                    if (response.ok) {
                        const csvText = await response.text();
                        const csvData = this.parseCSV(csvText);
                        if (csvData.length > 0) {
                            console.log('✅ Fallback: Successfully loaded CSV on second try');
                            return csvData;
                        }
                    }
                } catch (error) {
                    console.log('⚠️ Fallback CSV attempt also failed:', error);
                }
                
                // If still no luck, return your real alumni as hardcoded fallback
                console.log('📝 Using hardcoded alumni data as final fallback');
                return [
                    {
                        id: "alumni_001",
                        personal: { 
                            name: "Adi Ben Nun", 
                            photo: "👨‍💻", 
                            graduation_year: 2024,
                            degree: "Computer Science",
                            location: { city: "Tel Aviv", country: "Israel" }
                        },
                        professional: { 
                            current_role: "Software Engineer Intern", 
                            company: "Microsoft", 
                            industry: "technology",
                            experience_level: "junior",
                            expertise_tags: ["Software Development", "Programming"]
                        },
                        networking: { 
                            goals: ["mentorship", "skill development"],
                            offering: ["coding help", "technical guidance"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-15" }
                    },
                    {
                        id: "alumni_002",
                        personal: { 
                            name: "Adi Nechemia", 
                            photo: "👨‍💼", 
                            graduation_year: 2021,
                            degree: "Computer Science",
                            location: { city: "Tel Aviv", country: "Israel" }
                        },
                        professional: { 
                            current_role: "Managing Director", 
                            company: "8200 For Startups by EISP", 
                            industry: "technology",
                            experience_level: "senior",
                            expertise_tags: ["Startup Management", "Technology Leadership"]
                        },
                        networking: { 
                            goals: ["partnerships", "mentorship"],
                            offering: ["business guidance", "network access"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-14" }
                    },
                    {
                        id: "alumni_003",
                        personal: { 
                            name: "Amir Gordon", 
                            photo: "👨‍💻", 
                            graduation_year: 2024,
                            degree: "Computer Science",
                            location: { city: "Cupertino", country: "USA" }
                        },
                        professional: { 
                            current_role: "Software Developer", 
                            company: "Apple", 
                            industry: "technology",
                            experience_level: "junior",
                            expertise_tags: ["iOS Development", "Software Engineering"]
                        },
                        networking: { 
                            goals: ["skill development", "networking"],
                            offering: ["technical mentoring", "code review"],
                            availability: "available" 
                        },
                        summit_2025: { attending: true, arrival_date: "2025-06-16" }
                    }
                ];
            }

            setupEventListeners() {
                // Search functionality
                this.elements.aiSearch?.addEventListener('input', this.debounce((e) => {
                    this.performAdvancedSearch(e.target.value);
                }, 300));

                // Clustering buttons
                document.querySelectorAll('.cluster-btn')?.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.handleClusterClick(e.target);
                    });
                });

                // Modal events
                this.elements.modalClose?.addEventListener('click', () => {
                    this.closeModal();
                });

                this.elements.modalOverlay?.addEventListener('click', (e) => {
                    if (e.target === this.elements.modalOverlay) {
                        this.closeModal();
                    }
                });

                // Meet Random Alumni button
                const meetRandomBtn = document.getElementById('meet-random-alumni');
                if (meetRandomBtn) {
                    meetRandomBtn.addEventListener('click', (e) => {
                        // Prevent the button from staying in active state
                        e.preventDefault();
                        meetRandomBtn.blur(); // Remove focus to reset visual state
                        this.meetRandomAlumni();
                    });
                }

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeModal();
                    } else if (e.key === '/' && document.activeElement.tagName !== 'INPUT') {
                        e.preventDefault();
                        this.elements.aiSearch?.focus();
                    }
                });

                console.log('✅ Event listeners setup complete');
                
                // Initialize clustering
                this.currentClusterMode = 'none';
                document.querySelector('[data-cluster="none"]')?.classList.add('active');
            }

            setupDegreeHamburgerMenu(degreeClusters) {
                const hamburger = document.getElementById('degreeHamburger');
                const dropdown = document.getElementById('degreeDropdown');
                const hamburgerSecondary = document.getElementById('degreeHamburgerSecondary');
                const dropdownSecondary = document.getElementById('degreeDropdownSecondary');
                const resultsContainer = document.getElementById('degreeResults');
                
                if (!hamburger || !dropdown || !hamburgerSecondary || !dropdownSecondary || !resultsContainer) {
                    console.warn('🍔 Degree hamburger menu elements not found');
                    return;
                }

                // Store current selections - start with nothing selected
                this.currentDegreeCategory = null;
                this.currentSpecificDegree = null;

                // Setup primary hamburger menu
                this.setupPrimaryDegreeHamburger(hamburger, dropdown, degreeClusters, resultsContainer);
                
                // Setup secondary hamburger menu  
                this.setupSecondaryDegreeHamburger(hamburgerSecondary, dropdownSecondary, degreeClusters, resultsContainer);

                // No default selection - user must choose from hamburger menu

                console.log('✅ Degree hamburger menu setup complete');
            }

            setupPrimaryDegreeHamburger(hamburger, dropdown, degreeClusters, resultsContainer) {
                // Toggle dropdown on hamburger click
                hamburger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = hamburger.classList.contains('active');
                    
                    if (isActive) {
                        this.closeDegreeHamburgerMenu();
                    } else {
                        this.openDegreeHamburgerMenu();
                    }
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    const currentHamburger = document.getElementById('degreeHamburger');
                    const currentDropdown = document.getElementById('degreeDropdown');
                    
                    if (currentHamburger && currentDropdown && 
                        !currentHamburger.contains(e.target) && !currentDropdown.contains(e.target)) {
                        this.closeDegreeHamburgerMenu();
                    }
                });

                // Handle category selection
                const categoryButtons = dropdown.querySelectorAll('.degree-category-btn');
                categoryButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        const category = e.currentTarget.dataset.category;
                        
                        // Remove active class from all buttons
                        categoryButtons.forEach(btn => btn.classList.remove('active'));
                        // Add active class to clicked button
                        e.currentTarget.classList.add('active');
                        
                        // Update hamburger text and current selection
                        const span = hamburger.querySelector('span');
                        this.currentDegreeCategory = category;
                        this.currentSpecificDegree = null; // Reset specific degree selection
                        
                        if (category === 'all') {
                            span.textContent = '📜 All Categories';
                            this.hideSecondaryHamburger();
                            // Clear results - don't show degree category cards
                            resultsContainer.innerHTML = '';
                        } else {
                            span.textContent = `📜 ${category}`;
                            this.showSecondaryHamburger(category, degreeClusters);
                            // Show all alumni from this main degree category
                            const categoryData = degreeClusters[category];
                            if (categoryData && categoryData.alumni) {
                                this.showDegreeAlumniGrid(category, categoryData.alumni);
                            }
                        }
                        
                        // Close dropdown after selection
                        setTimeout(() => this.closeDegreeHamburgerMenu(), 200);
                    });
                });
            }

            setupSecondaryDegreeHamburger(hamburgerSecondary, dropdownSecondary, degreeClusters, resultsContainer) {
                // Toggle secondary dropdown
                hamburgerSecondary.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = hamburgerSecondary.classList.contains('active');
                    
                    if (isActive) {
                        this.closeSecondaryDegreeHamburgerMenu();
                    } else {
                        this.openSecondaryDegreeHamburgerMenu();
                    }
                });

                // Close secondary dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    const currentHamburger = document.getElementById('degreeHamburgerSecondary');
                    const currentDropdown = document.getElementById('degreeDropdownSecondary');
                    
                    if (currentHamburger && currentDropdown && 
                        !currentHamburger.contains(e.target) && !currentDropdown.contains(e.target)) {
                        this.closeSecondaryDegreeHamburgerMenu();
                    }
                });
            }

            openDegreeHamburgerMenu() {
                const hamburger = document.getElementById('degreeHamburger');
                const dropdown = document.getElementById('degreeDropdown');
                
                if (hamburger) hamburger.classList.add('active');
                if (dropdown) dropdown.classList.add('active');
            }

            closeDegreeHamburgerMenu() {
                const hamburger = document.getElementById('degreeHamburger');
                const dropdown = document.getElementById('degreeDropdown');
                
                if (hamburger) hamburger.classList.remove('active');
                if (dropdown) dropdown.classList.remove('active');
            }

            showAllDegreeCategories(degreeClusters, resultsContainer) {
                resultsContainer.innerHTML = '';
                const grid = document.createElement('div');
                grid.className = 'cluster-overview-grid';
                const entries = Object.entries(degreeClusters);
                
                entries.forEach(([categoryName, categoryData]) => {
                    const categoryStyle = this.getDegreeCategoryStyle(categoryName);
                    const attendingCount = categoryData.alumni.filter(alumni => 
                        alumni.summit_2025?.attending === true || alumni.summit_2025?.attending === 'Yes'
                    ).length;
                    const attendingPct = Math.round((attendingCount / categoryData.alumni.length) * 100);
                    
                    const tile = document.createElement('div');
                    tile.className = 'alumni-card cluster-select';
                    tile.innerHTML = `
                        <div class="card-content">
                            <div class="card-header" style="background: ${categoryStyle.gradient};">
                                <div class="profile-photo">${categoryStyle.icon}</div>
                            </div>
                            <div class="card-body">
                                <h3 class="title">${categoryName}</h3>
                                <div class="meta">
                                    <span class="pill">${categoryData.alumni.length} alumni</span>
                                    <span class="pill">${Object.keys(categoryData.subcategories).length} degree types</span>
                                    <span class="pill">${attendingPct}% attending</span>
                                </div>
                                <div class="chev">▾</div>
                            </div>
                        </div>
                    `;
                    
                    tile.addEventListener('click', () => {
                        this.showSpecificDegreeCategory(categoryName, degreeClusters, resultsContainer);
                    });
                    
                    grid.appendChild(tile);
                });
                
                resultsContainer.appendChild(grid);
            }

            showSpecificDegreeCategory(categoryName, degreeClusters, grid) {
                grid.innerHTML = '';
                const categoryData = degreeClusters[categoryName];
                
                if (!categoryData) return;
                
                const categoryStyle = this.getDegreeCategoryStyle(categoryName);
                const subcategories = Object.entries(categoryData.subcategories);
                
                subcategories.forEach(([degreeName, alumni]) => {
                    const attendingCount = alumni.filter(alumni => 
                        alumni.summit_2025?.attending === true || alumni.summit_2025?.attending === 'Yes'
                    ).length;
                    const attendingPct = Math.round((attendingCount / alumni.length) * 100);
                    
                    const tile = document.createElement('div');
                    tile.className = 'alumni-card cluster-select';
                    tile.innerHTML = `
                        <div class="card-content">
                            <div class="card-header" style="background: ${categoryStyle.lightGradient};">
                                <div class="profile-photo">${categoryStyle.subIcon}</div>
                            </div>
                            <div class="card-body">
                                <h3 class="title">${degreeName}</h3>
                                <div class="meta">
                                    <span class="pill">${alumni.length} alumni</span>
                                    <span class="pill">${attendingPct}% attending</span>
                                </div>
                                <div class="chev">▾</div>
                            </div>
                        </div>
                    `;
                    
                    tile.addEventListener('click', () => {
                        this.showDegreeAlumniGrid(degreeName, alumni);
                    });
                    
                    grid.appendChild(tile);
                });
            }

            // Secondary hamburger menu functions
            showSecondaryHamburger(categoryName, degreeClusters) {
                const hamburgerSecondary = document.getElementById('degreeHamburgerSecondary');
                const dropdownSecondary = document.getElementById('degreeDropdownSecondary');
                
                if (!hamburgerSecondary || !dropdownSecondary) return;
                
                // Show the secondary hamburger
                hamburgerSecondary.classList.add('show');
                
                // Update secondary hamburger text
                const span = hamburgerSecondary.querySelector('span');
                span.textContent = '🎯 Select Degree';
                
                // Populate secondary dropdown with degrees from this category
                const categoryData = degreeClusters[categoryName];
                if (!categoryData) return;
                
                const subcategories = Object.entries(categoryData.subcategories);
                dropdownSecondary.innerHTML = '';
                
                subcategories.forEach(([degreeName, alumni]) => {
                    const button = document.createElement('button');
                    button.className = 'degree-specific-btn';
                    button.dataset.degree = degreeName;
                    button.innerHTML = `
                        <span>📚</span>
                        <span>${degreeName}</span>
                        <span style="margin-left: auto; font-size: 0.8em; color: #999;">(${alumni.length})</span>
                    `;
                    
                    button.addEventListener('click', (e) => {
                        // Remove active from all secondary buttons
                        dropdownSecondary.querySelectorAll('.degree-specific-btn').forEach(btn => btn.classList.remove('active'));
                        // Add active to clicked button
                        e.currentTarget.classList.add('active');
                        
                        // Update secondary hamburger text
                        span.textContent = `🎯 ${degreeName}`;
                        this.currentSpecificDegree = degreeName;
                        
                        // Show alumni for this specific degree
                        this.showDegreeAlumniGrid(degreeName, alumni);
                        
                        // Close secondary dropdown
                        setTimeout(() => this.closeSecondaryDegreeHamburgerMenu(), 200);
                    });
                    
                    dropdownSecondary.appendChild(button);
                });
            }

            hideSecondaryHamburger() {
                const hamburgerSecondary = document.getElementById('degreeHamburgerSecondary');
                if (hamburgerSecondary) {
                    hamburgerSecondary.classList.remove('show');
                    this.closeSecondaryDegreeHamburgerMenu();
                }
            }

            openSecondaryDegreeHamburgerMenu() {
                const hamburger = document.getElementById('degreeHamburgerSecondary');
                const dropdown = document.getElementById('degreeDropdownSecondary');
                
                if (hamburger) hamburger.classList.add('active');
                if (dropdown) dropdown.classList.add('active');
            }

            closeSecondaryDegreeHamburgerMenu() {
                const hamburger = document.getElementById('degreeHamburgerSecondary');
                const dropdown = document.getElementById('degreeDropdownSecondary');
                
                if (hamburger) hamburger.classList.remove('active');
                if (dropdown) dropdown.classList.remove('active');
            }

            // Industry hamburger menu functions
            setupIndustryHamburgerMenu(industryDomains) {
                const hamburger = document.getElementById('industryHamburger');
                const dropdown = document.getElementById('industryDropdown');
                const hamburgerSecondary = document.getElementById('industryHamburgerSecondary');
                const dropdownSecondary = document.getElementById('industryDropdownSecondary');
                const resultsContainer = document.getElementById('industryResults');
                
                if (!hamburger || !dropdown || !hamburgerSecondary || !dropdownSecondary || !resultsContainer) {
                    console.warn('🍔 Industry hamburger menu elements not found');
                    return;
                }

                // Store current selections - start with nothing selected
                this.currentIndustryDomain = null;
                this.currentSpecificIndustry = null;

                // Setup primary hamburger menu
                this.setupPrimaryIndustryHamburger(hamburger, dropdown, industryDomains, resultsContainer);
                
                // Setup secondary hamburger menu  
                this.setupSecondaryIndustryHamburger(hamburgerSecondary, dropdownSecondary, industryDomains, resultsContainer);

                // No default selection - user must choose from hamburger menu
                console.log('✅ Industry hamburger menu setup complete');
            }

            setupPrimaryIndustryHamburger(hamburger, dropdown, industryDomains, resultsContainer) {
                // Toggle dropdown on hamburger click
                hamburger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = hamburger.classList.contains('active');
                    
                    if (isActive) {
                        this.closeIndustryHamburgerMenu();
                    } else {
                        this.openIndustryHamburgerMenu();
                    }
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    const currentHamburger = document.getElementById('industryHamburger');
                    const currentDropdown = document.getElementById('industryDropdown');
                    
                    if (currentHamburger && currentDropdown && 
                        !currentHamburger.contains(e.target) && !currentDropdown.contains(e.target)) {
                        this.closeIndustryHamburgerMenu();
                    }
                });

                // Handle domain selection
                const categoryButtons = dropdown.querySelectorAll('.degree-category-btn');
                categoryButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const domain = button.dataset.category;
                        const span = hamburger.querySelector('span');
                        
                        // Update current selection
                        this.currentIndustryDomain = domain;
                        
                        if (domain === 'all') {
                            span.textContent = '🏢 All Industries';
                            this.hideSecondaryIndustryHamburger();
                            // Clear results - don't show industry cards
                            resultsContainer.innerHTML = '';
                        } else {
                            span.textContent = `🏢 ${domain}`;
                            this.showSecondaryIndustryHamburger(domain, industryDomains);
                            // Show all alumni from this domain
                            const domainData = industryDomains[domain];
                            if (domainData && domainData.alumni) {
                                this.showIndustryAlumniGrid(domain, domainData.alumni);
                            }
                        }
                        
                        // Close dropdown after selection
                        setTimeout(() => this.closeIndustryHamburgerMenu(), 200);
                    });
                });
            }

            openIndustryHamburgerMenu() {
                const hamburger = document.getElementById('industryHamburger');
                const dropdown = document.getElementById('industryDropdown');
                
                if (hamburger) hamburger.classList.add('active');
                if (dropdown) dropdown.classList.add('active');
            }

            closeIndustryHamburgerMenu() {
                const hamburger = document.getElementById('industryHamburger');
                const dropdown = document.getElementById('industryDropdown');
                
                if (hamburger) hamburger.classList.remove('active');
                if (dropdown) dropdown.classList.remove('active');
            }

            setupSecondaryIndustryHamburger(hamburgerSecondary, dropdownSecondary, industryDomains, resultsContainer) {
                // Toggle secondary dropdown
                hamburgerSecondary.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = hamburgerSecondary.classList.contains('active');
                    
                    if (isActive) {
                        this.closeSecondaryIndustryHamburgerMenu();
                    } else {
                        this.openSecondaryIndustryHamburgerMenu();
                    }
                });

                // Close secondary dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    const currentHamburger = document.getElementById('industryHamburgerSecondary');
                    const currentDropdown = document.getElementById('industryDropdownSecondary');
                    
                    if (currentHamburger && currentDropdown && 
                        !currentHamburger.contains(e.target) && !currentDropdown.contains(e.target)) {
                        this.closeSecondaryIndustryHamburgerMenu();
                    }
                });
            }

            // Secondary hamburger menu functions
            showSecondaryIndustryHamburger(domainName, industryDomains) {
                const hamburgerSecondary = document.getElementById('industryHamburgerSecondary');
                const dropdownSecondary = document.getElementById('industryDropdownSecondary');
                
                if (!hamburgerSecondary || !dropdownSecondary) return;
                
                // Show the secondary hamburger
                hamburgerSecondary.classList.add('show');
                
                // Clear and populate dropdown with industries in this domain
                dropdownSecondary.innerHTML = '';
                
                const domainData = industryDomains[domainName];
                if (!domainData || !domainData.industries) return;
                
                // Sort industries by alumni count
                const sortedIndustries = Object.entries(domainData.industries)
                    .sort(([,a], [,b]) => b.length - a.length);
                
                sortedIndustries.forEach(([industry, alumni]) => {
                    const button = document.createElement('button');
                    button.className = 'degree-category-btn';
                    button.innerHTML = `
                        <span class="degree-category-icon">🏢</span>
                        <span>${industry} (${alumni.length})</span>
                    `;
                    
                    button.addEventListener('click', (e) => {
                        e.stopPropagation();
                        
                        // Update secondary hamburger text
                        const span = hamburgerSecondary.querySelector('span');
                        span.textContent = `🎯 ${industry}`;
                        
                        // Show alumni for this specific industry
                        this.showIndustryAlumniGrid(industry, alumni);
                        
                        // Store current selection
                        this.currentSpecificIndustry = industry;
                        
                        // Close dropdown
                        setTimeout(() => this.closeSecondaryIndustryHamburgerMenu(), 200);
                    });
                    
                    dropdownSecondary.appendChild(button);
                });
            }

            hideSecondaryIndustryHamburger() {
                const hamburgerSecondary = document.getElementById('industryHamburgerSecondary');
                if (hamburgerSecondary) {
                    hamburgerSecondary.classList.remove('show');
                    this.closeSecondaryIndustryHamburgerMenu();
                }
            }

            openSecondaryIndustryHamburgerMenu() {
                const hamburger = document.getElementById('industryHamburgerSecondary');
                const dropdown = document.getElementById('industryDropdownSecondary');
                
                if (hamburger) hamburger.classList.add('active');
                if (dropdown) dropdown.classList.add('active');
            }

            closeSecondaryIndustryHamburgerMenu() {
                const hamburger = document.getElementById('industryHamburgerSecondary');
                const dropdown = document.getElementById('industryDropdownSecondary');
                
                if (hamburger) hamburger.classList.remove('active');
                if (dropdown) dropdown.classList.remove('active');
            }

            showIndustryAlumniGrid(industryName, alumni) {
                const resultsContainer = document.getElementById('industryResults');
                if (!resultsContainer) return;

                // Clear previous results
                resultsContainer.innerHTML = '';

                // Create expansion grid for alumni
                const expGrid = document.createElement('div');
                expGrid.className = 'cluster-expansion-grid';

                alumni.forEach((a, idx) => {
                    const card = this.createEnhancedCard(a, idx);
                    card.classList.add('deal-in');
                    card.style.animationDelay = `${idx * 0.04}s`;
                    expGrid.appendChild(card);
                });

                resultsContainer.appendChild(expGrid);
                console.log(`🏢 Showing ${alumni.length} alumni for industry: ${industryName}`);
            }

            showDegreeAlumniGrid(degreeName, alumni) {
                const resultsContainer = document.getElementById('degreeResults');
                if (!resultsContainer) return;
                
                // Clear and create expansion grid for alumni
                resultsContainer.innerHTML = '';
                const grid = document.createElement('div');
                grid.className = 'cluster-expansion-grid';
                
                alumni.forEach((alumniData, idx) => {
                    const card = this.createEnhancedCard(alumniData, idx);
                    card.classList.add('deal-in');
                    card.style.animationDelay = `${idx * 0.04}s`;
                    grid.appendChild(card);
                });
                
                resultsContainer.appendChild(grid);
                
                console.log(`🎯 Showing ${alumni.length} alumni with ${degreeName} degree`);
            }

            setupVoiceSearch() {
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    this.elements.voiceSearch?.style.setProperty('display', 'none');
                    console.log('⚠️ Voice search not supported');
                    return;
                }

                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                this.recognition.continuous = false;
                this.recognition.interimResults = false;
                this.recognition.lang = 'en-US';

                this.elements.voiceSearch?.addEventListener('click', () => {
                    this.toggleVoiceSearch();
                });

                this.recognition.addEventListener('result', (e) => {
                    const transcript = e.results[0][0].transcript;
                    if (this.elements.aiSearch) {
                        this.elements.aiSearch.value = transcript;
                        this.performAdvancedSearch(transcript);
                    }
                    console.log(`🎤 Voice search: "${transcript}"`);
                });

                console.log('✅ Voice search setup complete');
            }

            toggleVoiceSearch() {
                if (this.isVoiceRecording) {
                    this.recognition?.stop();
                } else {
                    try {
                        this.recognition?.start();
                        this.isVoiceRecording = true;
                        this.elements.voiceSearch?.classList.add('recording');
                    } catch (error) {
                        console.log('❌ Unable to start voice recognition');
                    }
                }
            }

            performAdvancedSearch(query) {
                if (!query.trim()) {
                    this.filteredData = [...this.alumniData];
                } else {
                    this.filteredData = this.alumniData.filter(alumni => {
                        const searchText = this.getSearchableText(alumni).toLowerCase();
                        const searchTerms = query.toLowerCase().split(' ');
                        return searchTerms.every(term => searchText.includes(term));
                    });
                }
                
                this.renderCards();
                this.showSearchResults(query, this.filteredData.length);
            }

            getSearchableText(alumni) {
                const personal = alumni.personal || {};
                const professional = alumni.professional || {};
                const networking = alumni.networking || {};
                
                return [
                    personal.name,
                    professional.current_role,
                    professional.company,
                    professional.industry,
                    ...(professional.expertise_tags || []),
                    ...(networking.goals || []),
                    ...(networking.offering || []),
                    personal.location?.city,
                    personal.location?.country
                ].filter(Boolean).join(' ');
            }

            showSearchResults(query, count) {
                if (query) {
                    console.log(`🔍 Found ${count} result${count !== 1 ? 's' : ''} for "${query}"`);
                }
            }

            matchesFilters(alumni, filters) {
                for (const [key, value] of Object.entries(filters)) {
                    if (!value || value === 'all') continue;
                    
                    switch (key) {
                        case 'attending':
                            if (!alumni.summit_2025?.attending) return false;
                            break;
                        case 'available':
                            if (alumni.networking?.availability !== 'available') return false;
                            break;
                        case 'mentors':
                            if (!alumni.networking?.offering?.includes('advice') && 
                                !alumni.networking?.offering?.includes('mentorship')) return false;
                            break;
                        case 'entrepreneurs':
                            const role = alumni.professional?.current_role?.toLowerCase() || '';
                            if (!role.includes('founder') && !role.includes('ceo') && 
                                !role.includes('entrepreneur')) return false;
                            break;
                    }
                }
                return true;
            }

            renderCards() {
                const container = this.elements.cardsContainer;
                if (!container) return;
                
                container.innerHTML = '';
                
                this.filteredData.forEach((alumni, index) => {
                    const card = this.createEnhancedCard(alumni, index);
                    container.appendChild(card);
                });
                
                console.log(`✅ Rendered ${this.filteredData.length} cards`);
            }

            createEnhancedCard(alumni, index) {
                const card = document.createElement('div');
                card.className = 'alumni-card fade-in';
                card.setAttribute('data-alumni-id', alumni.id);
                card.setAttribute('tabindex', '0');
                
                // Add smooth stagger animation delay (like clusters)
                card.style.animationDelay = `${index * 0.05}s`;
                
                card.innerHTML = this.generateCardHTML(alumni);
                
                // Enhanced interactions
                card.addEventListener('click', () => this.handleCardClick(card, alumni));
                card.addEventListener('mouseenter', () => this.handleCardHover(card, true));
                card.addEventListener('mouseleave', () => this.handleCardHover(card, false));
                
                return card;
            }



            generateCardHTML(alumni) {
                const personal = alumni.personal || {};
                const professional = alumni.professional || {};
                const social = alumni.social || {};
                const summit = alumni.summit_2025 || {};
                const degreeLabel = personal.degree ? personal.degree : '';
                const industryLabel = professional.industry ? professional.industry : '';
                const classLabel = personal.graduation_year ? `Class of ${personal.graduation_year}` : '';
                
                return `
                    <div class="card-content">
                        <div class="card-header">
                            <div class="profile-photo ${this.getClassColorByYear(personal.graduation_year)}">${this.renderPhoto(personal.photo, personal.name)}</div>
                        </div>
                        
                        <div class="card-body">
                            <h3 class="alumni-name">${personal.name || 'Anonymous'}</h3>
                            <p class="graduation-class">Class of ${personal.graduation_year || 'Unknown'}</p>
                            ${personal.degree ? `<p class="degree-info">${personal.degree}</p>` : ''}
                            
                            <div class="professional-info">
                                <p class="current-position">${professional.current_role || 'Professional'}</p>
                                <p class="company-name">${professional.company || 'Company'}</p>
                                <p class="industry-name">${professional.industry || 'Industry'}</p>
                            </div>
                            
                            <div class="card-footer">
                                ${this.renderLinkedInButton(social.linkedin)}
                                ${this.renderAttendingStatus(summit.attending)}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderLinkedInButton(linkedinUrl) {
                if (!linkedinUrl || linkedinUrl.trim() === '') {
                    return '<div class="linkedin-placeholder">No LinkedIn</div>';
                }
                
                return `<a href="${linkedinUrl.trim()}" target="_blank" rel="noopener noreferrer" class="linkedin-button" onclick="event.stopPropagation()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    LinkedIn
                </a>`;
            }

            parseAttendingStatus(value) {
                if (!value) return false;
                
                const stringValue = value.toString().toLowerCase().trim();
                return stringValue === 'yes' || 
                       stringValue === 'true' || 
                       stringValue === '1' || 
                       stringValue === 'attending' ||
                       value === true;
            }

            getClassColorByYear(graduationYear) {
                if (!graduationYear || isNaN(graduationYear)) return 'class-unknown';
                
                const year = parseInt(graduationYear);
                
                switch (year) {
                    case 2021: return 'class-2021';
                    case 2022: return 'class-2022';
                    case 2023: return 'class-2023';
                    case 2024: return 'class-2024';
                    case 2025: return 'class-2025';
                    default: return 'class-unknown';
                }
            }

            renderAttendingStatus(isAttending) {
                if (isAttending) {
                    return '<div class="attending-badge">✈️ Attending Summit 2025</div>';
                } else {
                    return '<div class="not-attending">Not Attending</div>';
                }
            }

            getAvailabilityText(availability) {
                switch (availability) {
                    case 'available': return 'Available';
                    case 'busy': return 'Busy';
                    case 'offline': return 'Offline';
                    default: return 'Unknown';
                }
            }

            handleCardClick(card, alumni) {
                // Show detailed modal instead of just flipping card
                this.showDetailModal(alumni, true);
            }

            flipCard(card) {
                card.classList.add('flip-animation');
                card.classList.toggle('flipped');
                
                setTimeout(() => {
                    card.classList.remove('flip-animation');
                }, 800);
            }

            handleCardHover(card, isHovering) {
                if (isHovering) {
                    card.classList.add('hover-effect');
                } else {
                    card.classList.remove('hover-effect');
                }
            }

            handleConnect(alumniId) {
                const alumni = this.alumniData.find(a => a.id === alumniId);
                console.log(`🤝 Connection request sent to ${alumni?.personal?.name}`);
            }

            handleMessage(alumniId) {
                const alumni = this.alumniData.find(a => a.id === alumniId);
                console.log(`💬 Opening message interface for ${alumni?.personal?.name}`);
            }

            showDetailModal(alumni, showConnections = true) {
                const content = this.generateNetworkModalContent(alumni);
                this.showNetworkModal('Alumni Network', content, alumni, showConnections);
            }

            generateDetailModalContent(alumni) {
                const personal = alumni.personal || {};
                const professional = alumni.professional || {};
                const networking = alumni.networking || {};
                const summit = alumni.summit_2025 || {};
                
                return `
                    <div class="detail-modal">
                        <div class="detail-header">
                                                         <div class="detail-photo">${this.renderPhoto(personal.photo, personal.name)}</div>
                            <div class="detail-info">
                                <h2>${personal.name}</h2>
                                <p class="detail-role">${professional.current_role} at ${professional.company}</p>
                                <p class="detail-location">📍 ${personal.location?.city}, ${personal.location?.country}</p>
                            </div>
                        </div>
                        <div class="detail-body">
                            <div class="detail-sections">
                                <div class="detail-section">
                                    <h4>Professional Background</h4>
                                    <ul>
                                        <li><strong>Industry:</strong> ${professional.industry || 'Not specified'}</li>
                                        <li><strong>Experience:</strong> ${professional.experience_level || 'Not specified'}</li>
                                        <li><strong>Expertise:</strong> ${(professional.expertise_tags || []).join(', ') || 'Not specified'}</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-section">
                                    <h4>Networking Goals</h4>
                                    <ul>
                                        <li><strong>Looking for:</strong> ${(networking.goals || []).join(', ') || 'Not specified'}</li>
                                        <li><strong>Can offer:</strong> ${(networking.offering || []).join(', ') || 'Not specified'}</li>
                                        <li><strong>Availability:</strong> ${this.getAvailabilityText(networking.availability)}</li>
                                    </ul>
                                </div>

                                ${summit.attending ? `
                                <div class="detail-section">
                                    <h4>Summit 2025 Participation</h4>
                                    <ul>
                                        <li><strong>Attending:</strong> Yes</li>
                                        <li><strong>Arrival Date:</strong> ${summit.arrival_date || 'TBD'}</li>
                                    </ul>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                        <div class="detail-actions">
                            <button class="btn-connect" onclick="alumniApp.handleConnect('${alumni.id}')">Connect</button>
                            <button class="btn-message" onclick="alumniApp.handleMessage('${alumni.id}')">Message</button>
                            <button class="btn-qr" onclick="alumniApp.showQRCode('${alumni.id}')">QR Code</button>
                        </div>
                    </div>
                `;
            }

            generateNetworkModalContent(alumni) {
                const personal = alumni.personal || {};
                const professional = alumni.professional || {};
                const summit = alumni.summit_2025 || {};
                
                return `
                    <div class="network-modal">
                        <div class="network-header">
                            <h2>${personal.name}</h2>
                            <p>Professional Network Connections</p>
                            <div class="network-filters">
                                <button class="filter-btn" data-filter="class" id="filterClass">
                                    <span class="filter-icon">🎓</span>
                                    <span class="filter-label">Same Class</span>
                                </button>
                                <button class="filter-btn" data-filter="degree" id="filterDegree">
                                    <span class="filter-icon">📚</span>
                                    <span class="filter-label">Same Degree</span>
                                </button>
                                <button class="filter-btn" data-filter="industry" id="filterIndustry">
                                    <span class="filter-icon">🏭</span>
                                    <span class="filter-label">Same Industry</span>
                                </button>
                                <button class="filter-btn" data-filter="company" id="filterCompany">
                                    <span class="filter-icon">🏢</span>
                                    <span class="filter-label">Same Company</span>
                                </button>
                                <button class="filter-btn clear-filters" id="clearFilters">
                                    <span class="filter-icon">🔄</span>
                                    <span class="filter-label">Show All</span>
                                </button>
                            </div>
                        </div>
                        <div class="network-content">
                            <div class="network-left-panel">
                                <div class="network-alumni-card" id="selectedAlumniCard">
                                    <div class="profile-section">
                                        <div class="profile-photo" id="selectedAlumniPhoto">
                                            ${this.renderPhoto(personal.photo, personal.name)}
                                        </div>
                                        <div class="profile-info">
                                            <h3 id="selectedAlumniName">${personal.name}</h3>
                                            <p id="selectedAlumniRole">${professional.current_role || 'Role not specified'}</p>
                                        </div>
                                    </div>
                                    <div class="details-section" id="selectedAlumniDetails">
                                        <div class="detail-item">
                                            <span class="icon">🏢</span>
                                            <span class="label">Company:</span>
                                            <span class="value">${professional.company || 'Not specified'}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="icon">🎓</span>
                                            <span class="label">Degree:</span>
                                            <span class="value">${personal.degree || 'Not specified'}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="icon">📅</span>
                                            <span class="label">Class:</span>
                                            <span class="value">${personal.graduation_year ? `Class of ${personal.graduation_year}` : 'Not specified'}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="icon">🏭</span>
                                            <span class="label">Industry:</span>
                                            <span class="value">${professional.industry || 'Not specified'}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="icon">📍</span>
                                            <span class="label">Location:</span>
                                            <span class="value">${personal.location?.city ? `${personal.location.city}, ${personal.location.country || ''}` : 'Not specified'}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="icon">🎪</span>
                                            <span class="label">Summit 2025:</span>
                                            <span class="value">${summit.attending ? 'Attending' : 'Not attending'}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="network-right-panel">
                                <div class="connected-alumni-cards" id="connectedAlumniCards">
                                    <!-- Connected alumni cards will be displayed here -->
                                </div>
                                

                            </div>
                        </div>
                    </div>
                `;
            }

            showModal(title, content) {
                if (this.elements.modalBody && this.elements.modalOverlay) {
                    this.elements.modalBody.innerHTML = content;
                    this.elements.modalOverlay.classList.add('visible');
                    this.elements.modalOverlay.setAttribute('aria-hidden', 'false');
                }
            }

            showNetworkModal(title, content, alumni, showConnections = true) {
                if (this.elements.modalBody && this.elements.modalOverlay) {
                    // Add network modal class for larger size
                    const modalContent = this.elements.modalOverlay.querySelector('.modal-content');
                    modalContent.classList.add('network-modal-content');
                    
                    this.elements.modalBody.innerHTML = content;
                    this.elements.modalOverlay.classList.add('visible');
                    this.elements.modalOverlay.setAttribute('aria-hidden', 'false');
                    
                    // Initialize network visualization after modal is shown (if requested)
                    if (showConnections) {
                        setTimeout(() => {
                            this.initializeNetworkVisualization(alumni);
                        }, 100);
                    } else {
                        // Show empty state initially
                        setTimeout(() => {
                            this.showEmptyNetworkState(alumni);
                        }, 100);
                    }
                }
            }

            showEmptyNetworkState(selectedAlumni = null) {
                // Store the selected alumni for filter operations
                if (selectedAlumni) {
                    this.currentSelectedAlumni = selectedAlumni;
                }
                
                const container = document.getElementById('connectedAlumniCards');
                if (container) {
                    container.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: center; min-height: 400px; width: 100%; color: #666; text-align: center; padding: 40px 20px;">
                            <div style="max-width: 320px;">
                                <h3 style="margin-bottom: 15px; font-size: 1.2rem;">🌐 Network Connections</h3>
                                <p style="line-height: 1.5; margin: 0; font-size: 0.9rem; opacity: 0.8;">Use the filter buttons above to explore connections<br>or they will appear automatically when available.</p>
                            </div>
                        </div>
                    `;
                }
                
                // Still setup filter listeners so they work
                this.setupFilterEventListeners();
            }

            closeModal() {
                if (this.elements.modalOverlay) {
                    // Remove network modal class
                    const modalContent = this.elements.modalOverlay.querySelector('.modal-content');
                    modalContent.classList.remove('network-modal-content');
                    
                    this.elements.modalOverlay.classList.remove('visible');
                    this.elements.modalOverlay.setAttribute('aria-hidden', 'true');
                    
                    // Clean up any network visualization
                    this.cleanupNetworkVisualization();
                }
            }

            showQRCode(alumniId) {
                const alumni = this.alumniData.find(a => a.id === alumniId);
                const qrContent = `
                    <div class="qr-code-modal">
                        <h3>Connect with ${alumni?.personal?.name}</h3>
                        <div class="qr-code">
                            <div style="width: 200px; height: 200px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; border-radius: 8px; margin: 20px auto;">
                                <div style="text-align: center;">
                                    <span style="font-size: 48px;">📱</span><br>
                                    <span style="font-size: 12px;">QR Code</span>
                                </div>
                            </div>
                        </div>
                        <p>Scan with your camera to exchange contact information</p>
                    </div>
                `;
                this.showModal('QR Code', qrContent);
            }

            updateStats() {
                if (!this.alumniData || this.alumniData.length === 0) {
                    console.log('⚠️ No alumni data available for stats');
                    return;
                }

                // Calculate real statistics from the database
                const stats = this.calculateRealStats();
                
                // Update the data-target attributes for animation
                const statAlumni = document.getElementById('stat-alumni');
                const statIndustries = document.getElementById('stat-industries');
                const statCompanies = document.getElementById('stat-companies');
                const statDegrees = document.getElementById('stat-degrees');
                
                if (statAlumni) statAlumni.setAttribute('data-target', stats.totalAlumni);
                if (statIndustries) statIndustries.setAttribute('data-target', stats.uniqueIndustries);
                if (statCompanies) statCompanies.setAttribute('data-target', stats.uniqueCompanies);
                if (statDegrees) statDegrees.setAttribute('data-target', stats.uniqueDegrees);
                
                // Update the display elements (will be animated later)
                if (this.elements.totalAlumni) {
                    this.elements.totalAlumni.textContent = '0'; // Will be animated
                }
                
                const industriesElement = document.getElementById('industries-count');
                const companiesElement = document.getElementById('companies-count');
                const degreesElement = document.getElementById('degrees-count');
                
                if (industriesElement) industriesElement.textContent = '0';
                if (companiesElement) companiesElement.textContent = '0';
                if (degreesElement) degreesElement.textContent = '0';
                
                console.log(`✅ Stats calculated from real data:`, stats);
            }

            calculateRealStats() {
                const uniqueIndustries = new Set();
                const uniqueCompanies = new Set();
                const uniqueDegrees = new Set();
                
                this.alumniData.forEach(alumni => {
                    const professional = alumni.professional || {};
                    const personal = alumni.personal || {};
                    
                    // Count unique industries
                    if (professional.industry && professional.industry.trim() && professional.industry !== 'Not specified') {
                        uniqueIndustries.add(professional.industry.trim().toLowerCase());
                    }
                    
                    // Count unique companies
                    if (professional.company && professional.company.trim() && professional.company !== 'Not specified') {
                        uniqueCompanies.add(professional.company.trim().toLowerCase());
                    }
                    
                    // Count unique degrees
                    if (personal.degree && personal.degree.trim() && personal.degree !== 'Not specified') {
                        uniqueDegrees.add(personal.degree.trim().toLowerCase());
                    }
                });
                
                return {
                    totalAlumni: this.alumniData.length,
                    uniqueIndustries: uniqueIndustries.size,
                    uniqueCompanies: uniqueCompanies.size,
                    uniqueDegrees: uniqueDegrees.size
                };
            }

            // Disabled notification system per user request
            showNotification(type, title, message) {
                // Notifications disabled - do nothing
                return;
            }

            // Viewport Management Functions
            setMobileResponsiveViewport() {
                const viewport = document.getElementById('viewport-meta');
                if (viewport) {
                    viewport.setAttribute('content', 'width=device-width, initial-scale=1.0');
                    console.log('📱 Switched to mobile-responsive viewport');
                }
            }
            
            setDesktopFixedViewport() {
                const viewport = document.getElementById('viewport-meta');
                if (viewport) {
                    viewport.setAttribute('content', 'width=1200, initial-scale=0.5, user-scalable=yes');
                    console.log('🖥️ Switched to desktop-fixed viewport');
                }
            }

            // Page Navigation Functions
            showHomePage() {
                console.log('🏠 Showing home page');
                const homePage = document.getElementById('home-page');
                const alumniPage = document.getElementById('alumni-page');
                const searchContainer = document.getElementById('search-container');
                
                if (homePage) homePage.style.display = 'block';
                if (alumniPage) alumniPage.style.display = 'none';
                if (searchContainer) searchContainer.style.display = 'none';
                
                // Switch to mobile-responsive for home page
                this.setMobileResponsiveViewport();
                
                // Update page title
                document.title = 'LEADERS Alumni Association - Where LEADERS alumni connect, grow, and give back';
                
                // Auto-scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            showAlumniPage(filterType = null, filterValue = null) {
                console.log('👥 Showing alumni page', { filterType, filterValue });
                const homePage = document.getElementById('home-page');
                const alumniPage = document.getElementById('alumni-page');
                const searchContainer = document.getElementById('search-container');
                
                if (homePage) homePage.style.display = 'none';
                if (alumniPage) alumniPage.style.display = 'block';
                if (searchContainer) searchContainer.style.display = 'block';
                
                // Update page title
                document.title = 'Explore Alumni - LEADERS Alumni Association';
                
                // Auto-scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Apply filter if specified
                if (filterType && filterValue) {
                    this.applyQuickFilter(filterType, filterValue);
                } else {
                    // Show normal view by default
                    this.showNormalView();
                }
            }

            applyQuickFilter(filterType, filterValue) {
                // Apply specific filter based on type
                switch (filterType) {
                    case 'class':
                        this.filteredData = this.alumniData.filter(alumni => 
                            alumni.personal?.graduation_year?.toString() === filterValue
                        );
                        break;
                    case 'industry':
                        this.filteredData = this.alumniData.filter(alumni => 
                            alumni.professional?.industry?.toLowerCase().includes(filterValue.toLowerCase())
                        );
                        break;
                    default:
                        this.filteredData = [...this.alumniData];
                }
                
                this.renderCards();
                console.log(`🔍 Applied ${filterType} filter for ${filterValue}: ${this.filteredData.length} results`);
            }

            meetRandomAlumni() {
                // Get available alumni (use filteredData if available, otherwise all alumni)
                const availableAlumni = this.filteredData && this.filteredData.length > 0 ? this.filteredData : this.alumniData;
                
                if (!availableAlumni || availableAlumni.length === 0) {
                    console.log('No alumni available to meet');
                    return;
                }

                // Select a random alumni
                const randomIndex = Math.floor(Math.random() * availableAlumni.length);
                const randomAlumni = availableAlumni[randomIndex];
                
                console.log('🎲 Meeting random alumni:', randomAlumni.personal?.name || 'Unknown');
                
                // Show notification about who we're meeting
                console.log(`🎲 Meeting random alumni: ${randomAlumni.personal?.name || 'an alumni'}`);
                
                // Open their network popup with all connections showing
                this.showDetailModal(randomAlumni, true);
            }

            hideLoadingScreen() {
                console.log('🔄 Hiding loading screen...');
                
                // Multiple fallback methods to ensure loading screen is hidden
                const loadingScreen = this.elements.loadingScreen || 
                                     document.getElementById('loading-screen') ||
                                     document.querySelector('.loading-screen');
                
                if (loadingScreen) {
                    console.log('✅ Found loading screen, hiding...');
                    this.updateLoadingProgress(100);
                    
                    // Immediate hide with multiple methods
                    loadingScreen.style.opacity = '0';
                    loadingScreen.style.transition = 'opacity 0.5s ease-out';
                    
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                        loadingScreen.style.display = 'none';
                        console.log('✅ Loading screen hidden successfully!');
                    }, 500);
                } else {
                    console.warn('⚠️ Loading screen not found, but app should be visible');
                }
            }

            updateLoadingProgress(percentage) {
                try {
                    // Try to find loading bar if elements aren't initialized yet
                    const loadingBar = this.elements?.loadingBar || document.getElementById('loading-bar');
                    if (loadingBar) {
                        loadingBar.style.width = `${percentage}%`;
                        console.log(`📊 Loading progress: ${percentage}%`);
                    } else {
                        console.log(`📊 Loading progress: ${percentage}% (no loading bar found)`);
                    }
                } catch (error) {
                    console.warn('⚠️ Error updating loading progress:', error);
                }
            }

            showNotification(type, title, message, duration = 4000) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>${this.getNotificationIcon(type)}</span>
                        <div>
                            <div style="font-weight: 600;">${title}</div>
                            <div style="font-size: 0.9rem; color: #666;">${message}</div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.add('visible');
                }, 100);
                
                if (duration > 0) {
                    setTimeout(() => {
                        notification.classList.remove('visible');
                        setTimeout(() => notification.remove(), 300);
                    }, duration);
                }
            }

            getNotificationIcon(type) {
                const icons = {
                    success: '✅',
                    error: '❌',
                    warning: '⚠️',
                    info: 'ℹ️'
                };
                return icons[type] || icons.info;
            }

            showError() {
                const container = this.elements.cardsContainer;
                if (container) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 50px; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 20px;">
                            <h2 style="color: #E74C3C; margin-bottom: 16px;">⚠️ Loading Error</h2>
                            <p style="color: #666; margin-bottom: 24px;">There was an issue loading the alumni data.</p>
                            <button onclick="location.reload()" style="background: #F39C12; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; cursor: pointer;">Try Again</button>
                        </div>
                    `;
                }
                this.hideLoadingScreen();
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        }

        // Utility function for shuffling card order
        function randomizePositions() {
            const container = document.getElementById('cards-container');
            if (!container) return;
            
            const cards = Array.from(container.children);
            
            // Shuffle the cards array
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }
            
            // Re-append in new order with smooth animation
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.05}s`;
                card.style.animation = 'none';
                card.style.opacity = '0';
                card.style.transform = 'translate3d(0, 20px, 0)';
                container.appendChild(card);
                
                // Trigger smooth animation
                setTimeout(() => {
                    card.style.animation = 'fadeInSmooth 0.6s ease-out forwards';
                }, index * 25);
            });
            
            if (window.alumniApp) {
                window.alumniApp.showNotification('info', 'Shuffled!', '🔀 Alumni cards reshuffled');
            }
        }

        // Add clustering methods to the class
        Object.assign(EnhancedAlumniApp.prototype, {
            handleClusterClick(button) {
                const clusterType = button.dataset.cluster;
                console.log(`📊 Switching to cluster mode: ${clusterType}`);
                
                // Update active button
                document.querySelectorAll('.cluster-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                this.currentClusterMode = clusterType;
                
                if (clusterType === 'none') {
                    this.showNormalView();
                } else if (clusterType === 'class') {
                    this.showClassClusters();
                } else if (clusterType === 'degree') {
                    this.showDegreeClusters();
                } else if (clusterType === 'industry') {
                    this.showIndustryClusters();
                }
            },

            showNormalView() {
                const container = this.elements.cardsContainer;
                if (!container) return;
                
                // Remove clustering class and restore grid
                container.classList.remove('clustering');
                container.innerHTML = '';
                
                // Re-render cards normally with smooth animation
                setTimeout(() => {
                    this.renderCards();
                }, 200);
                
                console.log('🌐 Switched to standard grid layout');
            },

            showClassClusters() {
                const container = this.elements.cardsContainer;
                if (!container) return;
                
                // Keep mobile-responsive viewport for clustering
                this.setMobileResponsiveViewport();
                
                // Add clustering class
                container.classList.add('clustering');
                const classClusters = this.groupAlumniByClass();
                container.innerHTML = '';

                // Create overview grid for class year cards
                const grid = document.createElement('div');
                grid.className = 'cluster-overview-grid';

                const entries = Object.entries(classClusters);
                entries.forEach(([className, alumni], groupIndex) => {
                    // Create clean class year card with cohort background
                    const graduationYear = parseInt(className.replace('Class of ', ''));
                    const cohortBackgroundStyle = this.getCohortBackgroundStyle(graduationYear);
                    const tile = document.createElement('div');
                    tile.className = 'alumni-card cluster-select';
                    tile.innerHTML = `
                        <div class="card-content" style="${cohortBackgroundStyle}">
                            <div class="card-body" style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; text-align: center; padding: 2rem;">
                                <h3 class="alumni-name title" style="${cohortBackgroundStyle ? 'color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.7);' : ''} font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;">${className}</h3>
                                <div class="meta">
                                    <span class="pill" style="${cohortBackgroundStyle ? 'background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);' : ''} font-size: 1.2rem; font-weight: 600; padding: 0.5rem 1rem;">${alumni.length} alumni</span>
                                </div>
                            </div>
                        </div>
                    `;

                    // On click: show clean fanned deck
                    tile.addEventListener('click', () => {
                        // Remove any existing expansion rows
                        container.querySelectorAll('.cluster-expansion-row').forEach(n => n.remove());
                        grid.querySelectorAll('.cluster-select').forEach(card => card.classList.remove('expanded'));
                        tile.classList.add('expanded');

                        const expansion = document.createElement('div');
                        expansion.className = 'cluster-expansion-row';

                        // Create expansion grid to show ALL alumni from this class
                        const expGrid = document.createElement('div');
                        expGrid.className = 'cluster-expansion-grid';

                        alumni.forEach((alumniData, index) => {
                            const card = this.createEnhancedCard(alumniData, index);
                            card.classList.add('deal-in');
                            card.style.animationDelay = `${index * 0.04}s`;
                            expGrid.appendChild(card);
                        });

                        expansion.appendChild(expGrid);
                        grid.parentElement.insertBefore(expansion, grid.nextSibling);

                        // Auto-scroll to show the first row of alumni
                        setTimeout(() => {
                            expansion.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'start',
                                inline: 'nearest'
                            });
                        }, 200);
                    });

                    grid.appendChild(tile);
                });

                container.appendChild(grid);
                console.log(`🎓 Grouped into ${entries.length} class clusters`);
            },

            groupAlumniByClass() {
                const clusters = {};
                
                this.filteredData.forEach(alumni => {
                    const year = alumni.personal?.graduation_year;
                    const className = year ? `Class of ${year}` : 'Unknown Class';
                    
                    if (!clusters[className]) {
                        clusters[className] = [];
                    }
                    clusters[className].push(alumni);
                });
                
                // Sort clusters by year (newest first, unknown last)
                const sortedClusters = {};
                const sortedKeys = Object.keys(clusters).sort((a, b) => {
                    if (a === 'Unknown Class') return 1;
                    if (b === 'Unknown Class') return -1;
                    const yearA = parseInt(a.replace('Class of ', '')) || 0;
                    const yearB = parseInt(b.replace('Class of ', '')) || 0;
                    return yearB - yearA;
                });
                
                sortedKeys.forEach(key => {
                    sortedClusters[key] = clusters[key];
                });
                
                return sortedClusters;
            },

            showDegreeClusters() {
                console.log('🎓 showDegreeClusters called!');
                const container = this.elements.cardsContainer;
                console.log('🎓 Container:', container);
                if (!container) {
                    console.error('🎓 No container found!');
                    return;
                }
                
                // Keep mobile-responsive viewport for clustering
                this.setMobileResponsiveViewport();
                
                // Add clustering class
                container.classList.add('clustering');
                console.log('🎓 About to call groupAlumniByDegreeCategories...');
                
                try {
                    const degreeClusters = this.groupAlumniByDegreeCategories();
                    console.log('🎓 Degree clusters:', degreeClusters);
                    container.innerHTML = '';

                    // Add hamburger navigation
                    const nav = document.createElement('div');
                    nav.className = 'degree-cluster-nav';
                    nav.innerHTML = `
                        <div style="position: relative;">
                            <div class="degree-hamburger" id="degreeHamburger">
                                <div class="degree-hamburger-icon">
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                </div>
                                <span>📜 All Categories</span>
                            </div>
                            <div class="degree-dropdown" id="degreeDropdown">
                                <button class="degree-category-btn" data-category="all">
                                    <span class="degree-category-icon">🎓</span>
                                    <span>All Categories</span>
                                </button>
                                <button class="degree-category-btn" data-category="Engineering">
                                    <span class="degree-category-icon">⚙️</span>
                                    <span>Engineering</span>
                                </button>
                                <button class="degree-category-btn" data-category="Life and Health Sciences">
                                    <span class="degree-category-icon">🔬</span>
                                    <span>Life and Health Sciences</span>
                                </button>
                                <button class="degree-category-btn" data-category="Management">
                                    <span class="degree-category-icon">💼</span>
                                    <span>Management</span>
                                </button>
                                <button class="degree-category-btn" data-category="Social Studies">
                                    <span class="degree-category-icon">👥</span>
                                    <span>Social Studies</span>
                                </button>
                            </div>
                        </div>
                        
                        <div style="position: relative;">
                            <div class="degree-hamburger-secondary" id="degreeHamburgerSecondary">
                                <div class="degree-hamburger-icon">
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                </div>
                                <span>🎯 Select Degree</span>
                            </div>
                            <div class="degree-dropdown-secondary" id="degreeDropdownSecondary">
                                <!-- Populated dynamically based on category selection -->
                            </div>
                        </div>
                    `;
                    container.appendChild(nav);

                    // Container for filtered results (initially empty)
                    const resultsContainer = document.createElement('div');
                    resultsContainer.className = 'degree-results-container';
                    resultsContainer.id = 'degreeResults';
                    container.appendChild(resultsContainer);

                    // Setup hamburger menu functionality - no initial population
                    this.setupDegreeHamburgerMenu(degreeClusters);
                    
                    console.log(`🎓 Degree clustering ready with hamburger menu`);
                
                } catch (error) {
                    console.error('🎓 Error in showDegreeClusters:', error);
                    container.innerHTML = '<div style="text-align: center; padding: 2rem; color: #e74c3c;">Error loading degree clusters</div>';
                }
            },

            showIndustryClusters() {
                console.log('🏢 showIndustryClusters called!');
                const container = this.elements.cardsContainer;
                console.log('🏢 Container:', container);
                if (!container) {
                    console.error('🏢 No container found!');
                    return;
                }
                
                // Keep mobile-responsive viewport for clustering
                this.setMobileResponsiveViewport();
                
                // Add clustering class
                container.classList.add('clustering');
                console.log('🏢 About to call groupAlumniByIndustryDomains...');
                
                try {
                    const industryDomains = this.groupAlumniByIndustryDomains();
                    console.log('🏢 Industry domains:', industryDomains);
                    container.innerHTML = '';

                    // Add white header styling (like class clusters)
                    const nav = document.createElement('div');
                    nav.className = 'cluster-nav';
                    nav.style.cssText = 'position: sticky; top: 0; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 1rem; margin-bottom: 1rem; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); z-index: 100; display: flex; gap: 1rem; flex-wrap: wrap;';
                    nav.innerHTML = `
                        <div style="position: relative;">
                            <div class="degree-hamburger" id="industryHamburger">
                                <div class="degree-hamburger-icon">
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                </div>
                                <span>🏢 All Industries</span>
                            </div>
                            <div class="degree-dropdown" id="industryDropdown">
                                <button class="degree-category-btn" data-category="all">
                                    <span class="degree-category-icon">🏢</span>
                                    <span>All Industries</span>
                                </button>
                                ${Object.keys(industryDomains).map(domain => `
                                    <button class="degree-category-btn" data-category="${domain}">
                                        <span class="degree-category-icon">🏢</span>
                                        <span>${domain}</span>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div style="position: relative;">
                            <div class="degree-hamburger-secondary" id="industryHamburgerSecondary">
                                <div class="degree-hamburger-icon">
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                    <div class="degree-hamburger-line"></div>
                                </div>
                                <span>🎯 Select Industry</span>
                            </div>
                            <div class="degree-dropdown-secondary" id="industryDropdownSecondary">
                                <!-- Populated dynamically based on domain selection -->
                            </div>
                        </div>
                    `;
                    container.appendChild(nav);

                    // Add results container
                    const resultsContainer = document.createElement('div');
                    resultsContainer.className = 'degree-results-container';
                    resultsContainer.id = 'industryResults';
                    container.appendChild(resultsContainer);

                    // Setup hamburger menu
                    this.setupIndustryHamburgerMenu(industryDomains);
                    
                    console.log(`🏢 Industry clustering ready with hamburger menu`);
                
                } catch (error) {
                    console.error('🏢 Error in showIndustryClusters:', error);
                    container.innerHTML = '<div style="text-align: center; padding: 2rem; color: #e74c3c;">Error loading industry clusters</div>';
                }
            },

            groupAlumniByDegreeCategories() {
                const categories = {
                    'Engineering': { alumni: [], subcategories: {} },
                    'Life and Health Sciences': { alumni: [], subcategories: {} },
                    'Management': { alumni: [], subcategories: {} },
                    'Social Studies': { alumni: [], subcategories: {} }
                };
                
                console.log('🎓 Filtered data count:', this.filteredData.length);
                
                // If no data, create test data with degrees
                if (this.filteredData.length === 0) {
                    console.warn('🎓 No filtered data! Creating test data...');
                    this.filteredData = [
                        { personal: { name: 'John Doe', degree: 'Computer Science' }, summit_2025: { attending: true } },
                        { personal: { name: 'Jane Smith', degree: 'Business Administration' }, summit_2025: { attending: false } },
                        { personal: { name: 'Bob Johnson', degree: 'Physics' }, summit_2025: { attending: true } },
                        { personal: { name: 'Alice Brown', degree: 'Psychology' }, summit_2025: { attending: true } }
                    ];
                }
                
                this.filteredData.forEach((alumni, index) => {
                    const degree = alumni.personal?.degree || alumni.Degree || 'Unknown Degree';
                    const degreeName = degree.trim() || 'Unknown Degree';
                    
                    // Debug first few entries
                    if (index < 3) {
                        console.log(`🎓 Alumni ${index}:`, alumni.personal?.name, 'Degree:', degreeName);
                    }
                    
                    // Categorize degree into one of the 4 main categories
                    const category = this.categorizeDegreeName(degreeName);
                    
                    if (index < 3) {
                        console.log(`🎓 Categorized as:`, category);
                    }
                    
                    // Add to category's alumni list
                    categories[category].alumni.push(alumni);
                    
                    // Add to subcategory (specific degree) within the category
                    if (!categories[category].subcategories[degreeName]) {
                        categories[category].subcategories[degreeName] = [];
                    }
                    categories[category].subcategories[degreeName].push(alumni);
                });
                
                // Remove empty categories and sort subcategories
                Object.keys(categories).forEach(categoryName => {
                    if (categories[categoryName].alumni.length === 0) {
                        delete categories[categoryName];
                    } else {
                        // Sort subcategories by alumni count
                        const sortedSubs = {};
                        const sortedKeys = Object.keys(categories[categoryName].subcategories).sort((a, b) => {
                            return categories[categoryName].subcategories[b].length - categories[categoryName].subcategories[a].length;
                        });
                        sortedKeys.forEach(key => {
                            sortedSubs[key] = categories[categoryName].subcategories[key];
                        });
                        categories[categoryName].subcategories = sortedSubs;
                    }
                });
                
                return categories;
            },

            categorizeDegreeName(degreeName) {
                const lowerDegree = degreeName.toLowerCase();
                
                // Engineering keywords
                if (lowerDegree.includes('engineer') || lowerDegree.includes('computer') || 
                    lowerDegree.includes('software') || lowerDegree.includes('mechanical') ||
                    lowerDegree.includes('electrical') || lowerDegree.includes('civil') ||
                    lowerDegree.includes('technology') || lowerDegree.includes('tech') ||
                    lowerDegree.includes('programming') || lowerDegree.includes('coding')) {
                    return 'Engineering';
                }
                
                // Life and Health Sciences keywords
                if (lowerDegree.includes('biology') || lowerDegree.includes('chemistry') ||
                    lowerDegree.includes('physics') || lowerDegree.includes('mathematics') ||
                    lowerDegree.includes('math') || lowerDegree.includes('medical') ||
                    lowerDegree.includes('medicine') || lowerDegree.includes('health') ||
                    lowerDegree.includes('nursing') || lowerDegree.includes('pharmacy') ||
                    lowerDegree.includes('biomedical') || lowerDegree.includes('biochemistry') ||
                    lowerDegree.includes('microbiology') || lowerDegree.includes('neuroscience') ||
                    lowerDegree.includes('genetics') || lowerDegree.includes('anatomy') ||
                    lowerDegree.includes('physiology') || lowerDegree.includes('pathology') ||
                    lowerDegree.includes('veterinary') || lowerDegree.includes('dentistry') ||
                    lowerDegree.includes('physiotherapy') || lowerDegree.includes('physical therapy') ||
                    lowerDegree.includes('research') || lowerDegree.includes('lab')) {
                    return 'Life and Health Sciences';
                }
                
                // Management keywords  
                if (lowerDegree.includes('business') || lowerDegree.includes('management') ||
                    lowerDegree.includes('admin') || lowerDegree.includes('mba') ||
                    lowerDegree.includes('finance') || lowerDegree.includes('accounting') ||
                    lowerDegree.includes('marketing') || lowerDegree.includes('economics') ||
                    lowerDegree.includes('commerce') || lowerDegree.includes('entrepreneur')) {
                    return 'Management';
                }
                
                // Social Studies keywords
                if (lowerDegree.includes('social') || lowerDegree.includes('psychology') ||
                    lowerDegree.includes('sociology') || lowerDegree.includes('history') ||
                    lowerDegree.includes('political') || lowerDegree.includes('law') ||
                    lowerDegree.includes('education') || lowerDegree.includes('teaching') ||
                    lowerDegree.includes('literature') || lowerDegree.includes('arts') ||
                    lowerDegree.includes('philosophy') || lowerDegree.includes('language') ||
                    lowerDegree.includes('anthropology') || lowerDegree.includes('geography') ||
                    lowerDegree.includes('communication') || lowerDegree.includes('journalism')) {
                    return 'Social Studies';
                }
                
                // Default to Social Studies for unknown degrees
                return 'Social Studies';
            },

            getDegreeCategoryStyle(categoryName) {
                const styles = {
                    'Engineering': {
                        gradient: 'linear-gradient(135deg, #E74C3C 0%, #C0392B 100%)',
                        lightGradient: 'linear-gradient(135deg, #F1948A 0%, #E74C3C 100%)',
                        icon: '⚙️',
                        subIcon: '🔧'
                    },
                    'Life and Health Sciences': {
                        gradient: 'linear-gradient(135deg, #3498DB 0%, #2980B9 100%)',
                        lightGradient: 'linear-gradient(135deg, #85C1E9 0%, #3498DB 100%)',
                        icon: '🔬',
                        subIcon: '🧪'
                    },
                    'Management': {
                        gradient: 'linear-gradient(135deg, #F39C12 0%, #E67E22 100%)',
                        lightGradient: 'linear-gradient(135deg, #F8C471 0%, #F39C12 100%)',
                        icon: '💼',
                        subIcon: '📊'
                    },
                    'Social Studies': {
                        gradient: 'linear-gradient(135deg, #27AE60 0%, #229954 100%)',
                        lightGradient: 'linear-gradient(135deg, #82E0AA 0%, #27AE60 100%)',
                        icon: '📚',
                        subIcon: '🎓'
                    }
                };
                
                return styles[categoryName] || styles['Social Studies'];
            },

            groupAlumniByDegree() {
                const clusters = {};
                
                this.filteredData.forEach(alumni => {
                    const degree = alumni.personal?.degree || alumni.Degree || 'Unknown Degree';
                    const degreeName = degree.trim() || 'Unknown Degree';
                    
                    // Debug log for first few entries
                    if (Object.keys(clusters).length < 3) {
                        console.log(`🎓 Debug: ${alumni.personal?.name || 'No name'} -> Degree: "${degree}"`);
                    }
                    
                    if (!clusters[degreeName]) {
                        clusters[degreeName] = [];
                    }
                    clusters[degreeName].push(alumni);
                });
                
                // Sort clusters alphabetically (Unknown last)
                const sortedClusters = {};
                const sortedKeys = Object.keys(clusters).sort((a, b) => {
                    if (a === 'Unknown Degree') return 1;
                    if (b === 'Unknown Degree') return -1;
                    return a.localeCompare(b);
                });
                
                sortedKeys.forEach(key => {
                    sortedClusters[key] = clusters[key];
                });
                
                return sortedClusters;
            },

            groupAlumniByIndustry() {
                const clusters = {};
                
                this.filteredData.forEach(alumni => {
                    const industry = alumni.professional?.industry || alumni.Industry || 'Unknown Industry';
                    const industryName = industry.trim() || 'Unknown Industry';
                    
                    if (!clusters[industryName]) {
                        clusters[industryName] = [];
                    }
                    clusters[industryName].push(alumni);
                });
                
                // Sort clusters alphabetically (Unknown last)
                const sortedClusters = {};
                const sortedKeys = Object.keys(clusters).sort((a, b) => {
                    if (a === 'Unknown Industry') return 1;
                    if (b === 'Unknown Industry') return -1;
                    return a.localeCompare(b);
                });
                
                sortedKeys.forEach(key => {
                    sortedClusters[key] = clusters[key];
                });
                
                return sortedClusters;
            },

            groupAlumniByIndustryDomains() {
                // Define industry domain mapping
                const industryDomainMap = {
                    'Technology': [
                        'Software', 'Technology', 'IT', 'Software Development', 'Computer Science',
                        'Data Science', 'Artificial Intelligence', 'Machine Learning', 'Cybersecurity',
                        'Web Development', 'Mobile Development', 'DevOps', 'Cloud Computing',
                        'Blockchain', 'Gaming', 'Tech Startup', 'SaaS', 'E-commerce Platform'
                    ],
                    'Finance & Business': [
                        'Finance', 'Banking', 'Investment', 'Accounting', 'Insurance', 'Real Estate',
                        'Business', 'Management', 'Consulting', 'Marketing', 'Sales', 'Business Development',
                        'Strategy', 'Operations', 'Human Resources', 'Venture Capital', 'Private Equity',
                        'Financial Services', 'Fintech', 'Trading', 'Wealth Management'
                    ],
                    'Healthcare & Life Sciences': [
                        'Healthcare', 'Medicine', 'Medical', 'Pharmaceutical', 'Biotechnology',
                        'Health', 'Nursing', 'Dental', 'Veterinary', 'Mental Health', 'Public Health',
                        'Medical Device', 'Clinical Research', 'Biotech', 'Life Sciences', 'Therapy'
                    ],
                    'Education & Research': [
                        'Education', 'Academic', 'Research', 'University', 'Teaching', 'Training',
                        'Learning', 'Educational Technology', 'Academia', 'Scientific Research',
                        'Higher Education', 'K-12 Education', 'Online Education', 'EdTech'
                    ],
                    'Creative & Media': [
                        'Media', 'Entertainment', 'Creative', 'Design', 'Advertising', 'Publishing',
                        'Film', 'Television', 'Music', 'Art', 'Photography', 'Writing', 'Journalism',
                        'Content Creation', 'Digital Media', 'Social Media', 'Graphic Design',
                        'UX/UI Design', 'Fashion', 'Architecture'
                    ],
                    'Engineering & Manufacturing': [
                        'Engineering', 'Manufacturing', 'Construction', 'Mechanical', 'Civil',
                        'Electrical', 'Chemical', 'Aerospace', 'Automotive', 'Industrial',
                        'Materials', 'Energy', 'Oil & Gas', 'Renewable Energy', 'Utilities',
                        'Infrastructure', 'Mining', 'Agriculture', 'Food & Beverage'
                    ],
                    'Government & Non-Profit': [
                        'Government', 'Public Service', 'Non-Profit', 'NGO', 'Charity', 'Social Impact',
                        'Policy', 'International Development', 'Diplomacy', 'Military', 'Defense',
                        'Law Enforcement', 'Legal', 'Law', 'Compliance', 'Regulatory Affairs'
                    ],
                    'Other Industries': [
                        'Transportation', 'Logistics', 'Supply Chain', 'Retail', 'Hospitality',
                        'Travel', 'Tourism', 'Sports', 'Fitness', 'Wellness', 'Beauty', 'Personal Care',
                        'Consumer Goods', 'Telecommunications', 'Security', 'Environmental',
                        'Unknown Industry', 'Other'
                    ]
                };

                const domains = {};
                
                this.filteredData.forEach(alumni => {
                    const industry = alumni.professional?.industry || alumni.Industry || 'Unknown Industry';
                    const industryName = industry.trim() || 'Unknown Industry';
                    
                    // Find which domain this industry belongs to
                    let assignedDomain = 'Other Industries';
                    for (const [domain, industries] of Object.entries(industryDomainMap)) {
                        if (industries.some(domainIndustry => 
                            industryName.toLowerCase().includes(domainIndustry.toLowerCase()) ||
                            domainIndustry.toLowerCase().includes(industryName.toLowerCase())
                        )) {
                            assignedDomain = domain;
                            break;
                        }
                    }
                    
                    // Initialize domain structure
                    if (!domains[assignedDomain]) {
                        domains[assignedDomain] = { alumni: [], industries: {} };
                    }
                    
                    // Add alumni to domain
                    domains[assignedDomain].alumni.push(alumni);
                    
                    // Add to specific industry within domain
                    if (!domains[assignedDomain].industries[industryName]) {
                        domains[assignedDomain].industries[industryName] = [];
                    }
                    domains[assignedDomain].industries[industryName].push(alumni);
                });
                
                // Sort domains by size
                const sortedDomains = {};
                Object.keys(domains)
                    .sort((a, b) => domains[b].alumni.length - domains[a].alumni.length)
                    .forEach(key => {
                        sortedDomains[key] = domains[key];
                    });
                
                return sortedDomains;
            },

            createClusterGroup(className, alumni, groupIndex) {
                const group = document.createElement('div');
                group.className = 'cluster-group';
                group.id = `cluster-${groupIndex}`;
                
                // Get color for this class year
                const year = parseInt(className.replace('Class of ', ''));
                const colorClass = this.getClassColorByYear(year);
                const badgeColor = this.getClusterAccentColor(className, colorClass);
                
                // Create header with matching color
                const header = document.createElement('div');
                header.className = 'cluster-card';
                // Force card sizing to avoid any legacy CSS overriding
                header.style.cssText += 'display:grid;grid-template-columns:52px 1fr auto;width:420px;max-width:95vw;align-items:center;padding:12px 14px;border-radius:16px;background:linear-gradient(180deg,#ffffff,#fafbfc);box-shadow:0 6px 14px rgba(0,0,0,0.08);border:1px solid rgba(0,0,0,0.06);color:#1B365D;';
                // Header statistics card style
                const attendingCount = alumni.filter(a => this.parseAttendingStatus(a.summit_2025?.attending)).length;
                const nonAttending = alumni.length - attendingCount;
                const industries = new Set(alumni.map(a => (a.professional?.industry || '').trim()).filter(Boolean));
                const pct = alumni.length ? Math.round((attendingCount / alumni.length) * 100) : 0;
                header.style.setProperty('--pct', pct);
                header.innerHTML = `
                    <div class="header-left">
                        <div class="ring"><div class="ring-inner">${pct}%</div></div>
                        <div class="header-content">
                            <span class="cluster-title">${className}</span>
                            <span class="cluster-subtitle">${industries.size} industries</span>
                        </div>
                    </div>
                    <div class="header-right">
                        <div class="stat pill">${alumni.length} total</div>
                        <div class="stat pill green">${attendingCount} attending</div>
                        <div class="stat pill gray">${nonAttending} not</div>
                        <span class="toggle-icon">▾</span>
                    </div>
                `;

                // Collapsible toggle
                header.addEventListener('click', () => {
                    group.classList.toggle('collapsed');
                });
                
                // Single grid layout - no row calculations needed

                // Start expanded by default to show fanned decks immediately
                group.classList.remove('collapsed');
                group.appendChild(header);

                // Create fanned deck container - limit to 5 cards (3+2 layout)
                const cardsContainer = document.createElement('div');
                cardsContainer.className = 'cluster-cards deck-mode';

                // Limit to 5 cards maximum for better layout
                const limitedAlumni = alumni.slice(0, 5);

                limitedAlumni.forEach((alumniData, index) => {
                    const card = this.createEnhancedCard(alumniData, index);
                    card.classList.add('clustering');

                    const year = alumniData.personal?.graduation_year;
                    if (year) {
                        const classColorClass = this.getClassColorByYear(year);
                        card.classList.add(classColorClass);
                    }

                    cardsContainer.appendChild(card);
                });

                // Apply fanned positioning after cards are added
                setTimeout(() => {
                    this.applyFannedDeckPositioning(cardsContainer, limitedAlumni.length);
                }, 100);

                group.appendChild(cardsContainer);
                
                return group;
            },

            buildClusterJumpNav(container, clusters) {
                // Remove existing nav if present
                container.querySelector('.cluster-jump-nav')?.remove();
                const nav = document.createElement('div');
                nav.className = 'cluster-jump-nav';
                const fragment = document.createDocumentFragment();

                Object.keys(clusters).forEach((name, idx) => {
                    const count = clusters[name]?.length || 0;
                    const chip = document.createElement('button');
                    chip.className = 'cluster-jump-chip';
                    chip.type = 'button';
                    chip.innerHTML = `<span class="chip-title">${name}</span><span class="chip-count">${count}</span>`;
                    chip.addEventListener('click', () => {
                        const target = container.querySelector(`#cluster-${idx}`);
                        if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    });
                    fragment.appendChild(chip);
                });

                nav.appendChild(fragment);
                container.appendChild(nav);
            },

            getClusterAccentColor(name, classColorClass) {
                // For class clusters, reuse class color mapping
                if (/Class of \d{4}/.test(name) && classColorClass) {
                    return this.getColorByClass(classColorClass);
                }
                // Deterministic color map for other cluster types
                const palette = ['#1B365D','#F39C12','#27AE60','#8E44AD','#16A085','#C0392B','#2C3E50','#D35400'];
                let hash = 0;
                for (let i = 0; i < name.length; i++) hash = (hash * 31 + name.charCodeAt(i)) >>> 0;
                return palette[hash % palette.length];
            },

            getColorByClass(colorClass) {
                const colorMap = {
                    'class-2021': '#FF6B6B',
                    'class-2022': '#4ECDC4',
                    'class-2023': '#45B7D1',
                    'class-2024': '#96CEB4',
                    'class-2025': '#FFEAA7',
                    'class-unknown': '#95A5A6'
                };
                return colorMap[colorClass] || '#95A5A6';
            },

            applyFannedDeckPositioning(container, cardCount) {
                const cards = container.querySelectorAll('.alumni-card');
                
                // Calculate responsive card sizing
                const screenWidth = window.innerWidth;
                let cardWidth = screenWidth <= 768 ? 260 : screenWidth <= 1024 ? 300 : 320;
                let cardSpacing = screenWidth <= 768 ? 40 : screenWidth <= 1024 ? 50 : 60;
                
                // 3+2 layout: first 3 cards in top row, next 2 in bottom row
                cards.forEach((card, index) => {
                    let cardX, cardY, rowIndex;
                    
                    if (index < 3) {
                        // Top row: 3 cards
                        rowIndex = index;
                        const topRowOffset = (2 * cardSpacing) / 2; // Center 3 cards
                        cardX = (rowIndex * cardSpacing) - topRowOffset;
                        cardY = 0;
                    } else {
                        // Bottom row: 2 cards
                        rowIndex = index - 3;
                        const bottomRowOffset = (1 * cardSpacing) / 2; // Center 2 cards
                        cardX = (rowIndex * cardSpacing) - bottomRowOffset;
                        cardY = 60; // Offset bottom row
                    }
                    
                    // Set CSS custom properties
                    card.style.setProperty('--card-x', `${cardX}px`);
                    card.style.setProperty('--card-y', `${cardY}px`);
                    card.style.setProperty('--card-z', cardCount - index);
                    
                    // Update transform to include Y positioning
                    card.style.transform = `translateX(${cardX}px) translateY(${cardY}px)`;
                    
                    // Add staggered animation delay
                    card.style.animationDelay = `${index * 0.08}s`;
                    card.classList.add('smooth-hover');
                });
                
                container.style.position = 'relative';
            },

            // Network Visualization Methods
            initializeNetworkVisualization(selectedAlumni) {
                console.log('🌐 Initializing network for:', selectedAlumni.personal?.name);
                this.networkData = this.generateNetworkData();
                // Show all connections initially
                setTimeout(() => {
                    this.displayConnectedAlumniCards(selectedAlumni, []);
                }, 50);
            },

            displayConnectedAlumniCards(selectedAlumni, activeFilters = []) {
                const container = document.getElementById('connectedAlumniCards');
                if (!container) return;

                // Store current selected alumni for filtering
                this.currentSelectedAlumni = selectedAlumni;
                this.currentActiveFilters = activeFilters;

                // Find the selected alumni and their connections
                const selectedNode = this.networkData.nodes.find(n => 
                    n.name === selectedAlumni.personal?.name
                );
                
                if (!selectedNode) {
                    console.error('Selected alumni not found in network data');
                    return;
                }

                // Get connected alumni (excluding the selected alumni themselves)
                const connectedNodeIds = new Set();
                const connectionTypes = new Map(); // Store connection types for each connected alumni
                
                this.networkData.links.forEach(link => {
                    if (link.source === selectedNode.id) {
                        connectedNodeIds.add(link.target);
                        connectionTypes.set(link.target, link.type);
                    } else if (link.target === selectedNode.id) {
                        connectedNodeIds.add(link.source);
                        connectionTypes.set(link.source, link.type);
                    }
                });

                // Get the connected alumni data
                let connectedAlumni = this.networkData.nodes.filter(n => connectedNodeIds.has(n.id));

                // Apply filters if any are active
                if (activeFilters.length > 0) {
                    connectedAlumni = this.filterConnectedAlumni(connectedAlumni, selectedAlumni, activeFilters);
                }

                // Clear the container
                container.innerHTML = '';

                if (connectedAlumni.length === 0) {
                    container.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: center; min-height: 400px; width: 100%; color: #666; text-align: center; padding: 40px 20px;">
                            <div style="max-width: 300px;">
                                <h3 style="margin-bottom: 12px; font-size: 1.2rem;">${activeFilters.length > 0 ? 'No matching connections' : 'No connections found'}</h3>
                                <p style="margin: 0; font-size: 0.9rem; line-height: 1.4; opacity: 0.8;">${activeFilters.length > 0 ? 'Try adjusting your filters or clear them to see all connections.' : 'This alumni doesn\'t have any network connections yet.'}</p>
                            </div>
                        </div>
                    `;
                    return;
                }

                // Create cards for connected alumni with smooth staggered animation
                connectedAlumni.forEach((alumniNode, index) => {
                    const connectionType = connectionTypes.get(alumniNode.id) || 'friendship';
                    const card = this.createConnectedAlumniCard(alumniNode, connectionType, activeFilters);
                    
                    // Add smooth staggered animation
                    card.style.animationDelay = `${index * 0.08}s`;
                    card.classList.add('fan-in');
                    
                    container.appendChild(card);
                });

                // Setup filter event listeners
                this.setupFilterEventListeners();


            },

            filterConnectedAlumni(connectedAlumni, selectedAlumni, activeFilters) {
                const selectedPersonal = selectedAlumni.personal || {};
                const selectedProfessional = selectedAlumni.professional || {};

                return connectedAlumni.filter(alumniNode => {
                    // Find full alumni data for this node
                    const fullAlumniData = this.alumniData.find(alumni => 
                        alumni.personal?.name === alumniNode.name
                    );
                    
                    if (!fullAlumniData) return false;

                    const personal = fullAlumniData.personal || {};
                    const professional = fullAlumniData.professional || {};

                    // Check each active filter
                    return activeFilters.every(filter => {
                        switch (filter) {
                            case 'class':
                                return selectedPersonal.graduation_year && personal.graduation_year && 
                                       selectedPersonal.graduation_year === personal.graduation_year;
                            case 'degree':
                                return selectedPersonal.degree && personal.degree && 
                                       selectedPersonal.degree === personal.degree;
                            case 'industry':
                                return selectedProfessional.industry && professional.industry && 
                                       selectedProfessional.industry === professional.industry;
                            case 'company':
                                return selectedProfessional.company && professional.company && 
                                       selectedProfessional.company === professional.company;
                            default:
                                return true;
                        }
                    });
                });
            },

            setupFilterEventListeners() {
                // Remove existing listeners to prevent duplicates
                if (this.filterListeners) {
                    this.filterListeners.forEach(({ element, handler }) => {
                        element.removeEventListener('click', handler);
                    });
                }

                this.filterListeners = [];
                this.activeNetworkFilters = this.activeNetworkFilters || [];

                // Setup filter button listeners
                const filterButtons = document.querySelectorAll('.filter-btn:not(.clear-filters)');
                filterButtons.forEach(button => {
                    const handler = (e) => {
                        e.preventDefault();
                        const filter = button.dataset.filter;
                        
                        if (button.classList.contains('active')) {
                            // Remove filter
                            button.classList.remove('active');
                            this.activeNetworkFilters = this.activeNetworkFilters.filter(f => f !== filter);
                        } else {
                            // Add filter
                            button.classList.add('active');
                            if (!this.activeNetworkFilters.includes(filter)) {
                                this.activeNetworkFilters.push(filter);
                            }
                        }

                        // Initialize network data if not already done
                        if (!this.networkData) {
                            this.networkData = this.generateNetworkData();
                        }
                        
                        // Re-display cards with updated filters
                        this.displayConnectedAlumniCards(this.currentSelectedAlumni, this.activeNetworkFilters);
                    };

                    button.addEventListener('click', handler);
                    this.filterListeners.push({ element: button, handler });
                });

                // Setup clear filters button
                const clearButton = document.getElementById('clearFilters');
                if (clearButton) {
                    const clearHandler = (e) => {
                        e.preventDefault();
                        
                        // Clear all active filters
                        this.activeNetworkFilters = [];
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        
                        // Initialize network data if not already done
                        if (!this.networkData) {
                            this.networkData = this.generateNetworkData();
                        }
                        
                        // Re-display all cards
                        this.displayConnectedAlumniCards(this.currentSelectedAlumni, []);
                    };

                    clearButton.addEventListener('click', clearHandler);
                    this.filterListeners.push({ element: clearButton, handler: clearHandler });
                }
            },

            createConnectedAlumniCard(alumniNode, connectionType, activeFilters = []) {
                // Find full alumni data for this node
                const fullAlumniData = this.alumniData.find(alumni => 
                    alumni.personal?.name === alumniNode.name
                );
                
                const personal = fullAlumniData?.personal || {};
                const professional = fullAlumniData?.professional || {};
                const summit = fullAlumniData?.summit_2025 || {};

                // Determine card style based on active filters and multiple connections
                const cardStyle = this.determineCardStyle(fullAlumniData, activeFilters);
                const multipleConnections = this.getMultipleConnections(fullAlumniData);

                const card = document.createElement('div');
                card.className = `connected-alumni-card ${cardStyle.className}`;
                
                card.innerHTML = `
                    <div class="card-photo">
                        ${this.renderPhoto(personal.photo, alumniNode.name) || '👤'}
                    </div>
                    <div class="card-name">${alumniNode.name}</div>
                    <div class="card-role">${professional.current_role || 'Professional'}</div>
                    <div class="card-details">
                        ${professional.company ? `
                            <div class="card-detail-item">
                                <span class="card-detail-icon">🏢</span>
                                <span>${professional.company}</span>
                            </div>
                        ` : ''}
                        ${personal.graduation_year ? `
                            <div class="card-detail-item">
                                <span class="card-detail-icon">🎓</span>
                                <span>Class of ${personal.graduation_year}</span>
                            </div>
                        ` : ''}
                        ${professional.industry ? `
                            <div class="card-detail-item">
                                <span class="card-detail-icon">🏭</span>
                                <span>${professional.industry}</span>
                            </div>
                        ` : ''}
                        ${personal.location?.city ? `
                            <div class="card-detail-item">
                                <span class="card-detail-icon">📍</span>
                                <span>${personal.location.city}</span>
                            </div>
                        ` : ''}
                        ${summit.attending ? `
                            <div class="card-detail-item">
                                <span class="card-detail-icon">🎪</span>
                                <span>Summit 2025</span>
                            </div>
                        ` : ''}
                    </div>
                    <div class="connection-badges">
                        ${this.generateConnectionBadges(multipleConnections)}
                    </div>
                `;

                // Add click handler to navigate to this alumni's connections
                card.addEventListener('click', () => {
                    if (fullAlumniData) {
                        console.log(`🎯 Switching network focus to: ${fullAlumniData.personal?.name}`);
                        
                        // Update the left panel with this alumni's details
                        this.updateSelectedAlumniCard(fullAlumniData);
                        
                        // Show all connections for this alumni initially
                        setTimeout(() => {
                            this.displayConnectedAlumniCards(fullAlumniData, []);
                        }, 100);
                    }
                });

                return card;
            },

            determineCardStyle(alumniData, activeFilters) {
                const selectedPersonal = this.currentSelectedAlumni?.personal || {};
                const selectedProfessional = this.currentSelectedAlumni?.professional || {};
                const personal = alumniData?.personal || {};
                const professional = alumniData?.professional || {};

                // If specific filter is active, style based on that filter
                if (activeFilters.includes('class') && selectedPersonal.graduation_year === personal.graduation_year) {
                    return { className: 'class-connection', label: 'Same Class' };
                }
                if (activeFilters.includes('degree') && selectedPersonal.degree === personal.degree) {
                    return { className: 'degree-connection', label: 'Same Degree' };
                }
                if (activeFilters.includes('industry') && selectedProfessional.industry === professional.industry) {
                    return { className: 'industry-connection', label: 'Same Industry' };
                }
                if (activeFilters.includes('company') && selectedProfessional.company === professional.company) {
                    return { className: 'company-connection', label: 'Same Company' };
                }

                // Default styling
                return { className: 'general-connection', label: 'Connection' };
            },

            getMultipleConnections(alumniData) {
                const selectedPersonal = this.currentSelectedAlumni?.personal || {};
                const selectedProfessional = this.currentSelectedAlumni?.professional || {};
                const personal = alumniData?.personal || {};
                const professional = alumniData?.professional || {};

                const connections = [];
                
                if (selectedPersonal.graduation_year === personal.graduation_year) {
                    connections.push('class');
                }
                if (selectedPersonal.degree === personal.degree) {
                    connections.push('degree');
                }
                if (selectedProfessional.industry === professional.industry) {
                    connections.push('industry');
                }
                if (selectedProfessional.company === professional.company) {
                    connections.push('company');
                }

                return connections;
            },

            generateConnectionBadges(connections) {
                if (connections.length === 0) return '';
                
                const badges = connections.map(connectionType => {
                    const badgeInfo = this.getConnectionBadgeInfo(connectionType);
                    return `<span class="connection-badge ${connectionType}-badge">${badgeInfo.icon} ${badgeInfo.label}</span>`;
                });
                
                return badges.join('');
            },

            getConnectionBadgeInfo(connectionType) {
                const badgeMap = {
                    'class': { icon: '🎓', label: 'Same Class' },
                    'degree': { icon: '📚', label: 'Same Degree' },
                    'industry': { icon: '🏭', label: 'Same Industry' },
                    'company': { icon: '🏢', label: 'Same Company' }
                };
                
                return badgeMap[connectionType] || { icon: '🔗', label: 'Connection' };
            },

            getConnectionTypeLabel(type) {
                const labels = {
                    'cohort': 'Same Class',
                    'professional': 'Same Field',
                    'friendship': 'Connection'
                };
                return labels[type] || 'Connection';
            },

            generateNetworkData() {
                console.log('🔄 Generating network data from alumni...');
                const nodes = this.alumniData.map((alumni, index) => ({
                    id: `alumni_${index}`,
                    name: alumni.personal?.name || 'Anonymous',
                    class: alumni.personal?.graduation_year || '',
                    degree: alumni.personal?.degree || '',
                    industry: alumni.professional?.industry || '',
                    company: alumni.professional?.company || '',
                    position: alumni.professional?.current_role || '',
                    location: alumni.personal?.location?.city || '',
                    attending: alumni.summit_2025?.attending || false,
                    photo: alumni.personal?.photo || '',
                    rawData: alumni
                }));

                const links = [];
                for (let i = 0; i < nodes.length; i++) {
                    for (let j = i + 1; j < nodes.length; j++) {
                        const nodeA = nodes[i];
                        const nodeB = nodes[j];
                        let connectionStrength = 0;
                        let connectionType = null;
                        
                        if (nodeA.class && nodeB.class && nodeA.class === nodeB.class) {
                            connectionType = 'cohort';
                            connectionStrength += 3;
                        }
                        if (nodeA.degree && nodeB.degree && nodeA.degree === nodeB.degree) {
                            connectionType = connectionType || 'professional';
                            connectionStrength += 2;
                        }
                        if (nodeA.industry && nodeB.industry && nodeA.industry === nodeB.industry) {
                            connectionType = connectionType || 'professional';
                            connectionStrength += 1;
                        }
                        if (nodeA.company && nodeB.company && nodeA.company === nodeB.company) {
                            connectionType = 'professional';
                            connectionStrength += 4;
                        }
                        
                        if (connectionStrength > 0) {
                            links.push({
                                source: nodeA.id,
                                target: nodeB.id,
                                type: connectionType,
                                strength: connectionStrength
                            });
                        }
                    }
                }
                
                nodes.forEach(node => {
                    node.connections = links.filter(link => 
                        link.source === node.id || link.target === node.id
                    ).length;
                    node.centrality = node.connections;
                });

                console.log(`✅ Generated ${nodes.length} nodes and ${links.length} links`);
                return { nodes, links };
            },

            createNetworkVisualization(selectedAlumni) {
                const container = document.getElementById('networkSvg');
                if (!container) return;

                // Find the selected alumni and their connections
                const selectedNode = this.networkData.nodes.find(n => 
                    n.name === selectedAlumni.personal?.name
                );
                
                if (!selectedNode) {
                    console.error('Selected alumni not found in network data');
                    return;
                }

                // Get only connected nodes (selected + direct connections)
                const connectedNodeIds = new Set([selectedNode.id]);
                const relevantLinks = [];
                
                this.networkData.links.forEach(link => {
                    if (link.source === selectedNode.id || link.target === selectedNode.id) {
                        connectedNodeIds.add(link.source);
                        connectedNodeIds.add(link.target);
                        relevantLinks.push(link);
                    }
                });

                // Filter to only show connected nodes
                const filteredNodes = this.networkData.nodes.filter(n => connectedNodeIds.has(n.id));
                const filteredLinks = relevantLinks;

                console.log(`🎯 Showing ${filteredNodes.length} nodes and ${filteredLinks.length} connections for ${selectedNode.name}`);

                container.innerHTML = '';
                const containerRect = container.getBoundingClientRect();
                const width = containerRect.width || 800;
                const height = containerRect.height || 600;
                
                const svg = d3.select('#networkSvg').attr('width', width).attr('height', height);
                const g = svg.append('g');
                
                // Create mini card layout
                const layoutData = this.createMiniCardLayout(filteredNodes, selectedNode, width, height);
                
                console.log('🎯 Layout data:', layoutData);
                console.log('🎯 Filtered nodes:', filteredNodes.length);
                
                // Clear the right panel and create HTML-based mini cards instead
                const rightPanel = document.querySelector('.network-right-panel');
                console.log('🎯 Right panel found:', !!rightPanel);
                
                if (rightPanel) {
                    rightPanel.innerHTML = '';
                    this.renderMiniCards(layoutData, selectedNode, rightPanel);
                } else {
                    console.error('Network right panel not found');
                }

                // Store network elements for cleanup
                this.networkElements = { svg, g };
                this.selectedNetworkNode = selectedNode;
            },

            highlightNetworkNode(selectedNode) {
                if (!this.networkElements) return;
                
                const connectedNodeIds = new Set([selectedNode.id]);
                this.networkData.links.forEach(link => {
                    if (link.source.id === selectedNode.id || link.target.id === selectedNode.id) {
                        connectedNodeIds.add(link.source.id);
                        connectedNodeIds.add(link.target.id);
                    }
                });

                this.networkElements.nodes.attr("opacity", d => connectedNodeIds.has(d.id) ? 1 : 0.2);
                this.networkElements.links.attr("opacity", d => 
                    (connectedNodeIds.has(d.source.id) && connectedNodeIds.has(d.target.id)) ? 0.8 : 0.1
                );
                this.networkElements.labels.attr("opacity", d => connectedNodeIds.has(d.id) ? 1 : 0.2);
            },

            cleanupNetworkVisualization() {
                if (this.networkElements && this.networkElements.simulation) {
                    this.networkElements.simulation.stop();
                }
                this.networkElements = null;
                this.networkData = null;
            },

            // Helper methods for network visualization
            getNodeRadius(node) {
                const baseRadius = 8;
                const maxRadius = 25;
                if (!this.networkData || !this.networkData.nodes.length) return baseRadius;
                const maxConnections = Math.max(...this.networkData.nodes.map(n => n.connections));
                return baseRadius + (node.connections / Math.max(maxConnections, 1)) * (maxRadius - baseRadius);
            },

            getNodeColor(node) {
                if (node.connections >= 15) return "#ff6b6b"; // High influence
                if (node.connections >= 8) return "#ffa726";  // Medium influence  
                if (node.connections >= 3) return "#66bb6a";  // Low influence
                return "#90caf9"; // Minimal influence
            },

            getNodeConnectionColor(node, selectedNode) {
                if (node.id === selectedNode.id) {
                    return "#1B365D"; // Selected node - dark blue
                }
                
                // Check connection type
                const connectionType = this.getConnectionType(node, selectedNode);
                
                switch (connectionType) {
                    case 'same_class':
                        return "#E74C3C"; // Red for same class
                    case 'same_degree':
                        return "#3498DB"; // Blue for same degree
                    case 'same_industry':
                        return "#27AE60"; // Green for same industry
                    case 'same_company':
                        return "#F39C12"; // Orange for same company
                    default:
                        return "#95A5A6"; // Gray for other connections
                }
            },

            getNodeBorderColor(node, selectedNode) {
                if (node.id === selectedNode.id) {
                    return "#F39C12"; // Golden border for selected
                }
                return "#fff"; // White border for others
            },

            getLinkColor(link, selectedNode) {
                const sourceNode = this.networkData.nodes.find(n => n.id === link.source.id || n.id === link.source);
                const targetNode = this.networkData.nodes.find(n => n.id === link.target.id || n.id === link.target);
                
                if (!sourceNode || !targetNode) return "#999";
                
                // Determine the connection type between these two nodes
                if (sourceNode.class && targetNode.class && sourceNode.class === targetNode.class) {
                    return "#E74C3C"; // Red for same class
                }
                if (sourceNode.degree && targetNode.degree && sourceNode.degree === targetNode.degree) {
                    return "#3498DB"; // Blue for same degree
                }
                if (sourceNode.industry && targetNode.industry && sourceNode.industry === targetNode.industry) {
                    return "#27AE60"; // Green for same industry
                }
                if (sourceNode.company && targetNode.company && sourceNode.company === targetNode.company) {
                    return "#F39C12"; // Orange for same company
                }
                
                return "#95A5A6"; // Gray for other connections
            },

            getLinkWidth(link) {
                const sourceNode = this.networkData.nodes.find(n => n.id === link.source.id || n.id === link.source);
                const targetNode = this.networkData.nodes.find(n => n.id === link.target.id || n.id === link.target);
                
                if (!sourceNode || !targetNode) return 2;
                
                let width = 1;
                
                // Thicker lines for stronger connections
                if (sourceNode.company && targetNode.company && sourceNode.company === targetNode.company) {
                    width += 3; // Same company = strongest
                }
                if (sourceNode.class && targetNode.class && sourceNode.class === targetNode.class) {
                    width += 2; // Same class = strong
                }
                if (sourceNode.degree && targetNode.degree && sourceNode.degree === targetNode.degree) {
                    width += 1.5; // Same degree = medium
                }
                if (sourceNode.industry && targetNode.industry && sourceNode.industry === targetNode.industry) {
                    width += 1; // Same industry = weak
                }
                
                return Math.min(width, 5); // Cap at 5px
            },

            getLinkDashPattern(link, selectedNode) {
                const sourceNode = this.networkData.nodes.find(n => n.id === link.source.id || n.id === link.source);
                const targetNode = this.networkData.nodes.find(n => n.id === link.target.id || n.id === link.target);
                
                if (!sourceNode || !targetNode) return "none";
                
                // Solid lines for class connections, dashed for degree
                if (sourceNode.class && targetNode.class && sourceNode.class === targetNode.class) {
                    return "none"; // Solid line for same class
                }
                if (sourceNode.degree && targetNode.degree && sourceNode.degree === targetNode.degree) {
                    return "5,5"; // Dashed line for same degree
                }
                if (sourceNode.company && targetNode.company && sourceNode.company === targetNode.company) {
                    return "none"; // Solid line for same company
                }
                if (sourceNode.industry && targetNode.industry && sourceNode.industry === targetNode.industry) {
                    return "3,3"; // Dotted line for same industry
                }
                
                return "1,3"; // Very dotted for other connections
            },

            getConnectionType(node, selectedNode) {
                if (node.class && selectedNode.class && node.class === selectedNode.class) {
                    return 'same_class';
                }
                if (node.degree && selectedNode.degree && node.degree === selectedNode.degree) {
                    return 'same_degree';
                }
                if (node.industry && selectedNode.industry && node.industry === selectedNode.industry) {
                    return 'same_industry';
                }
                if (node.company && selectedNode.company && node.company === selectedNode.company) {
                    return 'same_company';
                }
                return 'other';
            },

            createMiniCardLayout(nodes, selectedNode, width, height) {
                // Group nodes by connection type
                const clusters = {
                    same_class: [],
                    same_degree: [],
                    same_industry: [],
                    same_company: []
                };

                nodes.forEach(node => {
                    if (node.id !== selectedNode.id) {
                        const connectionType = this.getConnectionType(node, selectedNode);
                        if (connectionType !== 'other') { // Skip 'other' connections for cleaner layout
                            clusters[connectionType].push(node);
                        }
                    }
                });

                // Create 3-column layout: Degree | Class | Industry/Company
                const columnConfig = {
                    width: width / 3,
                    startY: 80,
                    cardHeight: 120,
                    cardSpacing: 15,
                    maxPerColumn: 16 // 4 cards per row, up to 4 rows
                };

                const columns = [
                    {
                        title: '🎓 Same Degree',
                        color: '#3498DB',
                        nodes: clusters.same_degree.slice(0, columnConfig.maxPerColumn),
                        x: columnConfig.width * 0.5,
                        hiddenCount: Math.max(0, clusters.same_degree.length - columnConfig.maxPerColumn)
                    },
                    {
                        title: '📅 Same Class',
                        color: '#E74C3C', 
                        nodes: clusters.same_class.slice(0, columnConfig.maxPerColumn),
                        x: columnConfig.width * 1.5,
                        hiddenCount: Math.max(0, clusters.same_class.length - columnConfig.maxPerColumn)
                    },
                    {
                        title: '🏭 Industry & Company',
                        color: '#27AE60',
                        nodes: [...clusters.same_industry, ...clusters.same_company].slice(0, columnConfig.maxPerColumn),
                        x: columnConfig.width * 2.5,
                        hiddenCount: Math.max(0, (clusters.same_industry.length + clusters.same_company.length) - columnConfig.maxPerColumn)
                    }
                ];

                console.log(`🎯 Created mini card layout:`, {
                    degree: clusters.same_degree.length,
                    class: clusters.same_class.length,
                    industry: clusters.same_industry.length,
                    company: clusters.same_company.length
                });

                return { columns, selectedNode, columnConfig };
            },

            renderMiniCards(layoutData, selectedNode, container) {
                console.log('🎯 renderMiniCards called with:', { layoutData, selectedNode, container });
                
                const { columns, columnConfig } = layoutData;
                
                if (!container) {
                    console.error('Container not provided to renderMiniCards');
                    return;
                }
                
                console.log('🎯 Columns to render:', columns.length);
                columns.forEach((col, i) => {
                    console.log(`🎯 Column ${i}: ${col.title} - ${col.nodes.length} nodes`);
                });
                
                // Create main container with 3 columns
                const mainContainer = document.createElement('div');
                mainContainer.style.cssText = `
                    display: flex;
                    width: 100%;
                    height: 100%;
                    padding: 20px;
                    gap: 20px;
                    overflow-y: auto;
                `;

                // Add selected alumni header
                const header = document.createElement('div');
                header.style.cssText = `
                    position: absolute;
                    top: 10px;
                    left: 50%;
                    transform: translateX(-50%);
                    font-size: 18px;
                    font-weight: 700;
                    color: #1B365D;
                    z-index: 10;
                `;
                header.textContent = `👤 ${selectedNode.name}'s Network`;
                container.appendChild(header);

                // Create columns
                columns.forEach((column, index) => {
                    const columnDiv = document.createElement('div');
                    columnDiv.style.cssText = `
                        flex: 1;
                        margin-top: 50px;
                        padding: 0 5px;
                    `;

                    // Column header
                    const columnHeader = document.createElement('div');
                    columnHeader.style.cssText = `
                        font-size: 16px;
                        font-weight: 600;
                        color: ${column.color};
                        padding: 10px;
                        border-bottom: 2px solid ${column.color};
                        margin-bottom: 10px;
                    `;
                    
                    const countText = column.hiddenCount > 0 
                        ? `${column.nodes.length}/${column.nodes.length + column.hiddenCount} (+${column.hiddenCount} more)`
                        : `${column.nodes.length}`;
                    
                    columnHeader.innerHTML = `${column.title} <span style="font-size: 12px; opacity: 0.7;">(${countText})</span>`;
                    columnDiv.appendChild(columnHeader);

                    // Create cards grid container
                    const cardsGrid = document.createElement('div');
                    cardsGrid.style.cssText = `
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 2px;
                        justify-items: center;
                        margin-top: 15px;
                        max-width: 100%;
                    `;

                    // Add mini cards to grid
                    column.nodes.forEach(node => {
                        const miniCard = this.createMiniCard(node, column.color);
                        cardsGrid.appendChild(miniCard);
                    });

                    columnDiv.appendChild(cardsGrid);

                    mainContainer.appendChild(columnDiv);
                });

                container.appendChild(mainContainer);
            },

            createMiniCard(alumni, accentColor) {
                const card = document.createElement('div');
                
                // Use the exact same classes and structure as main cards, but add mini-card class for sizing
                card.className = 'alumni-card mini-card';
                card.style.borderColor = accentColor;

                // Click handler
                card.addEventListener('click', () => {
                    this.handleNetworkNodeClick(null, alumni);
                });

                // Use exact same HTML structure as main cards
                card.innerHTML = this.generateMiniCardHTML(alumni, accentColor);

                return card;
            },

            generateMiniCardHTML(alumni, accentColor) {
                // Extract data the same way as main cards
                const personal = alumni.rawData?.personal || alumni;
                const professional = alumni.rawData?.professional || alumni;
                const social = alumni.rawData?.social || alumni;
                const summit = alumni.rawData?.summit_2025 || alumni;
                
                // Use the same data extraction logic
                const name = personal.name || alumni.name || 'Anonymous';
                const graduationYear = personal.graduation_year || personal.class || alumni.class || 'Unknown';
                const degree = personal.degree || alumni.degree || '';
                const currentRole = professional.current_role || professional.role || alumni.role || 'Professional';
                const company = professional.company || alumni.company || 'Company';
                const industry = professional.industry || alumni.industry || 'Industry';
                const photo = personal.photo || alumni.photo || '';
                const linkedin = social.linkedin || alumni.linkedin || '';
                const attending = summit.attending || alumni.attending || false;

                return `
                    <div class="card-content">
                        <div class="card-header">
                            <div class="profile-photo ${this.getClassColorByYear(graduationYear)}">${this.renderPhoto(photo, name)}</div>
                        </div>
                        
                        <div class="card-body">
                            <h3 class="alumni-name">${name}</h3>
                            <p class="graduation-class">Class of ${graduationYear}</p>
                            ${degree ? `<p class="degree-info">${degree}</p>` : ''}
                            
                            <div class="professional-info">
                                <p class="current-position">${currentRole}</p>
                                <p class="company-name">${company}</p>
                                <p class="industry-name">${industry}</p>
                            </div>
                            
                            <div class="card-footer">
                                ${this.renderLinkedInButton(linkedin)}
                                ${this.renderAttendingStatus(attending)}
                            </div>
                        </div>
                    </div>
                `;
            },

            addSectionHeaders(g, sectionHeaders, selectedNode, width) {
                // Add selected alumni header at the top
                g.append('text')
                    .attr('x', width / 2)
                    .attr('y', 25)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '16px')
                    .attr('font-weight', '700')
                    .attr('fill', '#1B365D')
                    .text(`👤 ${selectedNode.name}'s Network`);

                // Add section headers for each connection type
                sectionHeaders.forEach(section => {
                    // Add section title
                    g.append('text')
                        .attr('x', section.x)
                        .attr('y', section.y)
                        .attr('font-size', '14px')
                        .attr('font-weight', '600')
                        .attr('fill', section.color)
                        .text(`${section.icon} ${section.label}`);

                    // Add count info
                    const countText = section.hiddenCount > 0 
                        ? `${section.visibleCount}/${section.totalCount} (+${section.hiddenCount} more)`
                        : `${section.totalCount}`;
                    
                    g.append('text')
                        .attr('x', section.x + 150)
                        .attr('y', section.y)
                        .attr('font-size', '12px')
                        .attr('font-weight', '400')
                        .attr('fill', section.color)
                        .attr('opacity', 0.7)
                        .text(countText);
                });
            },



            handleNetworkNodeClick(event, nodeData) {
                console.log(`🎯 Clicked on network node: ${nodeData.name}`);
                
                // Find the full alumni data for this node
                const fullAlumniData = this.alumniData.find(alumni => 
                    (alumni.personal?.name === nodeData.name) || 
                    (alumni.name === nodeData.name)
                );
                
                if (!fullAlumniData) {
                    console.error('Full alumni data not found for:', nodeData.name);
                    console.log('Available alumni names:', this.alumniData.slice(0, 5).map(a => a.personal?.name || a.name));
                    return;
                }
                
                console.log(`🎯 Found full alumni data, regenerating network for: ${fullAlumniData.personal?.name || fullAlumniData.name}`);
                
                // Reset all active filters when navigating to a new alumni
                this.resetNetworkFilters();
                
                // Clean up current network visualization
                this.cleanupNetworkVisualization();
                
                // Update the left panel with this alumni's details
                this.updateSelectedAlumniCard(fullAlumniData);
                
                // Regenerate the network for this alumni
                setTimeout(() => {
                    this.initializeNetworkVisualization(fullAlumniData);
                }, 100);
            },

            resetNetworkFilters() {
                console.log('🔄 Resetting network filters and clicked states');
                
                // Reset all filter buttons to inactive state
                const filterButtons = document.querySelectorAll('.filter-btn');
                filterButtons.forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Reset all clicked alumni cards to their normal state
                const allAlumniCards = document.querySelectorAll('.connected-alumni-card');
                allAlumniCards.forEach(card => {
                    card.classList.remove('clicked');
                    // Remove any inline styles that might have been added for clicked state
                    card.style.transform = '';
                    card.style.boxShadow = '';
                    card.style.zIndex = '';
                });
                
                // Clear any active filter states
                this.activeNetworkFilter = null;
                
                console.log('✅ Network filters and clicked states reset');
            },

            updateSelectedAlumniCard(alumni) {
                const personal = alumni.personal || {};
                const professional = alumni.professional || {};
                const summit = alumni.summit_2025 || {};
                
                // Update name and role
                const nameElement = document.getElementById('selectedAlumniName');
                const roleElement = document.getElementById('selectedAlumniRole');
                const photoElement = document.getElementById('selectedAlumniPhoto');
                
                if (nameElement) nameElement.textContent = personal.name;
                if (roleElement) roleElement.textContent = professional.current_role || 'Role not specified';
                if (photoElement) photoElement.innerHTML = this.renderPhoto(personal.photo, personal.name);
                
                // Update details section
                const detailsElement = document.getElementById('selectedAlumniDetails');
                if (detailsElement) {
                    detailsElement.innerHTML = `
                        <div class="detail-item">
                            <span class="icon">🏢</span>
                            <span class="label">Company:</span>
                            <span class="value">${professional.company || 'Not specified'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="icon">🎓</span>
                            <span class="label">Degree:</span>
                            <span class="value">${personal.degree || 'Not specified'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="icon">📅</span>
                            <span class="label">Class:</span>
                            <span class="value">${personal.graduation_year ? `Class of ${personal.graduation_year}` : 'Not specified'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="icon">🏭</span>
                            <span class="label">Industry:</span>
                            <span class="value">${professional.industry || 'Not specified'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="icon">📍</span>
                            <span class="label">Location:</span>
                            <span class="value">${personal.location?.city ? `${personal.location.city}, ${personal.location.country || ''}` : 'Not specified'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="icon">🎪</span>
                            <span class="label">Summit 2025:</span>
                            <span class="value">${summit.attending ? 'Attending' : 'Not attending'}</span>
                        </div>
                    `;
                }
                
                // Update header
                const headerElement = document.querySelector('.network-header h2');
                if (headerElement) headerElement.textContent = personal.name;
            },

            updateConnectionsDetails(selectedNode, connectedNodes) {
                const detailsElement = document.getElementById('networkConnectionsDetails');
                if (!detailsElement) return;

                // Filter out the selected node to get only connections
                const connections = connectedNodes.filter(node => node.id !== selectedNode.id);
                
                if (connections.length === 0) {
                    detailsElement.innerHTML = `
                        <h4>Network Connections</h4>
                        <p style="color: #666; font-style: italic;">No connections found</p>
                    `;
                    return;
                }

                // Group connections by class and degree
                const connectionsByClass = {};
                const connectionsByDegree = {};
                
                connections.forEach(connection => {
                    // Group by class
                    const classYear = connection.class || 'Unknown Class';
                    if (!connectionsByClass[classYear]) {
                        connectionsByClass[classYear] = [];
                    }
                    connectionsByClass[classYear].push(connection);
                    
                    // Group by degree
                    const degree = connection.degree || 'Unknown Degree';
                    if (!connectionsByDegree[degree]) {
                        connectionsByDegree[degree] = [];
                    }
                    connectionsByDegree[degree].push(connection);
                });

                // Generate HTML for connections details
                let html = '<h4>Network Connections</h4>';
                
                // Class connections
                if (Object.keys(connectionsByClass).length > 0) {
                    html += '<div class="connection-category">';
                    html += '<h5><span class="category-icon">📅</span>By Class <span class="category-count">' + connections.length + '</span></h5>';
                    html += '<ul class="connection-list">';
                    
                    // Sort classes by year (newest first)
                    const sortedClasses = Object.keys(connectionsByClass).sort((a, b) => {
                        if (a === 'Unknown Class') return 1;
                        if (b === 'Unknown Class') return -1;
                        return parseInt(b) - parseInt(a);
                    });
                    
                    sortedClasses.forEach(classYear => {
                        const classConnections = connectionsByClass[classYear];
                        classConnections.forEach(connection => {
                            html += `
                                <li class="connection-item" onclick="alumniApp.handleConnectionClick('${connection.id}')">
                                    <div class="connection-photo">
                                        ${this.getConnectionInitials(connection.name)}
                                    </div>
                                    <div class="connection-info">
                                        <div class="connection-name">${connection.name}</div>
                                        <div class="connection-detail">Class of ${classYear}</div>
                                    </div>
                                </li>
                            `;
                        });
                    });
                    html += '</ul></div>';
                }

                // Degree connections
                if (Object.keys(connectionsByDegree).length > 0) {
                    html += '<div class="connection-category">';
                    html += '<h5><span class="category-icon">🎓</span>By Degree <span class="category-count">' + connections.length + '</span></h5>';
                    html += '<ul class="connection-list">';
                    
                    // Sort degrees alphabetically
                    const sortedDegrees = Object.keys(connectionsByDegree).sort((a, b) => {
                        if (a === 'Unknown Degree') return 1;
                        if (b === 'Unknown Degree') return -1;
                        return a.localeCompare(b);
                    });
                    
                    sortedDegrees.forEach(degree => {
                        const degreeConnections = connectionsByDegree[degree];
                        degreeConnections.forEach(connection => {
                            html += `
                                <li class="connection-item" onclick="alumniApp.handleConnectionClick('${connection.id}')">
                                    <div class="connection-photo">
                                        ${this.getConnectionInitials(connection.name)}
                                    </div>
                                    <div class="connection-info">
                                        <div class="connection-name">${connection.name}</div>
                                        <div class="connection-detail">${degree}</div>
                                    </div>
                                </li>
                            `;
                        });
                    });
                    html += '</ul></div>';
                }

                detailsElement.innerHTML = html;
            },

            getConnectionInitials(name) {
                if (!name) return 'AN';
                const names = name.split(' ');
                return names.map(n => n[0]).join('').substring(0, 2).toUpperCase();
            },

            handleConnectionClick(nodeId) {
                // Find the node data
                const nodeData = this.networkData.nodes.find(n => n.id === nodeId);
                if (nodeData) {
                    this.handleNetworkNodeClick(null, nodeData);
                }
            }
        });

        // Initialize the enhanced app when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('📄 DOM loaded, starting Enhanced Alumni App...');
            
            // Immediately scroll to top on page load
            window.scrollTo(0, 0);
            
            window.alumniApp = new EnhancedAlumniApp();
        });

        // Handle window resize for fanned deck positioning
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // Recalculate fanned deck positions for all visible clusters
                const clusterContainers = document.querySelectorAll('.cluster-cards.deck-mode');
                clusterContainers.forEach(container => {
                    const cardCount = container.querySelectorAll('.alumni-card').length;
                    if (cardCount > 0 && window.alumniApp) {
                        window.alumniApp.applyFannedDeckPositioning(container, cardCount);
                    }
                });
                console.log('🔄 Fanned deck positions recalculated for new screen size');
            }, 250);
        });

        // Fallback initialization if DOM is already loaded
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            console.log('📄 DOM already loaded, starting Enhanced Alumni App immediately...');
            
            // Immediately scroll to top on page load
            window.scrollTo(0, 0);
            
            window.alumniApp = new EnhancedAlumniApp();
        }
    </script>

    <!-- MOBILE POPUP LAYOUT - JAVASCRIPT -->
    <script>
        // MOBILE POPUP LAYOUT HANDLER
        function setupMobileLayout() {
            console.log(`📱 Screen width: ${window.innerWidth}px - ${window.innerWidth <= 768 ? 'MOBILE' : 'DESKTOP'} mode`);
            if (window.innerWidth <= 768) {
                // Watch for modal opens
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        const modal = document.querySelector('.modal-overlay.visible .modal-content');
                        const modalBody = document.querySelector('.modal-overlay.visible .modal-content .modal-body');
                        
                        if (modal && modalBody) {
                            console.log('📱 Applying mobile layout to modal');
                            // Make modal full screen on mobile
                            modal.style.width = '95vw';
                            modal.style.height = '90vh';
                            modal.style.maxWidth = '95vw';
                            modal.style.maxHeight = '90vh';
                            modal.style.margin = '0';
                            modal.style.borderRadius = '12px';
                            
                            // Make modal body vertical layout
                            modalBody.style.display = 'flex';
                            modalBody.style.flexDirection = 'column';
                            modalBody.style.padding = '1rem';
                            modalBody.style.overflowY = 'auto';
                            modalBody.style.height = 'calc(100% - 60px)';
                            
                            // Hide the original larger content, only show our mini version
                            const children = modalBody.children;
                            for (let i = 0; i < children.length; i++) {
                                const child = children[i];
                                // Hide everything except our mini network modal
                                if (!child.classList.contains('mobile-network-modal')) {
                                    child.style.display = 'none';
                                }
                            }
                            
                            // If this is a networking modal, add suggestion cards
                            setTimeout(() => {
                                addMobileSuggestionCards(modalBody);
                            }, 100);
                        }
                    });
                });
                
                observer.observe(document.body, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                    attributeFilter: ['class']
                });
            } else {
                console.log('🖥️ Desktop mode - using standard modal layout');
            }
        }
        
        // Create MINIATURE DESKTOP VERSION - like opening on a vertical little laptop
        function addMobileSuggestionCards(modalBody) {
            // Check if we already added the mini desktop version
            if (modalBody.querySelector('.mobile-network-modal')) return;
            
            // Get real alumni data from the app
            if (!window.alumniApp || !window.alumniApp.alumniData) return;
            
            const allAlumni = window.alumniApp.alumniData;
            if (!allAlumni || allAlumni.length === 0) return;
            
            // Find current selected alumni from the modal
            const currentAlumniName = modalBody.querySelector('.profile-info h3, .alumni-name, h2, h3')?.textContent?.trim();
            const currentAlumni = currentAlumniName ? allAlumni.find(a => a.personal?.name === currentAlumniName) : allAlumni[0];
            
            // Create EXACT desktop structure but miniaturized
            const miniNetworkModal = document.createElement('div');
            miniNetworkModal.className = 'mobile-network-modal';
            miniNetworkModal.style.cssText = `
                width: 100%; 
                background: #f8fafc; 
                border-radius: 8px; 
                overflow: hidden; 
                margin-top: 1rem;
                font-size: 0.7rem;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                opacity: 0;
                transform: scale(0.95) translateY(10px);
                transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            `;
            
            const personal = currentAlumni?.personal || {};
            const professional = currentAlumni?.professional || {};
            
            miniNetworkModal.innerHTML = `
                <!-- MINI DESKTOP HEADER - scaled down -->
                <div class="mobile-network-header" style="background: linear-gradient(135deg, #0B6BFF 0%, #00C2A8 100%); color: white; padding: 1rem; text-align: center; border-radius: 8px 8px 0 0;">
                    <h2 style="margin: 0 0 0.25rem 0; font-size: 1rem; font-weight: 700;">${personal.name || 'Alumni Network'}</h2>
                    <p style="margin: 0 0 0.5rem 0; opacity: 0.9; font-size: 0.6rem;">Professional Network Connections</p>
                    
                    <!-- MINI FILTER BUTTONS - exact desktop functionality -->
                    <div class="mobile-network-filters" style="display: flex; gap: 4px; justify-content: center; flex-wrap: wrap;">
                        <button class="mobile-filter-btn" data-filter="class" style="display: flex; align-items: center; gap: 2px; padding: 4px 6px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; border-radius: 12px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <span style="font-size: 8px;">🎓</span>
                            <span>Class</span>
                        </button>
                        <button class="mobile-filter-btn" data-filter="degree" style="display: flex; align-items: center; gap: 2px; padding: 4px 6px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; border-radius: 12px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <span style="font-size: 8px;">📚</span>
                            <span>Degree</span>
                        </button>
                        <button class="mobile-filter-btn" data-filter="industry" style="display: flex; align-items: center; gap: 2px; padding: 4px 6px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; border-radius: 12px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <span style="font-size: 8px;">🏭</span>
                            <span>Industry</span>
                        </button>
                        <button class="mobile-filter-btn" data-filter="company" style="display: flex; align-items: center; gap: 2px; padding: 4px 6px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; border-radius: 12px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <span style="font-size: 8px;">🏢</span>
                            <span>Company</span>
                        </button>
                        <button class="mobile-clear-btn" style="display: flex; align-items: center; gap: 2px; padding: 4px 6px; background: rgba(0,194,168,0.3); border: 1px solid rgba(0,194,168,0.5); color: white; border-radius: 12px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <span style="font-size: 8px;">🔄</span>
                            <span>All</span>
                        </button>
                    </div>
                </div>
                
                <!-- MINI DESKTOP CONTENT - vertical layout with horizontal chosen card at top -->
                <div class="mobile-network-content" style="display: flex; flex-direction: column; height: calc(90vh - 100px); max-height: calc(90vh - 100px); border-radius: 0 0 8px 8px; padding: 0.75rem; overflow: hidden; box-sizing: border-box;">
                    
                    <!-- MOBILE HORIZONTAL CHOSEN ALUMNI CARD - spans full width, shorter height -->
                    <div class="mobile-network-chosen-card" style="width: 100%; background: white; border-radius: 8px; padding: 0.75rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 0.75rem;">
                        <div class="mobile-profile-section" style="display: flex; align-items: center; gap: 0.75rem;">
                            <!-- Profile photo on the left -->
                            <div class="mobile-profile-photo" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; border: 2px solid #F39C12; overflow: hidden; flex-shrink: 0;">
                                ${personal.photo && isValidImageUrl(personal.photo) ? `<img src="${personal.photo}" style="width: 100%; height: 100%; object-fit: cover;">` : ''}
                                <span style="${personal.photo && isValidImageUrl(personal.photo) ? 'display: none;' : ''}">${personal.name ? personal.name.split(' ').map(n => n[0]).join('').toUpperCase() : '👤'}</span>
                            </div>
                            
                            <!-- Name and role in center -->
                            <div class="mobile-profile-info" style="flex: 1; min-width: 0;">
                                <h3 style="margin: 0 0 0.25rem 0; color: #1B365D; font-size: 0.8rem; font-weight: 600; line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${personal.name || 'Anonymous'}</h3>
                                <p style="margin: 0 0 0.25rem 0; color: #666; font-size: 0.65rem; line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${professional.current_role || 'Professional'}</p>
                                <p style="margin: 0; color: #999; font-size: 0.6rem; line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${professional.company || 'Company'}</p>
                            </div>
                            
                            <!-- Compact details on the right -->
                            <div class="mobile-details-section" style="display: flex; flex-direction: column; gap: 0.125rem; font-size: 0.5rem; text-align: right; flex-shrink: 0;">
                                <div style="color: #666;">🎓 ${personal.graduation_year || 'Unknown'}</div>
                                <div style="color: #666;">🏭 ${professional.industry || 'Industry'}</div>
                                ${personal.location?.city ? `<div style="color: #666;">📍 ${personal.location.city}</div>` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <!-- CONNECTION CARDS SECTION - below the chosen card -->
                    <div class="mobile-network-connections" style="flex: 1; background: linear-gradient(135deg, rgba(11,107,255,0.02) 0%, rgba(0,194,168,0.02) 100%); border-radius: 8px; padding: 0.5rem; display: flex; flex-direction: column;">
                        <div class="mobile-connected-alumni-cards" id="mobileConnectedAlumniCards" style="display: flex; flex-wrap: wrap; gap: 0.25rem; overflow-y: scroll; -webkit-overflow-scrolling: touch; height: 400px; max-height: 400px; padding-bottom: 30px;">
                            <!-- Connected alumni cards will be displayed here -->
                        </div>
                    </div>
                </div>
            `;
            
            modalBody.appendChild(miniNetworkModal);
            
            // Trigger modal entrance animation
            setTimeout(() => {
                miniNetworkModal.style.opacity = '1';
                miniNetworkModal.style.transform = 'scale(1) translateY(0)';
            }, 50);
            
            // Initialize mobile networking functionality
            let mobileActiveFilters = [];
            
            // Helper function to validate image URLs (simplified for debugging)
            function isValidImageUrl(url) {
                if (!url || typeof url !== 'string') return false;
                
                // For debugging, let's be more permissive and just check basic URL structure
                try {
                    new URL(url);
                    return url.startsWith('http');
                } catch (e) {
                    return false;
                }
            }
            
            // Mobile network data for complex cross-clustering
            let mobileNetworkData = null;
            
            // Generate network data with connection strengths (like desktop)
            function generateMobileNetworkData() {
                console.log('🔄 Generating mobile network data...');
                const nodes = allAlumni.map((alumni, index) => ({
                    id: `alumni_${index}`,
                    name: alumni.personal?.name || 'Anonymous',
                    class: alumni.personal?.graduation_year || '',
                    degree: alumni.personal?.degree || '',
                    industry: alumni.professional?.industry || '',
                    company: alumni.professional?.company || '',
                    position: alumni.professional?.current_role || '',
                    location: alumni.personal?.location?.city || '',
                    attending: alumni.summit_2025?.attending || false,
                    photo: alumni.personal?.photo || '',
                    rawData: alumni
                }));

                const links = [];
                for (let i = 0; i < nodes.length; i++) {
                    for (let j = i + 1; j < nodes.length; j++) {
                        const nodeA = nodes[i];
                        const nodeB = nodes[j];
                        let connectionStrength = 0;
                        let connectionType = null;
                        
                        // Cross-clustering logic with weighted connections
                        if (nodeA.class && nodeB.class && nodeA.class === nodeB.class) {
                            connectionType = 'cohort';
                            connectionStrength += 3;
                        }
                        if (nodeA.degree && nodeB.degree && nodeA.degree === nodeB.degree) {
                            connectionType = connectionType || 'professional';
                            connectionStrength += 2;
                        }
                        if (nodeA.industry && nodeB.industry && nodeA.industry === nodeB.industry) {
                            connectionType = connectionType || 'professional';
                            connectionStrength += 1;
                        }
                        if (nodeA.company && nodeB.company && nodeA.company === nodeB.company) {
                            connectionType = 'professional';
                            connectionStrength += 4;
                        }
                        
                        if (connectionStrength > 0) {
                            links.push({
                                source: nodeA.id,
                                target: nodeB.id,
                                type: connectionType,
                                strength: connectionStrength
                            });
                        }
                    }
                }
                
                // Calculate node centrality
                nodes.forEach(node => {
                    node.connections = links.filter(link => 
                        link.source === node.id || link.target === node.id
                    ).length;
                    node.centrality = node.connections;
                });

                console.log(`✅ Generated ${nodes.length} nodes and ${links.length} links for mobile`);
                return { nodes, links };
            }
            
            // Advanced filtering with cross-clustering (like desktop)
            function filterMobileConnectedAlumni(connectedAlumni, selectedAlumni, activeFilters) {
                const selectedPersonal = selectedAlumni?.personal || {};
                const selectedProfessional = selectedAlumni?.professional || {};

                return connectedAlumni.filter(alumniNode => {
                    // Find full alumni data for this node
                    const fullAlumniData = allAlumni.find(alumni => 
                        alumni.personal?.name === alumniNode.name
                    );
                    
                    if (!fullAlumniData) return false;

                    const personal = fullAlumniData.personal || {};
                    const professional = fullAlumniData.professional || {};

                    // Complex filter logic: ALL filters must match (AND logic)
                    return activeFilters.every(filter => {
                        switch (filter) {
                            case 'class':
                                return selectedPersonal.graduation_year && personal.graduation_year && 
                                       selectedPersonal.graduation_year === personal.graduation_year;
                            case 'degree':
                                return selectedPersonal.degree && personal.degree && 
                                       selectedPersonal.degree === personal.degree;
                            case 'industry':
                                return selectedProfessional.industry && professional.industry && 
                                       selectedProfessional.industry === professional.industry;
                            case 'company':
                                return selectedProfessional.company && professional.company && 
                                       selectedProfessional.company === professional.company;
                            default:
                                return true;
                        }
                    });
                });
            }
            
            // Function to display filtered alumni cards with complex network logic
            function displayMobileNetworkCards(filters = []) {
                const cardsContainer = document.getElementById('mobileConnectedAlumniCards');
                if (!cardsContainer) return;
                
                cardsContainer.innerHTML = '';
                
                // Initialize network data if not already done
                if (!mobileNetworkData) {
                    mobileNetworkData = generateMobileNetworkData();
                }
                
                if (!currentAlumni) {
                    cardsContainer.innerHTML = '<div style="color: white; text-align: center; padding: 1rem; font-size: 0.7rem;">No alumni data available</div>';
                    return;
                }
                
                // Find the selected alumni node in network data
                const selectedNode = mobileNetworkData.nodes.find(n => 
                    n.name === currentAlumni.personal?.name
                );
                
                if (!selectedNode) {
                    console.error('Selected alumni not found in network data');
                    cardsContainer.innerHTML = '<div style="color: white; text-align: center; padding: 1rem; font-size: 0.7rem;">Alumni not found in network</div>';
                    return;
                }
                
                // Get connected alumni using network links (like desktop)
                const connectedNodeIds = new Set();
                const connectionTypes = new Map();
                
                mobileNetworkData.links.forEach(link => {
                    if (link.source === selectedNode.id) {
                        connectedNodeIds.add(link.target);
                        connectionTypes.set(link.target, link.type);
                    } else if (link.target === selectedNode.id) {
                        connectedNodeIds.add(link.source);
                        connectionTypes.set(link.source, link.type);
                    }
                });
                
                // Get the connected alumni data
                let connectedAlumni = mobileNetworkData.nodes.filter(n => connectedNodeIds.has(n.id));
                
                // Apply complex filtering if any filters are active
                if (filters.length > 0) {
                    connectedAlumni = filterMobileConnectedAlumni(connectedAlumni, currentAlumni, filters);
                }
                
                // Convert network nodes back to full alumni data
                let displayAlumni = connectedAlumni.map(node => node.rawData).filter(Boolean);
                
                if (displayAlumni.length === 0) {
                    cardsContainer.innerHTML = '<div style="color: white; text-align: center; padding: 1rem; font-size: 0.7rem;">No matching connections found</div>';
                    return;
                }
                
                // Generate TINY desktop-style colorful cards with animation
                displayAlumni.forEach((alumni, index) => {
                    const personal = alumni.personal || {};
                    const professional = alumni.professional || {};
                    const social = alumni.social || {};
                    const summit = alumni.summit_2025 || {};
                    
                    // Determine card style based on active filters (like desktop)
                    let cardStyle = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'; // Default purple
                    
                    if (filters.length > 0) {
                        // When filters are active, show specific colors for matching connections
                        if (filters.includes('class') && currentAlumni && personal.graduation_year === currentAlumni.personal?.graduation_year) {
                            cardStyle = 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)'; // Red class
                        } else if (filters.includes('degree') && currentAlumni && personal.degree === currentAlumni.personal?.degree) {
                            cardStyle = 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)'; // Blue degree
                        } else if (filters.includes('industry') && currentAlumni && professional.industry === currentAlumni.professional?.industry) {
                            cardStyle = 'linear-gradient(135deg, #27ae60 0%, #229954 100%)'; // Green industry
                        } else if (filters.includes('company') && currentAlumni && professional.company === currentAlumni.professional?.company) {
                            cardStyle = 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)'; // Orange company
                        } else {
                            // Non-matching cards when filters are active - use default purple
                            cardStyle = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                        }
                    } else {
                        // No filters active - ALL cards use the same default purple (like desktop)
                        cardStyle = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    }
                    
                                    const card = document.createElement('div');
                card.className = 'connected-alumni-card mobile-mini-card';
                // Initial stacked position for animation - EXTRA LONG VERTICAL CARDS
                card.style.cssText = `
                    width: calc(50% - 0.125rem);
                    height: 220px;
                    background: ${cardStyle};
                    border-radius: 10px;
                    padding: 12px;
                    color: white;
                    position: relative;
                    cursor: pointer;
                    transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
                    box-shadow: 0 3px 12px rgba(0,0,0,0.15);
                    border: 1px solid transparent;
                    margin: 0;
                    font-size: 0.75rem;
                    overflow: visible;
                    transform: translateY(${index * 2}px) translateX(${index * 1}px) rotate(${index * 0.5}deg);
                    z-index: ${100 - index};
                    opacity: 0;
                `;
                
                    // Add click handler to open full profile (same as desktop)
                    card.addEventListener('click', () => {
                        if (window.alumniApp && window.alumniApp.showDetailModal) {
                            window.alumniApp.showDetailModal(alumni);
                        }
                    });
                    
                    // Add tiny hover effect
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-2px) scale(1.02)';
                        card.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
                        card.style.borderColor = 'rgba(255,255,255,0.4)';
                        card.style.zIndex = '10';
                    });
                    
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0) scale(1)';
                        card.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                        card.style.borderColor = 'transparent';
                        card.style.zIndex = '1';
                    });
                    
                    // TINY desktop-style card with all info compressed
                    card.innerHTML = `
                        <div style="display: flex; flex-direction: column; height: 100%; padding: 4px; text-align: center; justify-content: space-between;">
                            <!-- Profile photo at top -->
                            <div style="display: flex; justify-content: center; margin-bottom: 6px; flex-shrink: 0;">
                                <div class="card-photo" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 12px; border: 2px solid rgba(255,255,255,0.4); overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">
                                    ${personal.photo && isValidImageUrl(personal.photo) ? `<img src="${personal.photo}" style="width: 100%; height: 100%; object-fit: cover;" loading="lazy">` : ''}
                                    <span style="${personal.photo && isValidImageUrl(personal.photo) ? 'display: none;' : 'display: flex; align-items: center; justify-content: center;'}">${personal.name && personal.name.length > 0 ? personal.name.split(' ').map(n => n && n.length > 0 ? n[0] : '').join('').toUpperCase() : '👤'}</span>
                                </div>
                            </div>
                            
                            <!-- Complete alumni info with optimal spacing -->
                            <div style="flex: 1; display: flex; flex-direction: column; justify-content: space-evenly; min-height: 0;">
                                <!-- Name -->
                                <div class="card-name" style="font-size: 11px; font-weight: 700; line-height: 1.2; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">${personal.name || 'Anonymous'}</div>
                                
                                <!-- Current Role -->
                                <div class="card-role" style="font-size: 9px; font-weight: 600; opacity: 0.95; line-height: 1.2; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${professional.current_role || 'Professional'}</div>
                                
                                <!-- Company -->
                                ${professional.company ? `<div style="font-size: 8px; opacity: 0.9; line-height: 1.1; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; justify-content: center; gap: 2px;"><span>🏢</span><span>${professional.company}</span></div>` : ''}
                                
                                <!-- Graduation Year -->
                                ${personal.graduation_year ? `<div style="font-size: 8px; opacity: 0.9; line-height: 1.1; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; justify-content: center; gap: 2px;"><span>🎓</span><span>Class ${personal.graduation_year}</span></div>` : ''}
                                
                                <!-- Degree -->
                                ${personal.degree ? `<div style="font-size: 8px; opacity: 0.9; line-height: 1.1; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; justify-content: center; gap: 2px;"><span>📜</span><span>${personal.degree}</span></div>` : ''}
                                
                                <!-- Industry -->
                                ${professional.industry ? `<div style="font-size: 8px; opacity: 0.9; line-height: 1.1; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; justify-content: center; gap: 2px;"><span>🏭</span><span>${professional.industry}</span></div>` : ''}
                                
                                <!-- Location -->
                                ${personal.location?.city ? `<div style="font-size: 8px; opacity: 0.9; line-height: 1.1; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; justify-content: center; gap: 2px;"><span>📍</span><span>${personal.location.city}${personal.location.country && personal.location.country !== personal.location.city ? `, ${personal.location.country}` : ''}</span></div>` : ''}
                                
                                <!-- Connection Badge - shows WHY they're connected (network-based) -->
                                ${(() => {
                                    if (!currentAlumni || !mobileNetworkData) return '';
                                    
                                    // Find the alumni node in network data
                                    const alumniNode = mobileNetworkData.nodes.find(n => 
                                        n.name === alumni.personal?.name
                                    );
                                    
                                    if (!alumniNode) return '';
                                    
                                    // Get multiple connection types (like desktop)
                                    let connectionReasons = [];
                                    
                                    // Check for class connection (highest priority)
                                    if (alumni.personal?.graduation_year && currentAlumni.personal?.graduation_year && 
                                        alumni.personal.graduation_year === currentAlumni.personal.graduation_year) {
                                        connectionReasons.push(`🎓 Class ${alumni.personal.graduation_year}`);
                                    }
                                    
                                    // Check for company connection (second priority)
                                    if (alumni.professional?.company && currentAlumni.professional?.company && 
                                        alumni.professional.company === currentAlumni.professional.company) {
                                        connectionReasons.push(`🏢 ${alumni.professional.company}`);
                                    }
                                    
                                    // Check for degree connection
                                    if (alumni.personal?.degree && currentAlumni.personal?.degree && 
                                        alumni.personal.degree === currentAlumni.personal.degree) {
                                        connectionReasons.push(`📜 ${alumni.personal.degree}`);
                                    }
                                    
                                    // Check for industry connection
                                    if (alumni.professional?.industry && currentAlumni.professional?.industry && 
                                        alumni.professional.industry === currentAlumni.professional.industry) {
                                        connectionReasons.push(`🏭 ${alumni.professional.industry}`);
                                    }
                                    
                                    // Show the primary connection reason with count (like desktop)
                                    if (connectionReasons.length > 0) {
                                        const primaryReason = connectionReasons[0];
                                        const additionalCount = connectionReasons.length - 1;
                                        
                                        // Get connection strength from network data
                                        const selectedNode = mobileNetworkData.nodes.find(n => 
                                            n.name === currentAlumni.personal?.name
                                        );
                                        
                                        let strengthIndicator = '';
                                        if (selectedNode) {
                                            const link = mobileNetworkData.links.find(l => 
                                                (l.source === selectedNode.id && l.target === alumniNode.id) ||
                                                (l.target === selectedNode.id && l.source === alumniNode.id)
                                            );
                                            if (link && link.strength > 3) {
                                                strengthIndicator = ' ⭐'; // Strong connection
                                            }
                                        }
                                        
                                        return `<div style="font-size: 7px; opacity: 0.85; line-height: 1.1; color: white; background: rgba(255,255,255,0.2); padding: 1px 4px; border-radius: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 1px; border: 1px solid rgba(255,255,255,0.1);">${primaryReason}${additionalCount > 0 ? ` +${additionalCount}` : ''}${strengthIndicator}</div>`;
                                    }
                                    return '';
                                })()}
                            </div>
                        </div>
                    `;
                    
                    // Add proper image error handling after card creation
                    const img = card.querySelector('img');
                    const span = card.querySelector('span');
                    if (img && span) {
                        // Handle image load errors (LinkedIn URLs often fail)
                        img.addEventListener('error', (e) => {
                            img.style.display = 'none';
                            span.style.display = 'flex';
                            span.style.alignItems = 'center';
                            span.style.justifyContent = 'center';
                        });
                        
                        // Handle successful image loads
                        img.addEventListener('load', () => {
                            span.style.display = 'none';
                        });
                        
                        // Also check if image is already broken
                        if (img.complete && img.naturalWidth === 0) {
                            img.style.display = 'none';
                            span.style.display = 'flex';
                            span.style.alignItems = 'center';
                            span.style.justifyContent = 'center';
                        }
                    }
                    
                    cardsContainer.appendChild(card);
                });
                
                // Trigger spreading animation after all cards are added
                setTimeout(() => {
                    const cards = cardsContainer.querySelectorAll('.mobile-mini-card');
                    cards.forEach((card, index) => {
                        setTimeout(() => {
                            // Animate to final grid position
                            card.style.transform = 'translateY(0) translateX(0) rotate(0deg)';
                            card.style.opacity = '1';
                            card.style.zIndex = '1';
                        }, index * 80); // Stagger animation by 80ms per card
                    });
                }, 100); // Small delay to ensure DOM is ready
            }
            
            // Setup filter event listeners for mini desktop layout
            const filterButtons = miniNetworkModal.querySelectorAll('.mobile-filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const filter = button.dataset.filter;
                    
                    if (button.classList.contains('active')) {
                        // Remove filter
                        button.classList.remove('active');
                        button.style.background = 'rgba(255,255,255,0.2)';
                        button.style.borderColor = 'rgba(255,255,255,0.3)';
                        mobileActiveFilters = mobileActiveFilters.filter(f => f !== filter);
                    } else {
                        // Add filter
                        button.classList.add('active');
                        button.style.background = 'rgba(255,255,255,0.4)';
                        button.style.borderColor = 'rgba(255,255,255,0.6)';
                        button.style.transform = 'scale(0.95)';
                        if (!mobileActiveFilters.includes(filter)) {
                            mobileActiveFilters.push(filter);
                        }
                    }
                    
                    // Re-display cards with updated filters
                    displayMobileNetworkCards(mobileActiveFilters);
                });
            });
            
            // Setup clear filters button
            const clearButton = miniNetworkModal.querySelector('.mobile-clear-btn');
            if (clearButton) {
                clearButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Clear all active filters
                    mobileActiveFilters = [];
                    filterButtons.forEach(btn => {
                        btn.classList.remove('active');
                        btn.style.background = 'rgba(255,255,255,0.2)';
                        btn.style.borderColor = 'rgba(255,255,255,0.3)';
                        btn.style.transform = 'scale(1)';
                    });
                    
                    // Re-display all cards
                    displayMobileNetworkCards([]);
                });
            }
            
            // Initial display of all cards
            displayMobileNetworkCards();
            
        }
        
        // Run on load and resize
        window.addEventListener('load', setupMobileLayout);
        window.addEventListener('resize', setupMobileLayout);
        
        // Run immediately
        setupMobileLayout();
    </script>
</body>
</html>